namespace = Plus

#reserved: Plus.1450 to Plus.1499

#######################################
# SHATTERED REALM EVENTS
#######################################
		
#Makes everyone an independent count, creating titles where needed
narrative_event = {
	id = Plus.1450
	is_triggered_only = yes
	hide_window = yes
	
	immediate = {
		set_global_flag = shattered_realm
		any_independent_ruler = {
			limit = {
				primary_title = { is_primary_type_title = no } # Prevent it from targeting Mercenaries, Holy Orders and Religious Leaders
			}
			any_war = { end_war = invalid }
			disband_event_forces = yes # Don't want event troops stomping around
			any_realm_lord = {
				limit = {
					higher_tier_than = baron
				}
				any_war = { end_war = invalid }
				any_demesne_title = {
					limit = {
						higher_tier_than = count
					}
					destroy_landed_title = THIS
				}
				any_demesne_title = {
					limit = { # Don't do this to players unless they have more than 1 county
						holder_scope = { 
							OR = {
								ai = yes 
								num_of_count_titles = 2
							}
						}
						higher_tier_than = baron
					}
					create_character = {
						random_traits = yes
						religion = THIS
						culture = THIS
						age = 16
					}
					new_character = {
						usurp_title_plus_barony_if_unlanded = PREV
						set_defacto_liege = THIS
					}
				}
				any_claim = {
					PREV = { remove_claim = PREV }
				}
				any_courtier = {
					any_claim = {
						PREV = { remove_claim = PREV }
					}
				}
			}
			any_demesne_title = {
				limit = {
					higher_tier_than = count
				}
				destroy_landed_title = THIS
			}
			any_demesne_title = {
				limit = {
					tier = count
					location = { is_capital = no }
				}
				create_character = {
					random_traits = yes
					religion = THIS
					culture = THIS
					age = 16
				}
				new_character = {
					usurp_title_plus_barony_if_unlanded = PREV
					set_defacto_liege = THIS
				}
			}
			# This removes all claims from landholders
			any_claim = {
				remove_claim = PREV
			}
			# This removes all claims from courtiers
			any_courtier = {
				any_claim = {
					remove_claim = PREV
				}
			}
		}
		if = {
			limit = {
				has_global_flag = sr_dukes
				narrative_event = { id = Plus.1452 }
			}
		}
		if = {
			limit = {
				has_global_flag = sr_kings
				narrative_event = { id = Plus.1453 }
			}
		}		
	}
}

#Makes everyone an independent count, but assigning them specific religions
#(and in some cases cultures) dependent on geography
narrative_event = {
	id = Plus.1451
	is_triggered_only = yes
	hide_window = yes
	
	immediate = {
		set_global_flag = reign_ancients
		any_independent_ruler = {
			limit = {
				primary_title = { is_primary_type_title = no } # Prevent it from targeting Mercenaries, Holy Orders and Religious Leaders
			}
			any_war = { end_war = invalid }
			disband_event_forces = yes # Don't want event troops stomping around
			any_realm_lord = {
				limit = {
					higher_tier_than = baron
				}
				any_war = { end_war = invalid }
				any_demesne_title = {
					limit = {
						higher_tier_than = count
					}
					destroy_landed_title = THIS
				}
				any_demesne_title = {
					limit = { # Don't do this to players unless they have more than 1 county
						holder_scope = { 
							OR = {
								ai = yes 
								num_of_count_titles = 2
							}
						}
						higher_tier_than = baron
					}				
					if = {
						limit = {
							kingdom = { 
								OR = {
									title = k_france 
									title = k_aquitaine 
									title = k_aragon 
									title = k_navarra 
									title = k_castille 
									title = k_asturias 
									title = k_andalusia
									title = k_ireland
									title = k_brittany
									title = k_scotland
									title = k_portugal
									title = k_wales
								}
							} 
						}
						create_character = {
							random_traits = yes
							age = 16
							religion = celtic_pagan
							culture = THIS
						}
						new_character = {
							usurp_title_plus_barony_if_unlanded = PREV
							set_defacto_liege = THIS
						}						
					}
					if = {
						limit = {
							kingdom = { 
								OR = {
									title = k_germany
									title = k_frisia
									title = k_lotharingia
									title = k_burgundy
									title = k_saxony
								}
							} 
						}
						create_character = {
							random_traits = yes
							age = 16
							religion = german_pagan
							culture = THIS
						}
						new_character = {
							usurp_title_plus_barony_if_unlanded = PREV
							set_defacto_liege = THIS
						}						
					}					
					if = {
						limit = {
							OR = {
								kingdom = {
									OR = {
										title = k_venice 
										title = k_croatia 
										title = k_serbia 
										title = k_bulgaria 
										title = k_byzantium 
										title = k_nikaea
										title = k_trebizond
										title = k_armenia
										title = k_italy
										title = k_sicily
										title = k_georgia
										title = k_sardinia
									}
								}
								duchy = {
									title = d_carinthia
								}
							}
						}
						create_character = {
							random_traits = yes
							age = 16
							religion = hellenic_pagan
							culture = roman
						}
						new_character = {
							usurp_title_plus_barony_if_unlanded = PREV
							set_defacto_liege = THIS
						}
					}
					if = {
						limit = {
							OR = {
								kingdom = {
									OR = {
										title = k_england 
										title = k_norway 
										title = k_sweden
										title = k_denmark
									}
								}
							}
						}
						create_character = {
							random_traits = yes
							age = 16
							religion = norse_pagan
							culture = THIS
						}
						new_character = {
							usurp_title_plus_barony_if_unlanded = PREV
							set_defacto_liege = THIS
						}
					}
					if = {
						limit = {
							kingdom = {
								OR = {
									title = k_persia 
									title = k_afghanistan 
									title = k_baluchistan 
								}
							}
						}
						create_character = {
							random_traits = yes
							age = 16
							religion = zoroastrian
							culture = THIS
						}
						new_character = {
							usurp_title_plus_barony_if_unlanded = PREV
							set_defacto_liege = THIS
						}
					}
					if = {
						limit = {
							kingdom = {
								OR = {
									title = k_finland
									title = k_sami
									title = k_perm
								}
							}
						}
						create_character = {
							random_traits = yes
							age = 16
							religion = finnish_pagan
							culture = THIS
						}
						new_character = {
							usurp_title_plus_barony_if_unlanded = PREV
							set_defacto_liege = THIS
						}
					}
					if = {
						limit = {
							kingdom = {
								OR = {
									title = k_cuman
									title = k_wallachia
									title = k_crimea
									title = k_hungary
									title = k_carpathia
									title = k_avaria
									title = k_volga		
									title = k_alania										
								}
							}
						}
						create_character = {
							random_traits = yes
							age = 16
							religion = tengri_pagan
							culture = THIS
						}
						new_character = {
							usurp_title_plus_barony_if_unlanded = PREV
							set_defacto_liege = THIS
						}
					}
					if = {
						limit = {
							kingdom = {
								OR = {
									title = k_azerbaijan										
								}
							}
						}
						create_character = {
							random_traits = yes
							age = 16
							religion = messalian
							culture = THIS
						}
						new_character = {
							usurp_title_plus_barony_if_unlanded = PREV
							set_defacto_liege = THIS
						}
					}
					if = {
						limit = {
							kingdom = {
								OR = {
									title = k_baluchistan
									title = k_afghanistan
								}
							}
						}
						create_character = {
							random_traits = yes
							age = 16
							religion = zun_pagan
							culture = THIS
						}
						new_character = {
							usurp_title_plus_barony_if_unlanded = PREV
							set_defacto_liege = THIS
						}
					}						
					if = {
						limit = {
							kingdom = {
								OR = {
									title = k_poland
									title = k_bohemia
									title = k_pomerania
									title = k_rus
									title = k_muscovy
									title = k_novgorod
								}
							}
						}
						create_character = {
							random_traits = yes
							age = 16
							religion = slavic_pagan
							culture = THIS
						}
						new_character = {
							usurp_title_plus_barony_if_unlanded = PREV
							set_defacto_liege = THIS
						}
					}					
					if = {
						limit = {
							kingdom = {
								OR = {
									title = k_mesopotamia
								}
							}
						}
						create_character = {
							random_traits = yes
							age = 16
							religion = sunni
							culture = THIS
						}
						new_character = {
							usurp_title_plus_barony_if_unlanded = PREV
							set_defacto_liege = THIS
						}
					}
					if = {
						limit = {
							kingdom = {
								OR = {
									title = k_arabia
								}
							}
						}
						create_character = {
							random_traits = yes
							age = 16
							religion = zikri
							culture = THIS
						}
						new_character = {
							usurp_title_plus_barony_if_unlanded = PREV
							set_defacto_liege = THIS
						}
					}
					if = {
						limit = {
							kingdom = {
								OR = {
									title = k_khwarizm
								}
							}
						}
						create_character = {
							random_traits = yes
							age = 16
							religion = manichean
							culture = THIS
						}
						new_character = {
							usurp_title_plus_barony_if_unlanded = PREV
							set_defacto_liege = THIS
						}
					}
					if = {
						limit = {
							kingdom = {
								OR = {
									title = k_egypt
								}
							}
						}
						create_character = {
							random_traits = yes
							age = 16
							religion = egyptian_pagan
							culture = THIS
						}
						new_character = {
							usurp_title_plus_barony_if_unlanded = PREV
							set_defacto_liege = THIS
						}
					}
					if = {
						limit = {
							kingdom = {
								OR = {
									title = k_abyssinia
								}
							}
						}
						create_character = {
							random_traits = yes
							age = 16
							religion = monophysite
							culture = THIS
						}
						new_character = {
							usurp_title_plus_barony_if_unlanded = PREV
							set_defacto_liege = THIS
						}
					}	
					if = {
						limit = {
							kingdom = {
								OR = {
									title = k_nubia
								}
							}
						}
						create_character = {
							random_traits = yes
							age = 16
							religion = miaphysite
							culture = THIS
						}
						new_character = {
							usurp_title_plus_barony_if_unlanded = PREV
							set_defacto_liege = THIS
						}
					}
					if = {
						limit = {
							kingdom = {
								OR = {
									title = k_morocco
									title = k_mauretania
								}
							}
						}
						create_character = {
							random_traits = yes
							age = 16
							religion = bektashi
							culture = THIS
						}
						new_character = {
							usurp_title_plus_barony_if_unlanded = PREV
							set_defacto_liege = THIS
						}
					}
					if = {
						limit = {
							kingdom = {
								OR = {
									title = k_adal
								}
							}
						}
						create_character = {
							random_traits = yes
							age = 16
							religion = nestorian
							culture = THIS
						}
						new_character = {
							usurp_title_plus_barony_if_unlanded = PREV
							set_defacto_liege = THIS
						}
					}
					if = {
						limit = {
							kingdom = {
								OR = {
									title = k_jolof
									title = k_ghana
									title = k_mali
								}
							}
						}
						create_character = {
							random_traits = yes
							age = 16
							religion = west_african_pagan
							culture = THIS
						}
						new_character = {
							usurp_title_plus_barony_if_unlanded = PREV
							set_defacto_liege = THIS
						}
					}					
				}				
				any_claim = {
					PREV = { remove_claim = PREV }
				}
				any_courtier = {
					any_claim = {
						PREV = { remove_claim = PREV }
					}
				}
			}
			any_demesne_title = {
				limit = {
					higher_tier_than = count
				}
				destroy_landed_title = THIS
			}
			any_demesne_title = {
				limit = {
					tier = count
					location = { is_capital = no }
				}				
				create_character = {
					random_traits = yes
					religion = THIS
					culture = THIS
					age = 16
				}
				new_character = {
					usurp_title_plus_barony_if_unlanded = PREV
					set_defacto_liege = THIS
				}
			}
			# This block removes all claims from landholders
			any_claim = {
				remove_claim = PREV
			}
			# This block removes all claims from courtiers
			any_courtier = {
				any_claim = {
					remove_claim = PREV
				}
			}
		}
		any_independent_ruler = { # add Bloodlust to AI characters
			limit = {
				ai = yes
				higher_tier_than = baron
			}
			add_trait = bloodlust
		}
		any_independent_ruler = { # add Yehudi to Jews
			limit = {
				religion_group = jewish_group
			}
			add_trait = yehudi
			set_character_flag = yehudi_check
		}		
		k_papal_state = { # Clear papal vassals, as the first check won't check the papacy
			holder_scope = {
				any_vassal = {
					limit = { tier = count }
					set_defacto_liege = THIS
				}
			}
		}
		# Set Provinces to the correct religions
		k_france = { # Set this kingdom to be Celtic
			any_de_jure_vassal_title = {
				holder_scope = {
					religion = celtic_pagan
					any_courtier = {
						religion = PREV
						culture = PREV
					}					
				}
				location = {
					religion = celtic_pagan
				}
			}
		}
		k_aquitaine = { # Set this kingdom to be Celtic
			any_de_jure_vassal_title = {
				holder_scope = {
					religion = celtic_pagan
					any_courtier = {
						religion = PREV
						culture = PREV
					}					
				}
				location = {
					religion = celtic_pagan
				}
			}
		}
		k_aragon = { # Set this kingdom to be Celtic
			any_de_jure_vassal_title = {
				holder_scope = {
					religion = celtic_pagan
					any_courtier = {
						religion = PREV
						culture = PREV
					}					
				}
				location = {
					religion = celtic_pagan
				}
			}
		}
		k_navarra = { # Set this kingdom to be Celtic
			any_de_jure_vassal_title = {
				holder_scope = {
					religion = celtic_pagan
					any_courtier = {
						religion = PREV
						culture = PREV
					}					
				}
				location = {
					religion = celtic_pagan
				}
			}
		}
		k_castille = { # Set this kingdom to be Celtic
			any_de_jure_vassal_title = {
				holder_scope = {
					religion = celtic_pagan
					any_courtier = {
						religion = PREV
						culture = PREV
					}					
				}
				location = {
					religion = celtic_pagan
				}
			}
		}
		k_asturias = { # Set this kingdom to be Celtic
			any_de_jure_vassal_title = {
				holder_scope = {
					religion = celtic_pagan
					any_courtier = {
						religion = PREV
						culture = PREV
					}					
				}
				location = {
					religion = celtic_pagan
				}
			}
		}
		k_andalusia = { # Set this kingdom to be Celtic
			any_de_jure_vassal_title = {
				holder_scope = {
					religion = celtic_pagan
					any_courtier = {
						religion = PREV
						culture = PREV
					}					
				}
				location = {
					religion = celtic_pagan
				}
			}
		}
		k_portugal = { # Set this kingdom to be Celtic
			any_de_jure_vassal_title = {
				holder_scope = {
					religion = celtic_pagan
					any_courtier = {
						religion = PREV
						culture = PREV
					}					
				}
				location = {
					religion = celtic_pagan
				}
			}
		}			
		k_ireland = { # Set this kingdom to be Celtic
			any_de_jure_vassal_title = {
				holder_scope = {
					religion = celtic_pagan
					any_courtier = {
						religion = PREV
						culture = PREV
					}					
				}
				location = {
					religion = celtic_pagan
				}
			}
		}
		k_brittany = { # Set this kingdom to be Celtic
			any_de_jure_vassal_title = {
				holder_scope = {
					religion = celtic_pagan
					any_courtier = {
						religion = PREV
						culture = PREV
					}					
				}
				location = {
					religion = celtic_pagan
				}
			}
		}
		k_scotland = { # Set this kingdom to be Celtic
			any_de_jure_vassal_title = {
				holder_scope = {
					religion = celtic_pagan
					any_courtier = {
						religion = PREV
						culture = PREV
					}					
				}
				location = {
					religion = celtic_pagan
				}
			}
		}
		k_wales = { # Set this kingdom to be Celtic
			any_de_jure_vassal_title = {
				holder_scope = {
					religion = celtic_pagan
					any_courtier = {
						religion = PREV
						culture = PREV
					}					
				}
				location = {
					religion = celtic_pagan
				}
			}
		}		
		k_germany = { # Set this kingdom to be Germanic
			any_de_jure_vassal_title = {
				holder_scope = {
					religion = german_pagan
					any_courtier = {
						religion = PREV
						culture = PREV
					}					
				}
				location = {
					religion = german_pagan
				}
			}
		}
		d_carinthia = { # Set this duchy to be Hellenic
			any_de_jure_vassal_title = {
				holder_scope = {
					culture = roman
					religion = hellenic_pagan
					any_courtier = {
						religion = PREV
						culture = PREV
					}					
				}
				location = {
					culture = roman
					religion = hellenic_pagan
				}
			}
		}
		k_venice = { # Set this kingdom to be Hellenic
			any_de_jure_vassal_title = {
				holder_scope = {
					culture = roman
					religion = hellenic_pagan
					any_courtier = {
						religion = PREV
						culture = PREV
					}					
				}
				location = {
					culture = roman
					religion = hellenic_pagan
				}
			}
		}
		k_croatia = { # Set this kingdom to be Hellenic
			any_de_jure_vassal_title = {
				holder_scope = {
					culture = roman
					religion = hellenic_pagan
					any_courtier = {
						religion = PREV
						culture = PREV
					}					
				}
				location = {
					culture = roman
					religion = hellenic_pagan
				}
			}
		}
		k_serbia = { # Set this kingdom to be Hellenic
			any_de_jure_vassal_title = {
				holder_scope = {
					culture = roman
					religion = hellenic_pagan
					any_courtier = {
						religion = PREV
						culture = PREV
					}					
				}
				location = {
					culture = roman
					religion = hellenic_pagan
				}
			}
		}	
		k_bulgaria = { # Set this kingdom to be Hellenic
			any_de_jure_vassal_title = {
				holder_scope = {
					culture = roman
					religion = hellenic_pagan
					any_courtier = {
						religion = PREV
						culture = PREV
					}					
				}
				location = {
					culture = roman
					religion = hellenic_pagan
				}
			}
		}
		k_byzantium = { # Set this kingdom to be Hellenic
			any_de_jure_vassal_title = {
				holder_scope = {
					culture = roman
					religion = hellenic_pagan
					any_courtier = {
						religion = PREV
						culture = PREV
					}					
				}
				location = {
					culture = roman
					religion = hellenic_pagan
				}
			}
		}
		k_nikaea = { # Set this kingdom to be Hellenic
			any_de_jure_vassal_title = {
				holder_scope = {
					culture = roman
					religion = hellenic_pagan
					any_courtier = {
						religion = PREV
						culture = PREV
					}					
				}
				location = {
					culture = roman
					religion = hellenic_pagan
				}
			}
		}
		k_trebizond = { # Set this kingdom to be Hellenic
			any_de_jure_vassal_title = {
				holder_scope = {
					culture = roman
					religion = hellenic_pagan
					any_courtier = {
						religion = PREV
						culture = PREV
					}					
				}
				location = {
					culture = roman
					religion = hellenic_pagan
				}
			}
		}
		k_armenia = { # Set this kingdom to be Hellenic
			any_de_jure_vassal_title = {
				holder_scope = {
					culture = roman
					religion = hellenic_pagan
					any_courtier = {
						religion = PREV
						culture = PREV
					}					
				}
				location = {
					culture = roman
					religion = hellenic_pagan
				}
			}
		}
		k_england = { # Set this kingdom to be Norse
			any_de_jure_vassal_title = {
				holder_scope = {
					religion = norse_pagan
					any_courtier = {
						religion = PREV
						culture = PREV
					}					
				}
				location = {
					religion = norse_pagan
				}
			}
		}
		k_sweden = { # Set this kingdom to be Norse
			any_de_jure_vassal_title = {
				holder_scope = {
					religion = norse_pagan
					any_courtier = {
						religion = PREV
						culture = PREV
					}					
				}
				location = {
					religion = norse_pagan
				}
			}
		}	
		k_norway = { # Set this kingdom to be Norse
			any_de_jure_vassal_title = {
				holder_scope = {
					religion = norse_pagan
					any_courtier = {
						religion = PREV
						culture = PREV
					}					
				}
				location = {
					religion = norse_pagan
				}
			}
		}	
		k_denmark = { # Set this kingdom to be Norse
			any_de_jure_vassal_title = {
				holder_scope = {
					religion = norse_pagan
					any_courtier = {
						religion = PREV
						culture = PREV
					}					
				}
				location = {
					religion = norse_pagan
				}
			}
		}			
		k_frisia = { # Set this kingdom to be Germanic
			any_de_jure_vassal_title = {
				holder_scope = {
					religion = german_pagan
					any_courtier = {
						religion = PREV
						culture = PREV
					}					
				}
				location = {
					religion = german_pagan
				}
			}
		}
		k_lotharingia = { # Set this kingdom to be Germanic
			any_de_jure_vassal_title = {
				holder_scope = {
					religion = german_pagan
					any_courtier = {
						religion = PREV
						culture = PREV
					}					
				}
				location = {
					religion = german_pagan
				}
			}
		}
		k_burgundy = { # Set this kingdom to be Germanic
			any_de_jure_vassal_title = {
				holder_scope = {
					religion = german_pagan
					any_courtier = {
						religion = PREV
						culture = PREV
					}					
				}
				location = {
					religion = german_pagan
				}
			}
		}
		k_italy = { # Set this kingdom to be Hellenic
			any_de_jure_vassal_title = {
				holder_scope = {
					culture = roman
					religion = hellenic_pagan
					any_courtier = {
						religion = PREV
						culture = PREV
					}					
				}
				location = {
					culture = roman
					religion = hellenic_pagan
				}
			}
		}
		k_sicily = { # Set this kingdom to be Hellenic
			any_de_jure_vassal_title = {
				holder_scope = {
					culture = roman
					religion = hellenic_pagan
					any_courtier = {
						religion = PREV
						culture = PREV
					}					
				}
				location = {
					culture = roman
					religion = hellenic_pagan
				}
			}
		}
		k_persia = { # Set this kingdom to be Zoroastrian
			any_de_jure_vassal_title = {
				holder_scope = {
					religion = zoroastrian
					any_courtier = {
						religion = zoroastrian
					}
				}			
				location = {
					religion = zoroastrian
				}
			}
		}
		k_afghanistan = { # Set this kingdom to be Zoroastrian
			any_de_jure_vassal_title = {
				holder_scope = {
					religion = zoroastrian
					any_courtier = {
						religion = zoroastrian
					}
				}			
				location = {
					religion = zoroastrian
				}
			}
		}
		k_baluchistan = { # Set this kingdom to be Zoroastrian
			any_de_jure_vassal_title = {
				holder_scope = {
					religion = zoroastrian
					any_courtier = {
						religion = zoroastrian
					}
				}			
				location = {
					religion = zoroastrian
				}
			}
		}	
		k_egypt = { # Set this kingdom to be Kemetic
			any_de_jure_vassal_title = {
				holder_scope = {
					religion = egyptian_pagan
					any_courtier = {
						religion = PREV
						culture = PREV
					}
				}			
				location = {
					religion = egyptian_pagan
				}
			}
		}
		k_sami = { # Set this kingdom to be Finnic
			any_de_jure_vassal_title = {
				holder_scope = {
					religion = finnish_pagan
					any_courtier = {
						religion = PREV
						culture = PREV
					}
				}			
				location = {
					religion = finnish_pagan
				}
			}
		}
		k_wallachia = { # Set this kingdom to be Tengri
			any_de_jure_vassal_title = {
				holder_scope = {
					religion = tengri_pagan
					any_courtier = {
						religion = PREV
						culture = PREV
					}
				}			
				location = {
					religion = tengri_pagan
				}
			}
		}
		k_avaria = { # Set this kingdom to be Tengri
			any_de_jure_vassal_title = {
				holder_scope = {
					religion = tengri_pagan
					any_courtier = {
						religion = PREV
						culture = PREV
					}
				}			
				location = {
					religion = tengri_pagan
				}
			}
		}		
		k_hungary = { # Set this kingdom to be Tengri
			any_de_jure_vassal_title = {
				holder_scope = {
					religion = tengri_pagan
					any_courtier = {
						religion = PREV
						culture = PREV
					}
				}			
				location = {
					religion = tengri_pagan
				}
			}
		}
		k_carpathia = { # Set this kingdom to be Tengri
			any_de_jure_vassal_title = {
				holder_scope = {
					religion = tengri_pagan
					any_courtier = {
						religion = PREV
						culture = PREV
					}
				}			
				location = {
					religion = tengri_pagan
				}
			}
		}		
		k_georgia = { # Set this kingdom to be Hellenic
			any_de_jure_vassal_title = {
				holder_scope = {
					religion = hellenic_pagan
					culture = roman
					any_courtier = {
						religion = PREV
						culture = PREV
					}
				}			
				location = {
					religion = hellenic_pagan
					culture = roman
				}
			}
		}	
		k_mesopotamia = { # Set this kingdom to be Sunni
			any_de_jure_vassal_title = {
				holder_scope = {
					religion = sunni
					any_courtier = {
						religion = PREV
						culture = PREV
					}
				}			
				location = {
					religion = sunni
				}
			}
		}
		k_arabia = { # Set this kingdom to be Zikri
			any_de_jure_vassal_title = {
				holder_scope = {
					religion = zikri
					any_courtier = {
						religion = PREV
						culture = PREV
					}
				}			
				location = {
					religion = zikri
				}
			}
		}			
		k_khwarizm = { # Set this kingdom to be Manichean
			any_de_jure_vassal_title = {
				holder_scope = {
					religion = manichean
					any_courtier = {
						religion = PREV
						culture = PREV
					}
				}			
				location = {
					religion = manichean
				}
			}
		}
		k_adal = { # Set this kingdom to be Nestorian
			any_de_jure_vassal_title = {
				holder_scope = {
					religion = nestorian
					any_courtier = {
						religion = PREV
						culture = PREV
					}
				}			
				location = {
					religion = nestorian
				}
			}
		}		
		k_abyssinia = { # Set this kingdom to be Miaphysite
			any_de_jure_vassal_title = {
				holder_scope = {
					religion = miaphysite
					any_courtier = {
						religion = PREV
						culture = PREV
					}
				}			
				location = {
					religion = miaphysite
				}
			}
		}		
		k_nubia = { # Set this kingdom to be Monophysite
			any_de_jure_vassal_title = {
				holder_scope = {
					religion = monophysite
					any_courtier = {
						religion = PREV
						culture = PREV
					}
				}			
				location = {
					religion = monophysite
				}
			}
		}
		k_africa = { # Set this kingdom to be Shiite
			any_de_jure_vassal_title = {
				holder_scope = {
					religion = shiite
					any_courtier = {
						religion = PREV
						culture = PREV
					}
				}			
				location = {
					religion = shiite
				}
			}
		}
		k_algiers = { # Set this kingdom to be Shiite
			any_de_jure_vassal_title = {
				holder_scope = {
					religion = shiite
					any_courtier = {
						religion = PREV
						culture = PREV
					}
				}			
				location = {
					religion = shiite
				}
			}
		}
		k_morocco = { # Set this kingdom to be Bektashi
			any_de_jure_vassal_title = {
				holder_scope = {
					religion = bektashi
					any_courtier = {
						religion = PREV
						culture = PREV
					}
				}			
				location = {
					religion = bektashi
				}
			}
		}
		k_sardinia = { # Set this kingdom to be Hellenic
			any_de_jure_vassal_title = {
				holder_scope = {
					religion = hellenic_pagan
					culture = roman
					any_courtier = {
						religion = PREV
						culture = PREV
					}
				}			
				location = {
					religion = hellenic_pagan
					culture = roman
				}
			}
		}
		k_mauretania = { # Set this kingdom to be Bektashi
			any_de_jure_vassal_title = {
				holder_scope = {
					religion = bektashi
					any_courtier = {
						religion = PREV
						culture = PREV
					}
				}			
				location = {
					religion = bektashi
				}
			}
		}
		k_azerbaijan = { # Set this kingdom to be Messalian
			any_de_jure_vassal_title = {
				holder_scope = {
					religion = messalian
					any_courtier = {
						religion = PREV
						culture = PREV
					}
				}			
				location = {
					religion = messalian
				}
			}
		}
		k_afghanistan = { # Set this kingdom to be Zun
			any_de_jure_vassal_title = {
				holder_scope = {
					religion = zun_pagan
					any_courtier = {
						religion = PREV
						culture = PREV
					}
				}			
				location = {
					religion = zun_pagan
				}
			}
		}
		k_volga = { # Set this kingdom to be Tengri
			any_de_jure_vassal_title = {
				holder_scope = {
					religion = tengri_pagan
					any_courtier = {
						religion = PREV
						culture = PREV
					}
				}			
				location = {
					religion = tengri_pagan
				}
			}
		}
		k_crimea = { # Set this kingdom to be Tengri
			any_de_jure_vassal_title = {
				holder_scope = {
					religion = tengri_pagan
					any_courtier = {
						religion = PREV
						culture = PREV
					}
				}			
				location = {
					religion = tengri_pagan
				}
			}
		}		
		k_baluchistan = { # Set this kingdom to be Zun
			any_de_jure_vassal_title = {
				holder_scope = {
					religion = zun_pagan
					any_courtier = {
						religion = PREV
						culture = PREV
					}
				}			
				location = {
					religion = zun_pagan
				}
			}
		}		
		k_jerusalem = { # Set this kingdom to be Jewish
			any_de_jure_vassal_title = {
				holder_scope = {
					religion = jewish
					culture = mizrahim					
					any_courtier = {
						religion = PREV
						culture = PREV
					}
				}			
				location = {
					religion = jewish
					culture = mizrahim
				}
			}
		}
		k_cuman	= { # Set this kingdom to be Tengri
			any_de_jure_vassal_title = {
				holder_scope = {
					religion = tengri_pagan
					any_courtier = {
						religion = PREV
						culture = PREV
					}
				}			
				location = {
					religion = tengri_pagan
				}
			}
		}
		k_syria	= { # Set this kingdom to be Karaite
			any_de_jure_vassal_title = {
				holder_scope = {
					religion = karaite
					culture = mizrahim
					any_courtier = {
						religion = PREV
						culture = PREV
					}
				}			
				location = {
					religion = karaite
					culture = mizrahim
				}
			}
		}		
	}
}

narrative_event = { # Make dukes out of capital holders
	id = Plus.1452
	is_triggered_only = yes
	hide_window = yes
	
	immediate = {
		any_independent_ruler = {
			limit = { # Give the ducal title to the one holding the capital
				primary_title = { is_primary_type_title = no } # Prevent it from targeting Mercenaries, Holy Orders and Religious Leaders			
				capital_scope = {
					duchy = {
						capital_scope = {
							province = PREVPREV
						}
					}
				}
			}
			capital_scope = {
				duchy = {
					grant_title = PREVPREV
				}
			}
		}
		any_independent_ruler = {
			limit = {
				tier = duke
				primary_title = { is_primary_type_title = no } # Prevent it from targeting Mercenaries, Holy Orders and Religious Leaders				
			}
			capital_scope = { # Vassalize all counts to the new dukes
				duchy = {
					any_de_jure_vassal = {
						limit = {
							tier = count
						}
						set_defacto_liege = PREVPREVPREV
					}
				}
			}
		}
	}
}

narrative_event = { #Make kings out of capital holder
	id = Plus.1453
	is_triggered_only = yes
	hide_window = yes
	
	immediate = {
		any_independent_ruler = {
			limit = {
				capital_scope = {
					kingdom = {
						capital_scope = {
							province_id = PREVPREV
						}
					}
				}
			}
			capital_scope = {
				kingdom = {
					grant_title = PREVPREV
				}
			}
		}
		any_independent_ruler = {
			limit = {
				tier = king
			}
			capital_scope = {
				kingdom = {
					any_de_jure_vassal = {
						limit = {
							higher_tier_than = baron
						}					
						set_defacto_liege = PREVPREVPREV
					}
				}
			}
		}
	}
}

character_event = { # This event introduces the player to shattered realm and gives them the option to back out
	id = Plus.1454
	desc = EVTDESC_Plus.1454
	picture = GFX_evt_book_carolingian_script
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	hide_from = yes
	
	option = {
		name = EVTOPTA_Plus.1454
		custom_tooltip = { text = SHATTERED_REALM_BEGIN2 }
		hidden_tooltip = {
			character_event = { id = Plus.1455 }
		}
	}
	option = {
		name = EVTOPTB_Plus.1454
		custom_tooltip = { text = SHATTERED_REALM_BACKOUT }
		hidden_tooltip = {
			clr_global_flag = shattered_realm
		}
	}
}

character_event = { #This event gives the player the option between ancient religions, or standard religions
	id = Plus.1455
	desc = EVTDESC_Plus.1455
	picture = GFX_evt_book_carolingian_script
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = { #Standard religions
		name = EVTOPTA_Plus.1455
		custom_tooltip = { text = SHATTERED_REALM_STANDARD_RELIGIONS }
		hidden_tooltip = {
			any_courtier = {
				limit = { is_landed = no }
				narrative_event = { id = Plus.1450 } # All counts
			}
			character_event = { id = Plus.1456 }			
		}
	}
	option = { #Ancient Religions
		name = EVTOPTB_Plus.1455
		custom_tooltip = { text = SHATTERED_REALM_ANCIENT_RELIGIONS }
		hidden_tooltip = {
			any_courtier = {
				limit = { is_landed = no }
				narrative_event = { id = Plus.1451 } # All old-religion counts
			}
			character_event = { id = Plus.1456 }			
		}
	}
	option = { #Last chance to change mind
		name = EVTOPTC_Plus.1455
		custom_tooltip = { text = SHATTERED_REALM_BACKOUT2 }
		hidden_tooltip = {
			clr_global_flag = shattered_realm
		}
	}	
}

character_event = { #This event allows the player to choose all counts, all duke or all kings
	id = Plus.1456
	desc = EVTDESC_Plus.1456
	picture = GFX_evt_book_carolingian_script
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	option = { #All counts
		name = EVTOPTA_Plus.1456
		custom_tooltip = { text = SHATTERED_REALM_COUNTS }
		character_event = { id = Plus.1457 }
	}
	option = { #All Dukes
		name = EVTOPTB_Plus.1456
		custom_tooltip = { text = SHATTERED_REALM_DUKES }
		hidden_tooltip = {
			any_courtier = {
				limit = { is_landed = no }
				narrative_event = { id = Plus.1452 }
			}
			character_event = { id = Plus.1457 }			
		}
	}
	option = { #All Kings
		name = EVTOPTC_Plus.1456
		custom_tooltip = { text = SHATTERED_REALM_KINGS }
		hidden_tooltip = {
			any_courtier = {
				limit = { is_landed = no }
				narrative_event = { id = Plus.1453 }
			}
			character_event = { id = Plus.1457 }			
		}
	}	
}

character_event = { #This event finalizes the setup, adding any flags that are needed
	id = Plus.1457
	is_triggered_only = yes
	desc = EVTDESC_Plus.1457
	
	option = {
		name = EVTOPTA_Plus.1457
		hidden_tooltip = {
			set_global_flag = shattered_realm
			any_playable_ruler = {
				limit = {
					ai = no
				}
				remove_character_modifer = shattered_realm_mod
			}
		}
	}	
}