namespace = Plus
#reserved: Plus.2300 to Plus.2399

#information from https://en.wikipedia.org/wiki/Germanic_paganism#Tacitus
#Nerthus (a fertility goddess) is believed to directly interpose in human affairs. Her sanctuary is in a wood called Castum.
#A chariot covered with a curtain is dedicated to the goddess, and only the high priest may touch it. 
#The priest is capable of seeing the goddess enter the chariot. 
#Drawn by cows, the chariot travels through the countryside, and wherever the goddess visits, a great feast is held.
#During the travel of the goddess, the Germanic tribes cease all hostilities, and do not lay their hands upon arms.
#When the priest declares that the goddess is tired of conversation with mortals, the chariot returns and is washed, together with the curtains and the goddess herself in a secret lake.
#The slaves who administer this purification are afterwards thrown into the lake and drowned.
#######################################
# GERMANIC EVENTS
#######################################

#Journey of Nerthus Events
#Planning Journey
character_event = {
	id = Plus.2300
	hide_window = yes
	
	immediate = {
		set_character_flag = journey_of_nerthus_starter
		top_liege = {
			primary_title = {
				set_title_flag = planning_journey_of_nerthus
			}
		}
	}
}

#Journey begins
narrative_event = {
	id = Plus.2301
	title = EVTNAME_Plus_2301
	desc = EVTDESC_Plus_2301
	picture = GFX_evt_irminsul_shrine
	border = GFX_event_normal_frame_religion
	trigger = {
		top_liege = {
			any_demesne_title = { has_title_flag = planning_journey_of_nerthus }
		}
		has_character_flag = journey_of_nerthus_starter
		month = 3
		NOT = { month = 4 }
	}
	immediate = {
		hidden_tooltip = {
			top_liege = {
				any_demesne_title = {
					limit = { has_title_flag = planning_journey_of_nerthus }
					clr_title_flag = planning_journey_of_nerthus
				}
				primary_title = {
					set_title_flag = { journey_of_nerthus }
				}
				any_realm_lord = {
					limit = {
						higher_tier_than = count
						NOT = { has_character_flag = journey_of_nerthus_starter }
						any_demesne_title = { NOT = { has_title_flag = adjust_journey_of_nerthus } }
					}
					character_event = { id = Plus.2302 } # To feast or not to feast, that is the question
				}
				any_realm_lord = {
					limit = {
						has_character_flag = journey_of_nerthus_starter
						any_demesne_title = { NOT = { has_title_flag = adjust_journey_of_nerthus } }
					}
					character_event = { id = Plus.2303 }
				}
				any_realm_lord = {
					limit = {
						any_demesne_title = { has_title_flag = adjust_journey_of_nerthus }
					}
					clr_title_flag = { adjust_journey_of_nerthus }
				}
			}
		}
	}

	option = {
		name = EVTOPTA_Plus_2301
	}
}

#Ruler informed of journey (isn't the priest), decides whether or not to hold feast
character_event = {
	id = Plus.2302
	desc = EVTDESC_Plus_2302
	picture = GFX_evt_irminsul_shrine
	border = GFX_event_normal_frame_religion
	is_triggered_only = yes
	
	#Hold a feast in the Goddess's honor!
	option = {
		trigger = {
			NOT = { has_character_modifier = do_not_disturb }
			in_command = no
			is_abroad = no
			has_regent = no
			scaled_wealth = 0.5
			NOT = { trait = cynical }
			NOR = {
				trait = in_hiding
				any_demesne_title = { is_occupied = yes }
				has_character_flag = planning_feast
				has_character_modifier = holding_large_feast
			}
		}
		scaled_wealth = -0.5
		piety = 25
		hidden_tooltip = {
			set_character_flag = planning_feast
			character_event = { id = 72109 }
		}
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0
				has_character_modifier = ai_austerity
			}
			modifier = {
				NOT = { scaled_wealth = 5.0 }
				NOT = {
					trait = charitable
					trait = gregarious
					trait = gluttonous
				}
			}
			modifier = {
				factor = 0
				NOT = { scaled_wealth = 2.5 }
			}
			modifier = {
				factor = 0
				OR = {
					trait = shy
					trait = greedy
					trait = paranoid
				}
			}	
			modifier = {
				factor = 0
				has_character_flag = held_recent_feast
				NOT = {
					had_character_flag = {
						flag = held_recent_feast
						days = 365
					}
				}
			}
		}
	}
	
	#That's nice...
	option = {
		name = EVTOPTA_Plus_2302
		piety = -5
		ai_will_do = {
			factor = 1
		}
	}
}

#Journey priest decides whether or not to hold feast
character_event = {
	id = Plus.2303
	desc = EVTDESC_Plus_2303
	picture = GFX_evt_irminsul_shrine
	border = GFX_event_normal_frame_religion
	is_triggered_only = yes
	
	# We shall hold a great feast!
	option = {
		name = EVTOPTA_Plus_2303
		trigger = {
			NOT = { has_character_modifier = do_not_disturb }
			in_command = no
			is_abroad = no
			has_regent = no
			scaled_wealth = 0.5
			NOT = { trait = cynical }
			NOR = {
				trait = in_hiding
				any_demesne_title = { is_occupied = yes }
				has_character_flag = planning_feast
				has_character_modifier = holding_large_feast
			}
		}
		scaled_wealth = -0.5
		piety = 25
		hidden_tooltip = {
			set_character_flag = planning_feast
			character_event = { id = 72109 }
		}
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0
				has_character_modifier = ai_austerity
			}
			modifier = {
				NOT = { scaled_wealth = 5.0 }
				NOT = {
					trait = charitable
					trait = gregarious
					trait = gluttonous
				}
			}
			modifier = {
				factor = 0
				NOT = { scaled_wealth = 2.5 }
			}
			modifier = {
				factor = 0
				OR = {
					trait = shy
					trait = greedy
					trait = paranoid
				}
			}	
			modifier = {
				factor = 0
				has_character_flag = held_recent_feast
				NOT = {
					had_character_flag = {
						flag = held_recent_feast
						days = 365
					}
				}
			}
		}
	}
	
	# This is already stressful enough!
	option = {
		EVTOPTB_Plus_2303
		piety = -5
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 10
				trait = stressed
			}
		}
	}
}

#Barren/infertile person hears of Nerthus's Journey
########Needs to only have a chance of occuring, and only if they haven't already tried. Not sure how to do this so leaving that part undone ########
character_event = {
	id = Plus.2304
	desc = EVTDESC_Plus_2304
	picture = GFX_evt_irminsul_shrine
	border = GFX_event_normal_frame_religion
	
	only_rulers = yes
	only_capable = yes
	trigger = {
		top_liege = {
			any_demesne_title = { has_title_flag = journey_of_nerthus }
		}
		OR = {
			has_character_modifier = "infertile"
			has_character_modifier = "barren"
		}
		OR = {
			NOT = { trait = zealous }
			religion = german_pagan_reformed
		}
		NOT = {
			has_character_flag = visited_nerthus
		}
	}
	
	# Maybe the goddess can help with my...problem
	option = {
		name = EVTOPTA_Plus_2304
		hidden_tooltip = {
			character_event = { id = Plus.2305 }
		}
	}
	
	# There's nothing wrong with me!
	option = {
		name = EVTOPTB_Plus_2304
	}
}

#Priest gives "cure" chance of reduction of penalty or death
character_event = {
	id = Plus.2305
	desc = EVTDESC_Plus_2305
	picture = GFX_evt_irminsul_shrine
	border = GFX_event_normal_frame_religion
	is_triggered_only = yes
	
	#Bottoms up! (Chance of penalty reduction or death)
	option = {
		name = EVTOPTA_Plus_2305
	}
	
	#I don't trust this charlatan!
	option = {
		name = EVTOPTB_Plus_2305
	}
}

#"Goddess" tired of interacting with mortals, inform rulers
narrative_event = {
	id = Plus.2306
	desc = EVTDESC_Plus_2306
	picture = GFX_evt_irminsul_shrine
	border = GFX_event_normal_frame_religion
	
	only_rulers = yes
	trigger = {
		month = 8
		top_liege = {
			any_demesne_title = { has_title_flag = journey_of_nerthus }
		}
	}
	
	immediate = {
		any_demesne_title = {
			limit = {
				has_title_flag = journey_of_nerthus
			}
			set_title_flag = recent_journey_of_nerthus
			clr_title_flag = journey_of_nerthus
		}
	}
	
	option = {
		name = EVTOPTA_Plus_2306
	}
}

#Ritual purification of cart by initiating priest (Cart and "Goddess", if she is real, are washed then slaves are thrown into the lake and drowned. Only the priest/lord spiritual should see this event.)
narrative_event = {
	id = Plus.2307
	desc = EVTDESC_Plus_2307
	picture = GFX_evt_irminsul_shrine
	border = GFX_event_normal_frame_religion
	
	trigger = {
		has_character_flag = journey_of_nerthus_starter
		top_liege = {
			NOR = {
				any_demesne_title = { has_title_flag = journey_of_nerthus }
				any_demesne_title = { has_title_flag = planning_journey_of_nerthus }
				any_demesne_title = { has_title_flag = adjust_journey_of_nerthus }
			}
		}
	}
	
	immediate = {
		clr_character_flag = journey_of_nerthus_starter
	}
	
	option = {
		name = EVTOPTA_Plus_2307
	}
}

#Journey cancelled, priest died (on death event)
narrative_event = {
	id = Plus.2308
	
	trigger = {
		has_character_flag = journey_of_nerthus_starter
	}
	
	immediate = {
		clr_character_flag = journey_of_nerthus_starter
		top_liege = {
			any_demesne_title = {
				limit = { has_title_flag = journey_of_nerthus }
				clr_title_flag = journey_of_nerthus
			}
			primary_title = {
				set_title_flag = recent_journey_of_nerthus
			}
			character_event = Plus.2309
		}
	}
	
	option = {
		name = EVTOPTA_Plus_2308
	}
}

#Ruler notified of priest's death
character_event = {
	id = Plus.2309
	desc = EVTDESC_Plus_2309
	picture = GFX_evt_irminsul_shrine
	border = GFX_event_normal_frame_religion
	
	is_triggered_only = yes
	
	#It's a shame...
	option = {
		name = EVTOPTA_Plus_2309
		#the below is just to make the purification event fire so the player has a chance of seeing it if they ended up as the lord spiritual upon the death of the former
		any_courtier = {
			limit = {
				liege = { character = ROOT }
				has_job_title = job_spiritual
			}
			set_character_flag = journey_of_nerthus_starter
		}
	}
}

#Journey cancelled because priest replaced by liege
narrative_event = {
	id = Plus.2310
	desc = EVTDESC_Plus_2310
	picture = GFX_evt_irminsul_shrine
	border = GFX_event_normal_frame_religion
	
	only_rulers = yes
	trigger = {
		independent = yes
		any_demesne_title = { has_title_flag = journey_of_nerthus }
		OR = {
			AND = {
				OR = {
					religion = german_pagan
					AND = {
						religion = german_pagan_reformed
						NOT = { any_realm_lord = { has_landed_title = d_german_pagan_reformed } }	
					}
				}
				any_courtier = {
					liege = { character = ROOT }
					has_job_title = job_spiritual
					NOT = { has_character_flag = journey_of_nerthus_starter }
				}
			}
			AND = {
				religion = german_pagan_reformed
				#courtier exception is for if the liege vassalized the religion head mid-journey
				any_courtier = {
					liege = { character = ROOT }
					has_job_title = job_spiritual
					NOT = { has_character_flag = journey_of_nerthus_starter }
				}
				any_realm_lord = {
					has_landed_title = d_german_pagan_reformed
					NOT = { has_character_flag = journey_of_nerthus_starter }
				}
			}
		}
	}
	
	immediate = {
		hidden_tooltip = {
			any_demesne_title = {
				limit = { has_title_flag = journey_of_nerthus }
				clr_title_flag = journey_of_nerthus
			}
			primary_title = {
				set_title_flag = recent_journey_of_nerthus
			}
		}
	}
	
	option = {
		name = EVTOPTA_Plus_2310
	}
}

#Journey cancelled, war (warring during the journey of Nerthus is considered blasphemy)
narrative_event = {
	id = Plus.2311
	desc = EVTDESC_Plus_2309
	picture = GFX_evt_irminsul_shrine
	border = GFX_event_normal_frame_religion
	
	only_rulers = yes
	trigger = {
		war = yes
		OR = {
			any_demesne_title = {
				OR = {
					has_title_flag = planning_journey_of_nerthus
					has_title_flag = journey_of_nerthus
				}
			}
			AND = {
				ai = no
				has_character_flag = journey_of_nerthus_starter
			}
		}
	}
	
	immediate = {
		any_demesne_title = {
			limit = {
				OR = {
					has_title_flag = planning_journey_of_nerthus
					has_title_flag = journey_of_nerthus
				}
			}
			clr_title_flag = planning_journey_of_nerthus
			clr_title_flag = journey_of_nerthus
			set_title_flag = recent_journey_of_nerthus
		}
	}
	
	# The Goddess is offended
	option = {
		piety = -10
		name = EVTOPTA_Plus_2311
	}
}

#flag cleanup
character_event = {
	id = Plus.2312
	hide_window = yes
	
	only_rulers = yes
	trigger = {
		any_demesne_title = {
			had_title_flag = { flag = recent_journey_of_nerthus years = 10 }
		}
	}
	immediate = {
		any_demesne_title = { clr_title_flag = recent_journey_of_nerthus }
	}
}

#Liege became Vassal, journey cancelled
character_event = {
	id = Plus.2313
	desc = EVTDESC_Plus_2313
	picture = GFX_evt_irminsul_shrine
	border = GFX_event_normal_frame_religion
	
	trigger = {
		OR = {
			NOT = { has_landed_title = d_german_pagan_reformed }
			top_liege = { NOT = { religion = german_pagan_reformed } }
		}
		liege = {
			independent = no
			any_demesne_title = {
				has_title_flag = journey_of_nerthus
			}
		}
		has_character_flag = journey_of_nerthus_starter
	}
	
	immediate = {
		hidden_tooltip = {
			clr_character_flag = journey_of_nerthus_starter
			liege = {
				character_event = { id = Plus.2315 }
				any_demesne_title = {
					limit = { has_title_flag = journey_of_nerthus }
					clr_title_flag = journey_of_nerthus
				}
				primary_title = {
					set_title_flag = recent_journey_of_nerthus
				}
			}
		}
	}
	
	# All that planning gone to waste!
	option = {
		name = EVTOPTA_Plus_2313
	}
}

#Maintenance if head of religion (or his liege) is vassalized while planning journey
character_event = {
	id = Plus.2314
	hide_window = yes
	
	only_rulers = yes
	trigger = {
		has_landed_title = d_german_pagan_reformed
		top_liege = { religion = german_pagan_reformed }
		OR = {
			liege = {
				independent = no
				any_demesne_title = {
					OR = {
						has_title_flag = planning_journey_of_nerthus
						has_title_flag = journey_of_nerthus
					}
				}
			}
			AND = {
				independent = no
				any_demesne_title = {
					OR = {
						has_title_flag = planning_journey_of_nerthus
						has_title_flag = journey_of_nerthus
					}
				}
			}
		}
		has_character_flag = journey_of_nerthus_starter
	}
	
	immediate = {
		if = {
			limit = {
				liege = { independent = no }
				any_demesne_title = {
					OR = {
						has_title_flag = planning_journey_of_nerthus
						has_title_flag = journey_of_nerthus
					}
				}
			}
			liege = {
				any_demesne_title = {
					limit = { has_title_flag = journey_of_nerthus }
					set_title_flag = recent_journey_of_nerthus
					clr_title_flag = journey_of_nerthus
				}
				any_demesne_title = {
					limit = { has_title_flag = planning_journey_of_nerthus }
					clr_title_flag = planning_journey_of_nerthus
				}
				primary_title = {
					set_title_flag = adjust_journey_of_nerthus
				}
			}
		}
		any_demesne_title = {
			limit = {
				has_title_flag = journey_of_nerthus
			}
			set_title_flag = recent_journey_of_nerthus
			clr_title_flag = journey_of_nerthus
		}
		any_demesne_title = {
			limit = {
				has_title_flag = planning_journey_of_nerthus
			}
			clr_title_flag = planning_journey_of_nerthus
		}
		primary_title = {
			set_title_flag = adjust_journey_of_nerthus
		}
		top_liege = {
			primary_title = { set_title_flag = planning_journey_of_nerthus }
		}
	}
}

#Liege notified of journey cancellation due to vassalization
character_event = {
	id = Plus.2315
	desc = EVTDESC_Plus_2315
	picture = GFX_evt_irminsul_shrine
	border = GFX_event_normal_frame_religion
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_Plus_2315
	}
}

#Journey cancelled due to top liege religion change
narrative_event = {
	id = Plus.2316
	desc = EVTDESC_Plus_2316
	picture = GFX_evt_irminsul_shrine
	border = GFX_event_normal_frame_religion

	only_rulers = yes
	trigger = {
		top_liege = {
			any_demesne_title = {
				OR = {
					has_title_flag = planning_journey_of_nerthus
					has_title_flag = journey_of_nerthus
				}
			}
			AND = {
				NOT = { religion = german_pagan }
				NOT = { religion = german_pagan_reformed }
			}
		}
	}
	
	immediate = {
		any_demesne_title = {
			limit = {
				OR = {
					has_title_flag = planning_journey_of_nerthus
					has_title_flag = journey_of_nerthus
				}
				clr_title_flag = planning_journey_of_nerthus
				clr_title_flag = journey_of_nerthus
				set_title_flag = recent_journey_of_nerthus
			}
		}
	}
	
	# Option for non-believers
	option = {
		name = EVTOPTA_Plus_2316
	}
	
	# Option for the faithful
	option = {
		name = EVTOPTB_Plus_2316
	}
}

###IRMINSUL EVENTS###
#Irminsul Reborn! (Planting a new world tree to replace the one Charlemagne burned down)
narrative_event = {
	id = Plus.2320
	title = EVT_Plus_2320
	desc = EVTDESC_Plus_2320
	picture = GFX_evt_irminsul_shrine
	border = GFX_event_normal_frame_religion
	is_triggered_only = yes

	#Should probably have some kind of an effect on the religion. MA bonus perhaps?
	immediate = {
		set_global_flag = irminsul_reborn
	}
	
	option = {
		name = EVTOPTA_Plus_2320
	}
}