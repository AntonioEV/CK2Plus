namespace = Plus

#reserved: Plus.600 to Plus.619

#################################
# CK2Plus Succession Events
#################################

### VOTES ON CHANGES TO FEUDAL ELECTIVE OR TANISTRY

# Liege calls de jure vassals to vote on changing the succession law
character_event = {
	id = Plus.600 #formerly 1000182996
	desc = "EVTDESC_Plus_600"
	picture = GFX_evt_council

	is_triggered_only = yes
	
	immediate = {
		random_demesne_title = {
			limit = { has_title_flag = title_to_change }
			clr_title_flag = title_to_change
			save_event_target_as = changed_title
		}
	}

	option = {
		name = "OK"
		if = {
			limit = { has_character_flag = vote_is_for_gavelkind }
			event_target:changed_title = {
				any_de_jure_vassal_title = {
					holder_scope = { set_character_flag = vote_is_for_gavelkind }
					if = {
						limit = {
							OR = {
								AND = {
									PREV = { tier = COUNT }
									tier = BARON
								}
								AND = {
									PREV = { tier = DUKE }
									PREV = { has_law = succ_tanistry }
									tier = BARON
								}
								AND = {
									PREV = { tier = DUKE }
									tier = COUNT
								}
								AND = {
									PREV = { tier = KING }
									PREV = { has_law = succ_tanistry }
									tier = COUNT
								}
								AND = {
									PREV = { tier = KING }
									tier = DUKE
								}
								AND = {
									PREV = { tier = EMPEROR }
									tier = DUKE
								}
								AND = {
									PREV = { tier = EMPEROR }
									tier = KING
								}
							}
							OR = {
								holder_scope = { same_realm = ROOT }
								PREV = { has_law = succ_feudal_elective }
							}
							holder_scope = {
								OR = {
									same_realm = ROOT
									religion = ROOT
								}
								NOT = { has_character_flag = voted_on_gavelkind }
								NOT = { has_landed_title = PREVPREV }
							}
						}
						holder_scope = {
							set_character_flag = voted_on_gavelkind
							letter_event = { id = Plus.601 days = 3 tooltip = CUSTOMTOOLTIP10 }
						}
					}
				}
			}
		}
		if = {
			limit = { has_character_flag = vote_is_for_seniority }
			event_target:changed_title = {
				any_de_jure_vassal_title = {
					holder_scope = { set_character_flag = vote_is_for_seniority }
					if = {
						limit = {
							OR = {
								AND = {
									PREV = { tier = COUNT }
									tier = BARON
								}
								AND = {
									PREV = { tier = DUKE }
									PREV = { has_law = succ_tanistry }
									tier = BARON
								}
								AND = {
									PREV = { tier = DUKE }
									tier = COUNT
								}
								AND = {
									PREV = { tier = KING }
									PREV = { has_law = succ_tanistry }
									tier = COUNT
								}
								AND = {
									PREV = { tier = KING }
									tier = DUKE
								}
								AND = {
									PREV = { tier = EMPEROR }
									tier = DUKE
								}
								AND = {
									PREV = { tier = EMPEROR }
									tier = KING
								}
							}
							OR = {
								holder_scope = { same_realm = ROOT }
								PREV = { has_law = succ_feudal_elective }
							}
							holder_scope = {
								OR = {
									same_realm = ROOT
									religion = ROOT
								}
								NOT = { has_character_flag = voted_on_seniority }
								NOT = { has_landed_title = PREVPREV }
							}
						}
						holder_scope = {
							set_character_flag = voted_on_seniority
							letter_event = { id = Plus.603 days = 3 tooltip = CUSTOMTOOLTIP10 }
						}
					}
				}
			}
		}
		if = {
			limit = { has_character_flag = vote_is_for_primogeniture }
			event_target:changed_title = {
				any_de_jure_vassal_title = {
					holder_scope = { set_character_flag = vote_is_for_primogeniture }
					if = {
						limit = {
							OR = {
								AND = {
									PREV = { tier = COUNT }
									tier = BARON
								}
								AND = {
									PREV = { tier = DUKE }
									PREV = { has_law = succ_tanistry }
									tier = BARON
								}
								AND = {
									PREV = { tier = DUKE }
									tier = COUNT
								}
								AND = {
									PREV = { tier = KING }
									PREV = { has_law = succ_tanistry }
									tier = COUNT
								}
								AND = {
									PREV = { tier = KING }
									tier = DUKE
								}
								AND = {
									PREV = { tier = EMPEROR }
									tier = DUKE
								}
								AND = {
									PREV = { tier = EMPEROR }
									tier = KING
								}
							}
							OR = {
								holder_scope = { same_realm = ROOT }
								PREV = { has_law = succ_feudal_elective }
							}
							holder_scope = {
								OR = {
									same_realm = ROOT
									religion = ROOT
								}
								NOT = { has_character_flag = voted_on_primogeniture }
								NOT = { has_landed_title = PREVPREV }
							}
						}
						holder_scope = {
							set_character_flag = voted_on_primogeniture
							letter_event = { id = Plus.602 days = 3 tooltip = CUSTOMTOOLTIP10 }
						}
					}
				}
			}
		}
		hidden_tooltip = {
			character_event = {
				id = Plus.610
				days = 14
			}
		}
	}
}

# Vassals vote to approve or disapprove Gavelkind
letter_event = {
	id = Plus.601 #formerly 1000182997
	desc = "EVTDESC_Plus_601"

	is_triggered_only = yes

	option = {
		name = "EVTOPTA_Plus_601" #Approve
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0.01
				event_target:changed_title = {
					current_heir = {
						character = ROOT
					}
				}
			}
			modifier = {
				factor = 0.5
				FROM = {
					NOT = { same_realm = ROOT }
				}
			}
			modifier = {
				factor = 0.5
				FROM = {
					NOT = { dynasty = ROOT }
				}
			}
			modifier = {
				factor = 10.0
				FROM = {
					any_child = {
						character = ROOT
					}
				}
			}
			modifier = {
				factor = 0.25
				event_target:changed_title = {
					crownlaw_title = {
						has_law = crown_authority_0
					}
				}
			}
			modifier = {
				factor = 0.5
				event_target:changed_title = {
					crownlaw_title = {
						has_law = crown_authority_1
					}
				}
			}
			modifier = {
				factor = 2.0
				event_target:changed_title = {
					crownlaw_title = {
						has_law = crown_authority_3
					}
				}
			}
			modifier = {
				factor = 4.0
				event_target:changed_title = {
					crownlaw_title = {
						has_law = crown_authority_4
					}
				}
			}
			modifier = {
				factor = 10.0
				FROM = {
					reverse_opinion = {
						who = ROOT
						value = 100
					}
				}
			}
			modifier = {
				factor = 5.0
				FROM = {
					reverse_opinion = {
						who = ROOT
						value = 75
					}
				}
			}
			modifier = {
				factor = 2.0
				FROM = {
					reverse_opinion = {
						who = ROOT
						value = 50
					}
				}
			}
			modifier = {
				factor = 0.5
				NOT = {
					FROM = {
						reverse_opinion = {
							who = ROOT
							value = 25
						}
					}
				}
			}
			modifier = {
				factor = 0.01
				NOT = {
					FROM = {
						reverse_opinion = {
							who = ROOT
							value = 0
						}
					}
				}
			}
		}
		FROM = {
			hidden_tooltip = { change_variable = { which = "succession_law_vote" value = 1 } }
			hidden_tooltip = {
				remove_opinion = {
					modifier = opinion_approved_succession_law
					who = ROOT
				}
				remove_opinion = {
					modifier = opinion_ignored_succession_law
					who = ROOT
				}
			}
			opinion = {
				modifier = opinion_approved_succession_law
				who = ROOT
				months = 120
			}
		}
	}

	option = {
		name = "EVTOPTB_Plus_601" #Ignore
		ai_chance = { factor = 100 }
		FROM = {
			hidden_tooltip = { change_variable = { which = "succession_law_vote" value = -1 } }
			hidden_tooltip = {
				remove_opinion = {
					modifier = opinion_approved_succession_law
					who = ROOT
				}
				remove_opinion = {
					modifier = opinion_ignored_succession_law
					who = ROOT
				}
			}
			opinion = {
				modifier = opinion_ignored_succession_law
				who = ROOT
				months = 120
			}
		}
	}
}

# Vassals vote to approve or disapprove Primogeniture
letter_event = {
	id = Plus.602 #formerly 1000182998
	desc = "EVTDESC_Plus_602"

	is_triggered_only = yes

	option = {
		name = "EVTOPTA_Plus_601" #Approve
		ai_chance = {
			factor = 75
			modifier = {
				factor = 0.01
				event_target:changed_title = {
					current_heir = {
						character = ROOT
					}
				}
			}
			modifier = {
				factor = 0.5
				FROM = {
					NOT = { same_realm = ROOT }
				}
			}
			modifier = {
				factor = 0.5
				FROM = {
					NOT = { dynasty = ROOT }
				}
			}
			modifier = {
				factor = 10.0
				FROM = {
					any_child = {
						character = ROOT
					}
				}
			}
			modifier = {
				factor = 0.5
				event_target:changed_title = {
					crownlaw_title = {
						has_law = crown_authority_0
					}
				}
			}
			modifier = {
				factor = 0.5
				event_target:changed_title = {
					crownlaw_title = {
						has_law = crown_authority_1
					}
				}
			}
			modifier = {
				factor = 2.0
				event_target:changed_title = {
					crownlaw_title = {
						has_law = crown_authority_3
					}
				}
			}
			modifier = {
				factor = 2.0
				event_target:changed_title = {
					crownlaw_title = {
						has_law = crown_authority_4
					}
				}
			}
			modifier = {
				factor = 10.0
				FROM = {
					reverse_opinion = {
						who = ROOT
						value = 100
					}
				}
			}
			modifier = {
				factor = 5.0
				FROM = {
					reverse_opinion = {
						who = ROOT
						value = 75
					}
				}
			}
			modifier = {
				factor = 2.0
				FROM = {
					reverse_opinion = {
						who = ROOT
						value = 50
					}
				}
			}
			modifier = {
				factor = 0.5
				NOT = {
					FROM = {
						reverse_opinion = {
							who = ROOT
							value = 25
						}
					}
				}
			}
			modifier = {
				factor = 0.01
				NOT = {
					FROM = {
						reverse_opinion = {
							who = ROOT
							value = 0
						}
					}
				}
			}
		}
		FROM = {
			hidden_tooltip = { change_variable = { which = "succession_law_vote" value = 1 } }
			hidden_tooltip = {
				remove_opinion = {
					modifier = opinion_approved_succession_law
					who = ROOT
				}
				remove_opinion = {
					modifier = opinion_ignored_succession_law
					who = ROOT
				}
			}
			opinion = {
				modifier = opinion_approved_succession_law
				who = ROOT
				months = 120
			}
		}
	}

	option = {
		name = "EVTOPTB_Plus_601" #Ignore
		ai_chance = { factor = 100 }
		FROM = {
			hidden_tooltip = { change_variable = { which = "succession_law_vote" value = -1 } }
			hidden_tooltip = {
				remove_opinion = {
					modifier = opinion_approved_succession_law
					who = ROOT
				}
				remove_opinion = {
					modifier = opinion_ignored_succession_law
					who = ROOT
				}
			}
			opinion = {
				modifier = opinion_ignored_succession_law
				who = ROOT
				months = 120
			}
		}
	}
}

# Vassals vote to approve or disapprove Seniority
letter_event = {
	id = Plus.603 #formerly 1000182999
	desc = "EVTDESC_Plus_603"

	is_triggered_only = yes

	option = {
		name = "EVTOPTA_Plus_601" #Approve
		ai_chance = {
			factor = 75
			modifier = {
				factor = 0.01
				event_target:changed_title = {
					current_heir = {
						character = ROOT
					}
				}
			}
			modifier = {
				factor = 0.5
				FROM = {
					NOT = { same_realm = ROOT }
				}
			}
			modifier = {
				factor = 0.5
				FROM = {
					NOT = { dynasty = ROOT }
				}
			}
			modifier = {
				factor = 10.0
				FROM = {
					dynasty = ROOT
				}
			}
			modifier = {
				factor = 0.5
				event_target:changed_title = {
					crownlaw_title = {
						has_law = crown_authority_0
					}
				}
			}
			modifier = {
				factor = 0.5
				event_target:changed_title = {
					crownlaw_title = {
						has_law = crown_authority_1
					}
				}
			}
			modifier = {
				factor = 2.0
				event_target:changed_title = {
					crownlaw_title = {
						has_law = crown_authority_3
					}
				}
			}
			modifier = {
				factor = 2.0
				event_target:changed_title = {
					crownlaw_title = {
						has_law = crown_authority_4
					}
				}
			}
			modifier = {
				factor = 10.0
				FROM = {
					reverse_opinion = {
						who = ROOT
						value = 100
					}
				}
			}
			modifier = {
				factor = 5.0
				FROM = {
					reverse_opinion = {
						who = ROOT
						value = 75
					}
				}
			}
			modifier = {
				factor = 2.0
				FROM = {
					reverse_opinion = {
						who = ROOT
						value = 50
					}
				}
			}
			modifier = {
				factor = 0.5
				NOT = {
					FROM = {
						reverse_opinion = {
							who = ROOT
							value = 25
						}
					}
				}
			}
			modifier = {
				factor = 0.01
				NOT = {
					FROM = {
						reverse_opinion = {
							who = ROOT
							value = 0
						}
					}
				}
			}
		}
		FROM = {
			hidden_tooltip = { change_variable = { which = "succession_law_vote" value = 1 } }
			hidden_tooltip = {
				remove_opinion = {
					modifier = opinion_approved_succession_law
					who = ROOT
				}
				remove_opinion = {
					modifier = opinion_ignored_succession_law
					who = ROOT
				}
			}
			opinion = {
				modifier = opinion_approved_succession_law
				who = ROOT
				months = 120
			}
		}
	}

	option = {
		name = "EVTOPTB_Plus_601" #Ignore
		ai_chance = { factor = 100 }
		FROM = {
			hidden_tooltip = { change_variable = { which = "succession_law_vote" value = -1 } }
			hidden_tooltip = {
				remove_opinion = {
					modifier = opinion_approved_succession_law
					who = ROOT
				}
				remove_opinion = {
					modifier = opinion_ignored_succession_law
					who = ROOT
				}
			}
			opinion = {
				modifier = opinion_ignored_succession_law
				who = ROOT
				months = 120
			}
		}
	}
}

# The law passes or is defeated
character_event = {
	id = Plus.610
	desc = "EVTDESC_Plus_610"
	picture = GFX_evt_council

	is_triggered_only = yes

	immediate = {
		if = {
			limit = {
				check_variable = { which = "succession_law_vote" value = -0.5 }
				has_character_flag = vote_is_for_gavelkind
			}
			clr_character_flag = vote_is_for_gavelkind
			event_target:changed_title = {
				#set flag so we know what the former law was
				if = {
					limit = { is_primary_holder_title = yes }
					clr_title_flag = former_gavelkind
					clr_title_flag = former_seniority
					clr_title_flag = former_primogeniture
					clr_title_flag = former_feudal_elective
					clr_title_flag = former_tanistry
					clr_title_flag = former_ultimogeniture
					if = {
						limit = { has_law = succ_feudal_elective }
						set_title_flag = former_feudal_elective
					}
					if = {
						limit = { has_law = succ_tanistry }
						set_title_flag = former_tanistry
					}
				}
			
			
				#set opinion changes for heirs and pretenders
				current_heir = { set_character_flag = former_heir }
				ROOT = {
					any_realm_character = {
						limit = {
							any_pretender_title = { title = event_target:changed_title }
						}
						set_character_flag = former_pretender
					}
					any_independent_ruler = {
						any_realm_character = {
							limit = {
								any_pretender_title = { title = event_target:changed_title }
							}
							set_character_flag = former_pretender
						}
					}
					character_event = { id = Plus.604 days = 1 }
				}
				
				#actually change the law
				add_law = succ_gavelkind
				
				#current heir is unhappy (they have to share) if they were the previous heir
				current_heir = {
					if = { 
						limit = { has_character_flag = former_heir }
						opinion = {
							who = ROOT
							modifier = opinion_succ_law_change
							months = 240
						}
					}
				}
				
				ROOT = {
					#legitimate children are happy
					any_child = {
						limit = {
							NOT = {
								trait = bastard
								trait = monk
								trait = nun
								trait = disinherited
								has_character_flag = former_heir
								has_character_flag = former_pretender
								any_heir_title = { title = event_target:changed_title }
								any_pretender_title = { title = event_target:changed_title }
								has_opinion_modifier = { who = ROOT modifier = opinion_succ_law_change }
								has_opinion_modifier = { who = ROOT modifier = opinion_good_succ_law_change }
								has_opinion_modifier = { who = ROOT modifier = opinion_bad_succ_law_change 	}
							}
						}
						opinion = {
							who = ROOT
							modifier = opinion_good_succ_law_change
							months = 240
						}
					}
					#vassals are slightly upset
					any_vassal = {
						limit = {
							OR = {
								primary_title = { de_jure_liege_or_above = event_target:changed_title }
								event_target:changed_title = { is_primary_holder_title = yes }
								event_target:changed_title = { is_titular = yes }
							}
							NOT = {
								has_opinion_modifier = { who = ROOT modifier = opinion_succ_law_change }
								has_opinion_modifier = { who = ROOT modifier = opinion_good_succ_law_change }
								has_opinion_modifier = { who = ROOT modifier = opinion_bad_succ_law_change 	}
							}
						}
						opinion = {
							who = ROOT
							modifier = opinion_succ_law_change
							months = 240
						}
					}
				}
				
				any_de_jure_vassal_title = {
					limit = {
						holder_scope = { has_character_flag = vote_is_for_gavelkind }
					}
					holder_scope = {
						if = {
							limit = { has_character_flag = voted_on_gavelkind }
							character_event = { id = Plus.611 }
						}
						clr_character_flag = succession_vote
						clr_character_flag = voted_on_gavelkind
						clr_character_flag = vote_is_for_gavelkind
					}
				}
			}
			break = yes
		}
		if = {
			limit = {
				check_variable = { which = "succession_law_vote" value = -0.5 }
				has_character_flag = vote_is_for_primogeniture
			}			
			clr_character_flag = vote_is_for_primogeniture
			event_target:changed_title = {
				#set flag so we know what the former law was
				#set flag so we know what the former law was
				if = {
					limit = { is_primary_holder_title = yes }
					clr_title_flag = former_gavelkind
					clr_title_flag = former_seniority
					clr_title_flag = former_primogeniture
					clr_title_flag = former_feudal_elective
					clr_title_flag = former_tanistry
					clr_title_flag = former_ultimogeniture
					if = {
						limit = { has_law = succ_feudal_elective }
						set_title_flag = former_feudal_elective
					}
					if = {
						limit = { has_law = succ_tanistry }
						set_title_flag = former_tanistry
					}
				}
				
				#set opinion changes for heirs and pretenders
				current_heir = { set_character_flag = former_heir }
				holder_scope = {
					any_realm_character = {
						limit = {
							any_pretender_title = { title = event_target:changed_title }
						}
						set_character_flag = former_pretender
					}
					any_independent_ruler = {
						any_realm_character = {
							limit = {
								any_pretender_title = { title = event_target:changed_title }
							}
							set_character_flag = former_pretender
						}
					}
					character_event = { id = Plus.604 days = 1 }
				}
				
				#actually change the law
				add_law = succ_primogeniture
				
				#current heir is pleased
				current_heir = {
					opinion = {
						who = ROOT
						modifier = opinion_good_succ_law_change
						months = 240
					}
				}
				
				ROOT = {
					#legitimate children are upset
					any_child = {
						limit = {
							NOT = {
								trait = bastard
								trait = monk
								trait = nun
								trait = disinherited
								has_character_flag = former_heir
								has_character_flag = former_pretender
								any_heir_title = { title = event_target:changed_title }
								any_pretender_title = { title = event_target:changed_title }
								has_opinion_modifier = { who = ROOT modifier = opinion_succ_law_change }
								has_opinion_modifier = { who = ROOT modifier = opinion_good_succ_law_change }
								has_opinion_modifier = { who = ROOT modifier = opinion_bad_succ_law_change 	}
							}
						}
						opinion = {
							who = ROOT
							modifier = opinion_bad_succ_law_change
							months = 240
						}
					}
					#vassals are slightly upset
					any_vassal = {
						limit = {
							OR = {
								primary_title = { de_jure_liege_or_above = event_target:changed_title }
								event_target:changed_title = { is_primary_holder_title = yes }
								event_target:changed_title = { is_titular = yes }
							}
							NOT = {
								has_opinion_modifier = { who = ROOT modifier = opinion_succ_law_change }
								has_opinion_modifier = { who = ROOT modifier = opinion_good_succ_law_change }
								has_opinion_modifier = { who = ROOT modifier = opinion_bad_succ_law_change 	}
							}
						}
						opinion = {
							who = ROOT
							modifier = opinion_succ_law_change
							months = 240
						}
					}
				}
				
				any_de_jure_vassal_title = {
					limit = {
						holder_scope = { has_character_flag = vote_is_for_primogeniture }
					}
					holder_scope = {
						if = {
							limit = { has_character_flag = voted_on_primogeniture }
							character_event = { id = Plus.611 }
						}
						clr_character_flag = succession_vote
						clr_character_flag = voted_on_primogeniture
						clr_character_flag = vote_is_for_primogeniture
					}
				}
			}
			break = yes
		}
		if = {
			limit = {
				check_variable = { which = "succession_law_vote" value = -0.5 }
				has_character_flag = vote_is_for_seniority
			}			
			clr_character_flag = vote_is_for_seniority			
			event_target:changed_title = {
				#set flag so we know what the former law was
				if = {
					limit = { is_primary_holder_title = yes }
					clr_title_flag = former_gavelkind
					clr_title_flag = former_seniority
					clr_title_flag = former_primogeniture
					clr_title_flag = former_feudal_elective
					clr_title_flag = former_tanistry
					clr_title_flag = former_ultimogeniture
					if = {
						limit = { has_law = succ_feudal_elective }
						set_title_flag = former_feudal_elective
					}
					if = {
						limit = { has_law = succ_tanistry }
						set_title_flag = former_tanistry
					}
				}
				
				#set opinion changes for heirs and pretenders
				current_heir = { set_character_flag = former_heir }
				holder_scope = {
					any_realm_character = {
						limit = {
							any_pretender_title = { title = event_target:changed_title }
						}
						set_character_flag = former_pretender
					}
					any_independent_ruler = {
						any_realm_character = {
							limit = {
								any_pretender_title = { title = event_target:changed_title }
							}
							set_character_flag = former_pretender
						}
					}
					character_event = { id = Plus.604 days = 1 }
				}

				#actually change the law
				add_law = succ_seniority
				
				ROOT = {
					#legitimate children are angry
					any_child = {
						limit = {
							NOT = {
								trait = bastard
								trait = monk
								trait = nun
								trait = disinherited
								any_heir_title = { title = event_target:changed_title }
								any_pretender_title = { title = event_target:changed_title }
								has_opinion_modifier = { who = ROOT modifier = opinion_succ_law_change }
								has_opinion_modifier = { who = ROOT modifier = opinion_good_succ_law_change }
								has_opinion_modifier = { who = ROOT modifier = opinion_bad_succ_law_change 	}
							}
						}
						opinion = {
							who = ROOT
							modifier = opinion_bad_succ_law_change
							months = 240
						}
					}
					#dynasty members are pleased
					any_dynasty_member = {
						limit = {
							NOT = {
								has_opinion_modifier = { who = ROOT modifier = opinion_succ_law_change }
								has_opinion_modifier = { who = ROOT modifier = opinion_good_succ_law_change }
								has_opinion_modifier = { who = ROOT modifier = opinion_bad_succ_law_change 	}
							}
						}
						opinion = {
							who = ROOT
							modifier = opinion_good_succ_law_change
							months = 240
						}
					}
					#vassals are slightly upset
					any_vassal = {
						limit = {
							OR = {
								primary_title = { de_jure_liege_or_above = event_target:changed_title }
								event_target:changed_title = { is_primary_holder_title = yes }
								event_target:changed_title = { is_titular = yes }
							}
							NOT = {
								has_opinion_modifier = { who = ROOT modifier = opinion_succ_law_change }
								has_opinion_modifier = { who = ROOT modifier = opinion_good_succ_law_change }
								has_opinion_modifier = { who = ROOT modifier = opinion_bad_succ_law_change 	}
							}
						}
						opinion = {
							who = ROOT
							modifier = opinion_succ_law_change
							months = 240
						}
					}
				}
				
				any_de_jure_vassal_title = {
					limit = {
						holder_scope = { has_character_flag = vote_is_for_seniority }
					}
					holder_scope = {
						if = {
							limit = { has_character_flag = voted_on_seniority }
							character_event = { id = Plus.611 }
						}
						clr_character_flag = succession_vote
						clr_character_flag = voted_on_seniority
						clr_character_flag = vote_is_for_seniority
					}
				}
			}
			break = yes
		}
		if = {
			limit = { has_character_flag = vote_is_for_gavelkind }
			clr_character_flag = vote_is_for_gavelkind
			event_target:changed_title = {
				any_de_jure_vassal_title = {
					limit = {
						holder_scope = { has_character_flag = vote_is_for_gavelkind }
					}
					holder_scope = {
						if = {
							limit = { has_character_flag = voted_on_gavelkind }
							character_event = { id = Plus.612 }
						}
						clr_character_flag = succession_vote
						clr_character_flag = voted_on_gavelkind
						clr_character_flag = vote_is_for_gavelkind
					}
				}
			}
			break = yes
		}
		if = {
			limit = { has_character_flag = vote_is_for_primogeniture }
			clr_character_flag = vote_is_for_primogeniture			
			event_target:changed_title = {
				any_de_jure_vassal_title = {
					limit = {
						holder_scope = { has_character_flag = vote_is_for_primogeniture }
					}
					holder_scope = {
						if = {
							limit = { has_character_flag = voted_on_primogeniture }
							character_event = { id = Plus.612 }
						}
						clr_character_flag = succession_vote
						clr_character_flag = voted_on_primogeniture
						clr_character_flag = vote_is_for_primogeniture
					}
				}
			}
			break = yes
		}
		if = {
			limit = { has_character_flag = vote_is_for_seniority }
			clr_character_flag = vote_is_for_seniority			
			event_target:changed_title = {
				any_de_jure_vassal_title = {
					limit = {
						holder_scope = { has_character_flag = vote_is_for_seniority }
					}
					holder_scope = {
						if = {
							limit = { has_character_flag = voted_on_seniority }
							character_event = { id = Plus.612 }
						}
						clr_character_flag = succession_vote
						clr_character_flag = voted_on_seniority
						clr_character_flag = vote_is_for_seniority
					}
				}
			}
			break = yes
		}
	}

	option = {
		name = "EVTOPTA_Plus_610" #Approved
		trigger = {
			check_variable = { which = "succession_law_vote" value = -0.5 }
		}
		hidden_tooltip = {
			set_variable = { which = "succession_law_vote" value = 0 }
		}
		ROOT = {
			custom_tooltip = { text = CUSTOMTOOLTIP8 }
		}
		event_target:changed_title = {
			any_de_jure_vassal_title = {
				limit = {
					holder_scope = {
						reverse_has_opinion_modifier = {
							who = ROOT
							modifier = opinion_approved_succession_law
						}
					}
				}
				holder_scope = {
					custom_tooltip = { text = CUSTOMTOOLTIP8 }
				}
			}
		}
		event_target:changed_title = {
			any_de_jure_vassal_title = {
				limit = {
					holder_scope = {
						reverse_has_opinion_modifier = {
							who = ROOT
							modifier = opinion_ignored_succession_law
						}
					}
				}
				holder_scope = {
					custom_tooltip = { text = CUSTOMTOOLTIP9 }
				}
			}
		}
		clr_character_flag = voting_on_succession_law
	}

	option = {
		name = "EVTOPTB_Plus_610" #Rejected
		trigger = {
			NOT = { check_variable = { which = "succession_law_vote" value = -0.5 } }
		}
		hidden_tooltip = {
			set_variable = { which = "succession_law_vote" value = 0 }
		}
		ROOT = {
			custom_tooltip = { text = CUSTOMTOOLTIP8 }
		}
		event_target:changed_title = {
			any_de_jure_vassal_title = {
				limit = {
					holder_scope = {
						reverse_has_opinion_modifier = {
							who = ROOT
							modifier = opinion_approved_succession_law
						}
					}
				}
				holder_scope = {
					custom_tooltip = { text = CUSTOMTOOLTIP8 }
				}
			}
		}
		event_target:changed_title = {
			any_de_jure_vassal_title = {
				limit = {
					holder_scope = {
						reverse_has_opinion_modifier = {
							who = ROOT
							modifier = opinion_ignored_succession_law
						}
					}
				}
				holder_scope = {
					custom_tooltip = { text = CUSTOMTOOLTIP9 }
				}
			}
		}
		if = {
			limit = { event_target:changed_title = { tier = BARON } }
			prestige = 65
		}
		if = {
			limit = { event_target:changed_title = { tier = COUNT } }
			prestige = 125
		}
		if = {
			limit = { event_target:changed_title = { tier = DUKE } }
			prestige = 250
		}
		if = {
			limit = { event_target:changed_title = { tier = KING } }
			prestige = 375
		}
		if = {
			limit = { event_target:changed_title = { tier = EMPEROR } }
			prestige = 50
		}
		clr_character_flag = voting_on_succession_law
	}
}

# Notification - success
character_event = {
	id = Plus.611
	desc = "EVTDESC_Plus_611"
	picture = GFX_evt_council

	is_triggered_only = yes

	trigger = {
		ai = no
	}

	option = {
		name = "OK"
	}
}

# Notification - failure
character_event = {
	id = Plus.612
	desc = "EVTDESC_Plus_612"
	picture = GFX_evt_council

	is_triggered_only = yes

	trigger = {
		ai = no
	}

	option = {
		name = "OK"
	}
}

### REACTIONS TO SUCCESSION LAW CHANGES

# Base event fired on the ruler after changing a law
character_event = {
	id = Plus.604
	
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		random_demesne_title = {
			limit = { has_title_flag = title_to_change }
			clr_title_flag = title_to_change
			save_event_target_as = changed_title
		}
		# former heir is now neither heir nor pretender
		any_realm_character = {
			limit = {
				has_character_flag = former_heir
				NOT = { any_heir_title = { title = event_target:changed_title } }
				NOT = { any_pretender_title = { title = event_target:changed_title } }
			}
			remove_opinion = { who = ROOT modifier = opinion_succ_law_change }
			remove_opinion = { who = ROOT modifier = opinion_good_succ_law_change }
			remove_opinion = { who = ROOT modifier = opinion_bad_succ_law_change }
			character_event = { id = Plus.605 }
		}
		any_independent_ruler = {
			limit = { NOT = { same_realm = ROOT } }
			any_realm_character = {
				limit = {
					has_character_flag = former_heir
					NOT = { any_heir_title = { title = event_target:changed_title } }
					NOT = { any_pretender_title = { title = event_target:changed_title } }
				}
				remove_opinion = { who = ROOT modifier = opinion_succ_law_change }
				remove_opinion = { who = ROOT modifier = opinion_good_succ_law_change }
				remove_opinion = { who = ROOT modifier = opinion_bad_succ_law_change }
				character_event = { id = Plus.605 }
			}
		}
		
		# former heir is now pretender
		any_realm_character = {
			limit = {
				has_character_flag = former_heir
				NOT = { any_heir_title = { title = event_target:changed_title } }
				NOT = { has_character_flag = former_pretender }
				any_pretender_title = { title = event_target:changed_title }
			}
			remove_opinion = { who = ROOT modifier = opinion_succ_law_change }
			remove_opinion = { who = ROOT modifier = opinion_good_succ_law_change }
			remove_opinion = { who = ROOT modifier = opinion_bad_succ_law_change }
			character_event = { id = Plus.606 }
		}
		any_independent_ruler = {
			limit = { NOT = { same_realm = ROOT } }
			any_realm_character = {
				limit = {
					has_character_flag = former_heir
					NOT = { any_heir_title = { title = event_target:changed_title } }
					NOT = { has_character_flag = former_pretender }
					any_pretender_title = { title = event_target:changed_title }
				}
				remove_opinion = { who = ROOT modifier = opinion_succ_law_change }
				remove_opinion = { who = ROOT modifier = opinion_good_succ_law_change }
				remove_opinion = { who = ROOT modifier = opinion_bad_succ_law_change }
				character_event = { id = Plus.606 }
			}
		}
		
		# former pretender is now neither heir nor pretender
		any_realm_character = {
			limit = {
				has_character_flag = former_pretender
				NOT = { any_heir_title = { title = event_target:changed_title } }
				NOT = { any_pretender_title = { title = event_target:changed_title } }
			}
			remove_opinion = { who = ROOT modifier = opinion_succ_law_change }
			remove_opinion = { who = ROOT modifier = opinion_good_succ_law_change }
			remove_opinion = { who = ROOT modifier = opinion_bad_succ_law_change }
			character_event = { id = Plus.607 }
		}
		any_independent_ruler = {
			limit = { NOT = { same_realm = ROOT } }
			any_realm_character = {
				limit = {
					has_character_flag = former_pretender
					NOT = { any_heir_title = { title = event_target:changed_title } }
					NOT = { any_pretender_title = { title = event_target:changed_title } }
				}
				remove_opinion = { who = ROOT modifier = opinion_succ_law_change }
				remove_opinion = { who = ROOT modifier = opinion_good_succ_law_change }
				remove_opinion = { who = ROOT modifier = opinion_bad_succ_law_change }
				character_event = { id = Plus.607 }
			}
		}
		
		# the new heir
		event_target:changed_title = {
			current_heir = {
				if = {
					limit = {
						NOT = { has_character_flag = former_heir }
					}
					remove_opinion = { who = ROOT modifier = opinion_succ_law_change }
					remove_opinion = { who = ROOT modifier = opinion_good_succ_law_change }
					remove_opinion = { who = ROOT modifier = opinion_bad_succ_law_change }
					character_event = { id = Plus.608 }
				}
			}
		}
		
		# the new pretenders
		any_realm_character = {
			limit = {
				NOT = { has_character_flag = former_heir }
				NOT = { has_character_flag = former_pretender }
				NOT = { any_heir_title = { title = event_target:changed_title } }
				any_pretender_title = { title = event_target:changed_title }
			}
			remove_opinion = { who = ROOT modifier = opinion_succ_law_change }
			remove_opinion = { who = ROOT modifier = opinion_good_succ_law_change }
			remove_opinion = { who = ROOT modifier = opinion_bad_succ_law_change }
			character_event = { id = Plus.609 }
		}
		any_independent_ruler = {
			limit = { NOT = { same_realm = ROOT } }
			any_realm_character = {
				limit = {
					NOT = { has_character_flag = former_heir }
					NOT = { has_character_flag = former_pretender }
					NOT = { any_heir_title = { title = event_target:changed_title } }
					any_pretender_title = { title = event_target:changed_title }
				}
				remove_opinion = { who = ROOT modifier = opinion_succ_law_change }
				remove_opinion = { who = ROOT modifier = opinion_good_succ_law_change }
				remove_opinion = { who = ROOT modifier = opinion_bad_succ_law_change }
				character_event = { id = Plus.609 }
			}
		}
		
		#clear the flags
		any_realm_character = {
			clr_character_flag = former_heir
			clr_character_flag = former_pretender
		}
		any_independent_ruler = {
			limit = { NOT = { same_realm = ROOT } }
			any_realm_character = {
				clr_character_flag = former_heir
				clr_character_flag = former_pretender
			}
		}
	}
}

# A former heir is now neither the heir nor a pretender
character_event = {
	id = Plus.605
	picture = "GFX_evt_scandal"
	desc = "EVTDESC_Plus_605"
	
	is_triggered_only = yes
	
	option = {
		name = "EVTOPTA_Plus_605" #So be it
		trigger = {
			NOT = {
				trait = lunatic
				trait = possessed
			}
		}
		ai_chance = {
			factor = 30
			modifier = {
				factor = 3
				trait = content
			}
			modifier = {
				factor = 2
				trait = humble
			}
			modifier = {
				factor = 1.5
				trait = charitable
			}
			modifier = {
				factor = 1.5
				trait = patient
			}
			modifier = {
				factor = 1.5
				trait = trusting
			}
			modifier = {
				factor = 0.5
				trait = proud
			}
			modifier = {
				factor = 0.25
				trait = ambitious
			}
		}
		FROM = {
			reverse_opinion = {
				who = ROOT
				modifier = opinion_bad_succ_law_change
				months = 240
			}
		}
		event_target:changed_title = {
			current_heir = {
				reverse_opinion = {
					who = ROOT
					modifier = opinion_resentful
					multiplier = 2
					months = 120
				}
			}
		}
		any_realm_character = {
			limit = {
				any_pretender_title = { title = event_target:changed_title }
			}
			reverse_opinion = {
				who = ROOT
				modifier = opinion_resentful
				months = 120
			}
		}
		any_independent_ruler = {
			limit = { NOT = { same_realm = ROOT } }
			any_realm_character = {
				limit = {
					any_pretender_title = { title = event_target:changed_title }
				}
				reverse_opinion = {
					who = ROOT
					modifier = opinion_resentful
					months = 120
				}
			}
		}
		any_realm_character = {
			limit = {
				OR = {
					any_spouse = { character = ROOT }
					any_child = { character = ROOT }
				}
				NOT = { character = FROM }
				NOT = { any_child = { any_heir_title = { title = event_target:changed_title } } }
			}
			hidden_tooltip = {
				remove_opinion = { who = FROM modifier = opinion_bad_succ_law_change }
				remove_opinion = { who = FROM modifier = opinion_good_succ_law_change }
				remove_opinion = { who = FROM modifier = opinion_succ_law_change }
			}
			FROM = {
				reverse_opinion = {
					who = PREV
					modifier = opinion_bad_succ_law_change
					months = 240
				}
			}
			event_target:changed_title = {
				current_heir = {
					reverse_opinion = {
						who = PREVPREV
						modifier = opinion_resentful
						multiplier = 2
						months = 120
					}
				}
			}
			any_realm_character = {
				limit = {
					any_pretender_title = { title = event_target:changed_title }
				}
				reverse_opinion = {
					who = PREV
					modifier = opinion_resentful
					months = 120
				}
			}
			any_independent_ruler = {
				limit = { NOT = { same_realm = ROOT } }
				any_realm_character = {
					limit = {
						any_pretender_title = { title = event_target:changed_title }
					}
					reverse_opinion = {
						who = PREVPREV
						modifier = opinion_resentful
						months = 120
					}
				}
			}
		}
		any_independent_ruler = {
			limit = { NOT = { same_realm = ROOT } }
			any_realm_character = {
				limit = {
					OR = {
						any_spouse = { character = ROOT }
						any_child = { character = ROOT }
					}
					NOT = { character = FROM }
					NOT = { any_child = { any_heir_title = { title = event_target:changed_title } } }
				}
				hidden_tooltip = {
					remove_opinion = { who = FROM modifier = opinion_bad_succ_law_change }
					remove_opinion = { who = FROM modifier = opinion_good_succ_law_change }
					remove_opinion = { who = FROM modifier = opinion_succ_law_change }
				}
				FROM = {
					reverse_opinion = {
						who = PREV
						modifier = opinion_bad_succ_law_change
						months = 240
					}
				}
				event_target:changed_title = {
					current_heir = {
						reverse_opinion = {
							who = PREVPREV
							modifier = opinion_resentful
							multiplier = 2
							months = 120
						}
					}
				}
				any_realm_character = {
					limit = {
						any_pretender_title = { title = event_target:changed_title }
					}
					reverse_opinion = {
						who = PREV
						modifier = opinion_resentful
						months = 120
					}
				}
				any_independent_ruler = {
					limit = { NOT = { same_realm = ROOT } }
					any_realm_character = {
						limit = {
							any_pretender_title = { title = event_target:changed_title }
						}
						reverse_opinion = {
							who = PREVPREV
							modifier = opinion_resentful
							months = 120
						}
					}
				}
			}
		}
	}
	option = {
		name = "EVTOPTB_Plus_605" #This is an outrage!
		ai_chance = {
			factor = 70
			modifier = {
				factor = 3
				trait = ambitious
			}
			modifier = {
				factor = 2
				trait = proud
			}
			modifier = {
				factor = 1.5
				trait = envious
			}
			modifier = {
				factor = 1.5
				trait = greedy
			}
			modifier = {
				factor = 1.5
				trait = wroth
			}
			modifier = {
				factor = 1.5
				trait = paranoid
			}
			modifier = {
				factor = 0.5
				trait = humble
			}
			modifier = {
				factor = 0.25
				trait = content
			}
		}
		FROM = {
			reverse_opinion = {
				who = ROOT
				modifier = succ_law_disinherit
				months = 240
			}
		}
		event_target:changed_title = {
			current_heir = {
				reverse_opinion = {
					who = ROOT
					modifier = opinion_resentful
					multiplier = 5
					months = 240
				}
			}
		}
		any_realm_character = {
			limit = {
				any_pretender_title = { title = event_target:changed_title }
			}
			reverse_opinion = {
				who = ROOT
				modifier = opinion_resentful
				multiplier = 2
				months = 240
			}
		}
		any_independent_ruler = {
			limit = { NOT = { same_realm = ROOT } }
			any_realm_character = {
				limit = {
					any_pretender_title = { title = event_target:changed_title }
				}
				reverse_opinion = {
					who = ROOT
					modifier = opinion_resentful
					multiplier = 2
					months = 240
				}
			}
		}
		any_realm_character = {
			limit = {
				OR = {
					any_spouse = { character = ROOT }
					any_child = { character = ROOT }
				}
				NOT = { character = FROM }
				NOT = { any_child = { any_heir_title = { title = event_target:changed_title } } }
			}
			hidden_tooltip = {
				remove_opinion = { who = FROM modifier = opinion_bad_succ_law_change }
				remove_opinion = { who = FROM modifier = opinion_good_succ_law_change }
				remove_opinion = { who = FROM modifier = opinion_succ_law_change }
			}
			FROM = {
				reverse_opinion = {
					who = PREV
					modifier = opinion_bad_succ_law_change
					multiplier = 2
					months = 240
				}
			}
			event_target:changed_title = {
				current_heir = {
					reverse_opinion = {
						who = PREVPREV
						modifier = opinion_resentful
						multiplier = 5
						months = 240
					}
				}
			}
			any_realm_character = {
				limit = {
					any_pretender_title = { title = event_target:changed_title }
				}
				reverse_opinion = {
					who = PREV
					modifier = opinion_resentful
					multiplier = 2
					months = 240
				}
			}
			any_independent_ruler = {
				limit = { NOT = { same_realm = ROOT } }
				any_realm_character = {
					limit = {
						any_pretender_title = { title = event_target:changed_title }
					}
					reverse_opinion = {
						who = PREVPREV
						modifier = opinion_resentful
						multiplier = 2
						months = 240
					}
				}
			}
		}
		any_independent_ruler = {
			limit = { NOT = { same_realm = ROOT } }
			any_realm_character = {
				limit = {
					OR = {
						any_spouse = { character = ROOT }
						any_child = { character = ROOT }
					}
					NOT = { character = FROM }
					NOT = { any_child = { any_heir_title = { title = event_target:changed_title } } }
				}
				hidden_tooltip = {
					remove_opinion = { who = FROM modifier = opinion_bad_succ_law_change }
					remove_opinion = { who = FROM modifier = opinion_good_succ_law_change }
					remove_opinion = { who = FROM modifier = opinion_succ_law_change }
				}
				FROM = {
					reverse_opinion = {
						who = PREV
						modifier = opinion_bad_succ_law_change
						multiplier = 2
						months = 240
					}
				}
				event_target:changed_title = {
					current_heir = {
						reverse_opinion = {
							who = PREVPREV
							modifier = opinion_resentful
							multiplier = 5
							months = 240
						}
					}
				}
				any_realm_character = {
					limit = {
						any_pretender_title = { title = event_target:changed_title }
					}
					reverse_opinion = {
						who = PREV
						modifier = opinion_resentful
						multiplier = 2
						months = 240
					}
				}
				any_independent_ruler = {
					limit = { NOT = { same_realm = ROOT } }
					any_realm_character = {
						limit = {
							any_pretender_title = { title = event_target:changed_title }
						}
						reverse_opinion = {
							who = PREVPREV
							modifier = opinion_resentful
							multiplier = 2
							months = 240
						}
					}
				}
			}
		}
	}
}

# A former heir is now pretender
character_event = {
	id = Plus.606
	picture = "GFX_evt_scandal"
	desc = "EVTDESC_Plus_606"
	
	is_triggered_only = yes
	
	option = {
		name = "EVTOPTA_Plus_605" #So be it
		trigger = {
			NOT = {
				trait = lunatic
				trait = possessed
			}
		}
		ai_chance = {
			factor = 50
			modifier = {
				factor = 3
				trait = content
			}
			modifier = {
				factor = 2
				trait = humble
			}
			modifier = {
				factor = 1.5
				trait = charitable
			}
			modifier = {
				factor = 1.5
				trait = patient
			}
			modifier = {
				factor = 1.5
				trait = trusting
			}
			modifier = {
				factor = 0.5
				trait = proud
			}
			modifier = {
				factor = 0.25
				trait = ambitious
			}
		}
		FROM = {
			reverse_opinion = {
				who = ROOT
				modifier = opinion_bad_succ_law_change
				months = 240
			}
		}
		event_target:changed_title = {
			current_heir = {
				reverse_opinion = {
					who = ROOT
					modifier = opinion_resentful
					multiplier = 2
					months = 120
				}
			}
		}
		any_realm_character = {
			limit = {
				OR = {
					any_spouse = { character = ROOT }
					any_child = { character = ROOT }
				}
				NOT = { character = FROM }
				NOT = { any_child = { any_heir_title = { title = event_target:changed_title } } }
			}
			hidden_tooltip = {
				remove_opinion = { who = FROM modifier = opinion_bad_succ_law_change }
				remove_opinion = { who = FROM modifier = opinion_good_succ_law_change }
				remove_opinion = { who = FROM modifier = opinion_succ_law_change }
			}
			FROM = {
				reverse_opinion = {
					who = PREV
					modifier = opinion_bad_succ_law_change
					months = 240
				}
			}
			event_target:changed_title = {
				current_heir = {
					reverse_opinion = {
						who = PREVPREV
						modifier = opinion_resentful
						multiplier = 2
						months = 120
					}
				}
			}
		}
		any_independent_ruler = {
			limit = { NOT = { same_realm = ROOT } }
			any_realm_character = {
				limit = {
					OR = {
						any_spouse = { character = ROOT }
						any_child = { character = ROOT }
					}
					NOT = { character = FROM }
					NOT = { any_child = { any_heir_title = { title = event_target:changed_title } } }
				}
				hidden_tooltip = {
					remove_opinion = { who = FROM modifier = opinion_bad_succ_law_change }
					remove_opinion = { who = FROM modifier = opinion_good_succ_law_change }
					remove_opinion = { who = FROM modifier = opinion_succ_law_change }
				}
				FROM = {
					reverse_opinion = {
						who = PREV
						modifier = opinion_bad_succ_law_change
						months = 240
					}
				}
				event_target:changed_title = {
					current_heir = {
						reverse_opinion = {
							who = PREVPREV
							modifier = opinion_resentful
							multiplier = 2
							months = 120
						}
					}
				}
			}
		}
	}
	option = {
		name = "EVTOPTB_Plus_605" #This is an outrage!
		ai_chance = {
			factor = 50
			modifier = {
				factor = 3
				trait = ambitious
			}
			modifier = {
				factor = 2
				trait = proud
			}
			modifier = {
				factor = 1.5
				trait = envious
			}
			modifier = {
				factor = 1.5
				trait = greedy
			}
			modifier = {
				factor = 1.5
				trait = wroth
			}
			modifier = {
				factor = 1.5
				trait = paranoid
			}
			modifier = {
				factor = 0.5
				trait = humble
			}
			modifier = {
				factor = 0.25
				trait = content
			}
		}
		FROM = {
			reverse_opinion = {
				who = ROOT
				modifier = opinion_bad_succ_law_change
				multiplier = 2
				months = 240
			}
		}
		event_target:changed_title = {
			current_heir = {
				reverse_opinion = {
					who = ROOT
					modifier = opinion_resentful
					multiplier = 5
					months = 240
				}
			}
		}
		any_realm_character = {
			limit = {
				OR = {
					any_spouse = { character = ROOT }
					any_child = { character = ROOT }
				}
				NOT = { character = FROM }
				NOT = { any_child = { any_heir_title = { title = event_target:changed_title } } }
			}
			hidden_tooltip = {
				remove_opinion = { who = FROM modifier = opinion_bad_succ_law_change }
				remove_opinion = { who = FROM modifier = opinion_good_succ_law_change }
				remove_opinion = { who = FROM modifier = opinion_succ_law_change }
			}
			FROM = {
				reverse_opinion = {
					who = PREV
					modifier = opinion_bad_succ_law_change
					multiplier = 2
					months = 240
				}
			}
			event_target:changed_title = {
				current_heir = {
					reverse_opinion = {
						who = PREVPREV
						modifier = opinion_resentful
						multiplier = 5
						months = 240
					}
				}
			}
		}
		any_independent_ruler = {
			limit = { NOT = { same_realm = ROOT } }
			any_realm_character = {
				limit = {
					OR = {
						any_spouse = { character = ROOT }
						any_child = { character = ROOT }
					}
					NOT = { character = FROM }
					NOT = { any_child = { any_heir_title = { title = event_target:changed_title } } }
				}
				hidden_tooltip = {
					remove_opinion = { who = FROM modifier = opinion_bad_succ_law_change }
					remove_opinion = { who = FROM modifier = opinion_good_succ_law_change }
					remove_opinion = { who = FROM modifier = opinion_succ_law_change }
				}
				FROM = {
					reverse_opinion = {
						who = PREV
						modifier = opinion_bad_succ_law_change
						multiplier = 2
						months = 240
					}
				}
				event_target:changed_title = {
					current_heir = {
						reverse_opinion = {
							who = PREVPREV
							modifier = opinion_resentful
							multiplier = 5
							months = 240
						}
					}
				}
			}
		}
	}
}

# A former pretender is now neither the heir nor a pretender
character_event = {
	id = Plus.607
	picture = "GFX_evt_scandal"
	desc = "EVTDESC_Plus_607"
	
	is_triggered_only = yes
	
	option = {
		name = "EVTOPTA_Plus_605" #So be it
		trigger = {
			NOT = {
				trait = lunatic
				trait = possessed
			}
		}
		ai_chance = {
			factor = 70
			modifier = {
				factor = 3
				trait = content
			}
			modifier = {
				factor = 2
				trait = humble
			}
			modifier = {
				factor = 1.5
				trait = charitable
			}
			modifier = {
				factor = 1.5
				trait = patient
			}
			modifier = {
				factor = 1.5
				trait = trusting
			}
			modifier = {
				factor = 0.5
				trait = proud
			}
			modifier = {
				factor = 0.25
				trait = ambitious
			}
		}
		FROM = {
			reverse_opinion = {
				who = ROOT
				modifier = opinion_bad_succ_law_change
				months = 240
			}
		}
		any_realm_character = {
			limit = {
				OR = {
					any_spouse = { character = ROOT }
					any_child = { character = ROOT }
				}
				NOT = { character = FROM }
				NOT = { any_child = { any_heir_title = { title = event_target:changed_title } } }
			}
			hidden_tooltip = {
				remove_opinion = { who = FROM modifier = opinion_bad_succ_law_change }
				remove_opinion = { who = FROM modifier = opinion_good_succ_law_change }
				remove_opinion = { who = FROM modifier = opinion_succ_law_change }
			}
			opinion = {
				who = FROM
				modifier = opinion_bad_succ_law_change
				months = 240
			}
		}
		any_independent_ruler = {
			limit = { NOT = { same_realm = ROOT } }
			any_realm_character = {
				limit = {
					OR = {
						any_spouse = { character = ROOT }
						any_child = { character = ROOT }
					}
					NOT = { character = FROM }
					NOT = { any_child = { any_heir_title = { title = event_target:changed_title } } }
				}
				hidden_tooltip = {
					remove_opinion = { who = FROM modifier = opinion_bad_succ_law_change }
					remove_opinion = { who = FROM modifier = opinion_good_succ_law_change }
					remove_opinion = { who = FROM modifier = opinion_succ_law_change }
				}
				opinion = {
					who = FROM
					modifier = opinion_bad_succ_law_change
					months = 240
				}
			}
		}
	}
	option = {
		name = "EVTOPTB_Plus_605" #This is an outrage!
		ai_chance = {
			factor = 30
			modifier = {
				factor = 3
				trait = ambitious
			}
			modifier = {
				factor = 2
				trait = proud
			}
			modifier = {
				factor = 1.5
				trait = envious
			}
			modifier = {
				factor = 1.5
				trait = greedy
			}
			modifier = {
				factor = 1.5
				trait = wroth
			}
			modifier = {
				factor = 1.5
				trait = paranoid
			}
			modifier = {
				factor = 0.5
				trait = humble
			}
			modifier = {
				factor = 0.25
				trait = content
			}
		}
		FROM = {
			reverse_opinion = {
				who = ROOT
				modifier = opinion_bad_succ_law_change
				multiplier = 2
				months = 240
			}
		}
		event_target:changed_title = {
			current_heir = {
				reverse_opinion = {
					who = ROOT
					modifier = opinion_resentful
					multiplier = 2
					months = 240
				}
			}
		}
		any_realm_character = {
			limit = {
				any_pretender_title = { title = event_target:changed_title }
			}
			reverse_opinion = {
				who = ROOT
				modifier = opinion_resentful
				months = 240
			}
		}
		any_independent_ruler = {
			limit = { NOT = { same_realm = ROOT } }
			any_realm_character = {
				limit = {
					any_pretender_title = { title = event_target:changed_title }
				}
				reverse_opinion = {
					who = ROOT
					modifier = opinion_resentful
					months = 240
				}
			}
		}
		any_realm_character = {
			limit = {
				OR = {
					any_spouse = { character = ROOT }
					any_child = { character = ROOT }
				}
				NOT = { character = FROM }
				NOT = { any_child = { any_heir_title = { title = event_target:changed_title } } }
			}
			hidden_tooltip = {
				remove_opinion = { who = FROM modifier = opinion_bad_succ_law_change }
				remove_opinion = { who = FROM modifier = opinion_good_succ_law_change }
				remove_opinion = { who = FROM modifier = opinion_succ_law_change }
			}
			FROM = {
				reverse_opinion = {
					who = PREV
					modifier = opinion_bad_succ_law_change
					multiplier = 2
					months = 240
				}
			}
			event_target:changed_title = {
				current_heir = {
					reverse_opinion = {
						who = PREVPREV
						modifier = opinion_resentful
						multiplier = 2
						months = 240
					}
				}
			}
			any_realm_character = {
				limit = {
					any_pretender_title = { title = event_target:changed_title }
				}
				reverse_opinion = {
					who = PREV
					modifier = opinion_resentful
					months = 240
				}
			}
			any_independent_ruler = {
				limit = { NOT = { same_realm = ROOT } }
				any_realm_character = {
					limit = {
						any_pretender_title = { title = event_target:changed_title }
					}
					reverse_opinion = {
						who = PREVPREV
						modifier = opinion_resentful
						months = 240
					}
				}
			}
		}
		any_independent_ruler = {
			limit = { NOT = { same_realm = ROOT } }
			any_realm_character = {
				limit = {
					OR = {
						any_spouse = { character = ROOT }
						any_child = { character = ROOT }
					}
					NOT = { character = FROM }
					NOT = { any_child = { any_heir_title = { title = event_target:changed_title } } }
				}
				hidden_tooltip = {
					remove_opinion = { who = FROM modifier = opinion_bad_succ_law_change }
					remove_opinion = { who = FROM modifier = opinion_good_succ_law_change }
					remove_opinion = { who = FROM modifier = opinion_succ_law_change }
				}
				FROM = {
					reverse_opinion = {
						who = PREV
						modifier = opinion_bad_succ_law_change
						multiplier = 2
						months = 240
					}
				}
				event_target:changed_title = {
					current_heir = {
						reverse_opinion = {
							who = PREVPREV
							modifier = opinion_resentful
							multiplier = 2
							months = 240
						}
					}
				}
				any_realm_character = {
					limit = {
						any_pretender_title = { title = event_target:changed_title }
					}
					reverse_opinion = {
						who = PREV
						modifier = opinion_resentful
						months = 240
					}
				}
				any_independent_ruler = {
					limit = { NOT = { same_realm = ROOT } }
					any_realm_character = {
						limit = {
							any_pretender_title = { title = event_target:changed_title }
						}
						reverse_opinion = {
							who = PREVPREV
							modifier = opinion_resentful
							months = 240
						}
					}
				}
			}
		}
	}
}

# The new heir is informed
character_event = {
	id = Plus.608
	picture = "GFX_evt_emissary"
	desc = "EVTDESC_Plus_608"
	
	is_triggered_only = yes
	
	option = {
		name = "EXCELLENT"
		opinion = {
			who = FROM
			modifier = opinion_good_succ_law_change
			multiplier = 2
			months = 240
		}
		any_realm_character = {
			limit = {
				OR = {
					any_spouse = { character = ROOT }
					any_child = { character = ROOT }
				}
				NOT = { character = FROM }
			}
			hidden_tooltip = {
				remove_opinion = { who = FROM modifier = opinion_bad_succ_law_change }
				remove_opinion = { who = FROM modifier = opinion_good_succ_law_change }
				remove_opinion = { who = FROM modifier = opinion_succ_law_change }
			}
			opinion = {
				who = FROM
				modifier = opinion_good_succ_law_change
				months = 240
			}
		}
		any_independent_ruler = {
			limit = { NOT = { same_realm = ROOT } }
			any_realm_character = {
				limit = {
					OR = {
						any_spouse = { character = ROOT }
						any_child = { character = ROOT }
					}
					NOT = { character = FROM }
				}
				hidden_tooltip = {
					remove_opinion = { who = FROM modifier = opinion_bad_succ_law_change }
					remove_opinion = { who = FROM modifier = opinion_good_succ_law_change }
					remove_opinion = { who = FROM modifier = opinion_succ_law_change }
				}
				opinion = {
					who = FROM
					modifier = opinion_good_succ_law_change
					months = 240
				}
			}
		}
	}
}

# The new pretenders are informed
character_event = {
	id = Plus.609
	picture = "GFX_evt_emissary"
	desc = "EVTDESC_Plus_609"
	
	is_triggered_only = yes
	
	option = {
		name = "EXCELLENT"
		opinion = {
			who = FROM
			modifier = opinion_good_succ_law_change
			months = 240
		}
		any_realm_character = {
			limit = {
				OR = {
					any_spouse = { character = ROOT }
					any_child = { character = ROOT }
				}
				NOT = { character = FROM }
			}
			hidden_tooltip = {
				remove_opinion = { who = FROM modifier = opinion_bad_succ_law_change }
				remove_opinion = { who = FROM modifier = opinion_good_succ_law_change }
				remove_opinion = { who = FROM modifier = opinion_succ_law_change }
			}
			opinion = {
				who = FROM
				modifier = opinion_good_succ_law_change
				months = 240
			}
		}
		any_independent_ruler = {
			limit = { NOT = { same_realm = ROOT } }
			any_realm_character = {
				limit = {
					OR = {
						any_spouse = { character = ROOT }
						any_child = { character = ROOT }
					}
					NOT = { character = FROM }
				}
				hidden_tooltip = {
					remove_opinion = { who = FROM modifier = opinion_bad_succ_law_change }
					remove_opinion = { who = FROM modifier = opinion_good_succ_law_change }
					remove_opinion = { who = FROM modifier = opinion_succ_law_change }
				}
				opinion = {
					who = FROM
					modifier = opinion_good_succ_law_change
					months = 240
				}
			}
		}
	}
}

#Option to create cadet-branch dynasty 
#on inheritance from distant relative 
#or usurpation via war 
character_event = {
	id = Plus.613
	picture = "GFX_evt_coronation"
	
	desc = {
		text = "EVTDESCA_Plus_613"
		trigger = {
			FROMFROM = { has_opinion_modifier = { who = ROOT modifier = opinion_usurped_title } }			
		}
	}
	
	desc = {
		text = "EVTDESCB_Plus_613"
		trigger = {			
			NOT = {
				FROMFROM = { has_opinion_modifier = { who = ROOT modifier = opinion_usurped_title } }				
			}
		}
	}
	
	#hide_window = yes		
	is_triggered_only = yes
	only_playable = yes
	
	trigger = {		
		#ai = yes
		dynasty_head = {
			NOT = { character = ROOT }
		}
		FROM = { 
			is_primary_holder_title = yes
			higher_tier_than = count
			OR = {
				is_feudal = yes
				is_tribal = yes
			}
		}
		FROMFROM = { 
			dynasty = ROOT 
			any_dynasty_member = { is_alive = yes count = 40 }
		}
		OR = {
			FROMFROM = { has_opinion_modifier = { who = ROOT modifier = opinion_usurped_title } }
			NOT = {
				FROMFROM = { is_close_relative = ROOT }
				FROM = { has_law = succ_tanistry }
				FROM = { has_law = succ_feudal_elective }
				dynasty_head = {					
					primary_title = {
						higher_tier_than = FROM
						has_law = succ_tanistry
					}
				}
			}			
		}
	}
	
	option = {
		name = EVTOPTA_Plus_613
		ai_chance = {
			factor = 25
			modifier = {
				factor = 4
				FROMFROM = { has_opinion_modifier = { who = ROOT modifier = opinion_usurped_title } }
				NOT = {
					FROMFROM = { is_close_relative = ROOT }
					FROM = { has_law = succ_tanistry }
				}
			}
			modifier = {
				factor = 1.5
				independent = yes
			}			
			modifier = {
				factor = 1.25
				num_of_children = 1
			}
			modifier = {
				factor = 1.5
				NOT = { dynasty_head = { culture = ROOT } }
			}
			modifier = {
				factor = 1.5
				NOT = { dynasty_head = { culture_group = ROOT } }
			}
			modifier = {
				factor = 1.5
				FROM = { tier = KING }
			}
			modifier = {
				factor = 2
				FROM = { tier = EMPEROR }
			}
			modifier = {
				factor = 0.75
				OR = {
					ROOT = { mother_even_if_dead = { is_close_relative = FROMFROM } }
					ROOT = { father_even_if_dead = { is_close_relative = FROMFROM } }
				}
			}
		}
		ROOT = {
			#notify members of old dynasty and rulers in new realm							
			any_dynasty_member = { 					
				character_event = { id = Plus.614 days = 3 }
			}			
			any_realm_lord = {
				character_event = { id = Plus.614 days = 3 }
			}
			if = {
				limit = { mother_even_if_dead = { dynasty = FROMFROM } }
				dynasty = mother_bastard
			}
			if = {
				limit = { father_even_if_dead = { dynasty = FROMFROM } }
				dynasty = father_bastard
			}			
			#log = "Plus.613: [Root.GetTitledName] ascends the throne in the [From.GetFullBaseName] and founds House [Root.GetOnlyDynastyName], a cadet branch of House [FromFrom.GetOnlyDynastyName]."									
			any_child = {
				limit = { dynasty = FROMFROM }
				dynasty = ROOT
				any_child = {
					limit = { dynasty = FROMFROM }
					dynasty = ROOT
					any_child = {
						limit = { dynasty = FROMFROM }
						dynasty = ROOT
						any_child = {
							limit = { dynasty = FROMFROM }
							dynasty = ROOT
						}
					}
				}
			}
			#chronicle entry for players in new dynasty
			any_dynasty_member = {
				limit = {
					ai = no					
				}
				chronicle = {
					entry = CHRONICLE_CADET_BRANCH
					portrait = [Root.GetID]
					picture = GFX_evt_coronation
				}
			}
		}
	}
	
	option = {
		name = "EVTOPTB_Plus_613"
		ai_chance = {
			factor = 75
		}
	}	
}

#Cadet Branch: notification for player members of old dynasty
#FROM: founder of new dynasty
#FROMFROM: title inherited/seized by founder
#FROMFROMFROM: previous holder of relevant title
character_event = {
	id = Plus.614
	picture = "GFX_evt_coronation"
	desc = "EVTDESC_Plus_614"
	
	is_triggered_only = yes
	only_playable = yes
	
	option = {
		name = EVTOPTC_Plus_1215
		#chronicle entry if player is in old dynasty
		if = {
			limit = {
				ai = no
				dynasty = FROMFROMFROM
			}
			chronicle = {
				entry = CHRONICLE_CADET_BRANCH
				portrait = [From.GetID]
				picture = GFX_evt_coronation
			}
		}
	}
}