namespace = Plus

#reserved: Plus.300 to Plus.399

#######################################
# CK2Plus Plot Events
#######################################

character_event = { # AI plot check
	id = Plus.300
	is_triggered_only = yes
	hide_window = yes
	
	ai = yes
	prisoner = no
	capable_only = yes
	min_age = 16

	trigger = {
		ai = yes
		NOT = { has_character_flag = plot_check }
		OR = {
			has_plot = plot_seize_trade_post
			has_plot = plot_discredit_councillor
			has_plot = plot_embezzle_from_liege
			has_plot = plot_kidnapping
			has_plot = plot_fabricate_treason
			has_plot = plot_fabricate_treason_liege
			has_plot = plot_fabricate_heresy
			has_plot = plot_gain_liege_title
			has_plot = plot_gain_fellow_vassal_title
			has_plot = plot_weaken_fellow_vassal
			has_plot = plot_kidnap_liege
			has_plot = plot_kill_character
			has_plot = plot_take_revenge
			has_plot = plot_kill_spouse
			has_plot = plot_seduce
		}
	}

	weight_multiplier = {
		days = 1
	}

	immediate = {
		set_character_flag = plot_check
		plot_target_char = {
			any_courtier = {
				limit = { NOT = { is_plot_target_of = ROOT } }
				remove_opinion = {
					who = ROOT
					modifier = opinion_plot_help
				}
				opinion = {
					who = ROOT
					modifier = opinion_plot_help
					years = 5
				}
			}
			any_vassal = {
				limit = { NOT = { is_plot_target_of = ROOT } }
				remove_opinion = {
					who = ROOT
					modifier = opinion_plot_help
				}
				opinion = {
					who = ROOT
					modifier = opinion_plot_help
					years = 5
				}
			}
			liege = {
				any_courtier = {
					limit = { NOT = { is_plot_target_of = ROOT } }
					remove_opinion = {
						who = ROOT
						modifier = opinion_plot_help
					}
					opinion = {
						who = ROOT
						modifier = opinion_plot_help
						years = 5
					}
				}
				any_vassal = {
					limit = { NOT = { is_plot_target_of = ROOT } }
					remove_opinion = {
						who = ROOT
						modifier = opinion_plot_help
					}
					opinion = {
						who = ROOT
						modifier = opinion_plot_help
						years = 5
					}
				}
			}
		}
	}
}

character_event = { # Cancel AI plot if too few helpers and has taken too long
	id = Plus.301
	hide_window = yes

	ai = yes
	prisoner = no
	capable_only = yes
	min_age = 16
	
	trigger = {
		ai = yes
		OR = {
			has_plot = plot_seize_trade_post
			has_plot = plot_discredit_councillor
			has_plot = plot_embezzle_from_liege
			has_plot = plot_kidnapping
			has_plot = plot_fabricate_treason
			has_plot = plot_fabricate_treason_liege
			has_plot = plot_fabricate_heresy
			has_plot = plot_gain_liege_title
			has_plot = plot_gain_fellow_vassal_title
			has_plot = plot_weaken_fellow_vassal
			has_plot = plot_kidnap_liege
			has_plot = plot_kill_character
			has_plot = plot_take_revenge
			has_plot = plot_kill_spouse
			has_plot = plot_seduce
		}
		had_character_flag = {
			flag = plot_check
			days = 1825
		}
		OR = {
			NOT = { num_of_plot_backers = 1 }
			had_character_flag = {
				flag = plot_check
				days = 2750
			}
		}
		OR = {
			NOT = { num_of_plot_backers = 2 }
			had_character_flag = {
				flag = plot_check
				days = 3650
			}
		}
	}

	mean_time_to_happen = {
		months = 1
	}

	immediate = {
		set_character_flag = abort_plot
	}
}

character_event = { # Allow AI plotting
	id = Plus.302
	is_triggered_only = yes
	hide_window = yes
	
	min_age = 16
	prisoner = no
	capable_only = yes
	ai = yes

	trigger = {
		ai = yes
		NOT = { has_character_flag = allow_plotting }
		NOT = {
			has_plot = plot_seize_trade_post
			has_plot = plot_discredit_councillor
			has_plot = plot_embezzle_from_liege
			has_plot = plot_kidnapping
			has_plot = plot_fabricate_treason
			has_plot = plot_fabricate_treason_liege
			has_plot = plot_fabricate_heresy
			has_plot = plot_gain_liege_title
			has_plot = plot_gain_fellow_vassal_title
			has_plot = plot_weaken_fellow_vassal
			has_plot = plot_kidnap_liege
			has_plot = plot_kill_character
			has_plot = plot_take_revenge
			has_plot = plot_kill_spouse
			has_plot = plot_seduce
		}
	}

	weight_multiplier = {
		days = 1
		modifier = {
			factor = 0.5
			is_ruler = no
			is_councillor = no
		}
		modifier = {
			factor = 2
			is_ruler = yes
			tier = COUNT
		}
		modifier = {
			factor = 5
			is_ruler = yes
			tier = DUKE
		}
		modifier = {
			factor = 10
			is_ruler = yes
			higher_tier_than = DUKE
		}
		modifier = {
			factor = 3
			has_job_title = job_spymaster
		}
		modifier = {
			factor = 0.5
			NOT = { intrigue = 5 }
		}
		modifier = {
			factor = 0.75
			NOT = { intrigue = 10 }
		}
		modifier = {
			factor = 1.25
			trait = amateurish_plotter
		}
		modifier = {
			factor = 1.5
			trait = flamboyant_schemer
		}
		modifier = {
			factor = 2
			trait = intricate_webweaver
		}
		modifier = {
			factor = 3
			trait = elusive_shadow
		}
		modifier = {
			factor = 2
			intrigue = 10
		}
		modifier = {
			factor = 2
			intrigue = 15
		}
		modifier = {
			factor = 2
			intrigue = 20
		}
		modifier = {
			factor = 0.5
			OR = {
				trait = content
				trait = honest
				trait = kind
				trait = just
			}
		}
		modifier = {
			factor = 10
			OR = {
				trait = lunatic
				trait = possessed
			}
		}
	}

	immediate = {
		set_character_flag = allow_plotting
	}
}

