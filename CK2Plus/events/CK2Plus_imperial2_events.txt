namespace = Plus

#reserved: Plus.3300 to Plus.3399

#######################################
# MORE IMPERIAL EVENTS
# Written by Rylock
#######################################

# Relative wants to go to the imperial capital to serve
character_event = {
	id = Plus.3300
	
	hide_window = yes
	
	ai = yes
	min_age = 16
	max_age = 40
	capable_only = yes
	prisoner = no

	trigger = {
		independent = no
		is_ruler = no
		liege = {
			higher_real_tier_than = COUNT
			is_feudal = yes
			religion = ROOT
			has_regent = no
			war = no
			ROOT = {
				is_close_relative = PREV
				host = { character = PREVPREV }
			}
		}
		top_liege = {
			real_tier = EMPEROR
			is_feudal = yes
			religion = ROOT
			war = no
			NOR = {
				is_liege_of = ROOT
				any_courtier = {
					is_ruler = no
					count = 50
				}
			}
		}
		OR = {
			is_female = no
			AND = {
				is_married = no
				liege = {
					OR = {
						has_law = true_cognatic_succession
						has_law = enatic_cognatic_succession
						has_law = enatic_succession
					}
				}
				top_liege = {
					OR = {
						has_law = true_cognatic_succession
						has_law = enatic_cognatic_succession
						has_law = enatic_succession
					}
				}
			}
		}
		OR = {
			trait = ambitious
			trait = diligent
			martial = 12
			diplomacy = 12
			stewardship = 12
			intrigue = 12
		}
		NOR = {
			is_ill = yes
			in_command = yes
			is_voter = yes
			trait = slothful
			trait = content
			trait = stressed
			trait = depressed
			trait = in_hiding
			trait = monk
			trait = nun
			trait = desert_mother
			trait = desert_father
			any_spouse = {
				trait = pregnant
				father_of_unborn = { character = ROOT }
			}
			any_child = {
				NOT = { trait = bastard }
				is_alive = yes
			}
			any_liege = { holy_order = yes }
			any_liege = { mercenary = yes }
			has_minor_title = title_appointed_regent
			has_minor_title = title_commander
			has_character_modifier = planning_claimant_adventure
			has_character_modifier = planning_new_temple
			has_character_flag = serving_fianna
			has_character_flag = serving_gwydion
			has_character_flag = serving_varangian
			has_character_flag = served_empire
			has_character_flag = serving_empire
			has_character_flag = denied_serving_empire
		}
	}
	
	mean_time_to_happen = {
		months = 120
		modifier = {
			factor = 0.5
			trait = ambitious
		}
		modifier = {
			factor = 0.5
			trait = diligent
		}
		modifier = {
			factor = 0.5
			OR = {
				trait = administrator
				trait = socializer
				trait = schemer
			}
		}
		modifier = {
			factor = 0.5
			NOT = { any_heir_title = { always = yes } }
		}
		modifier = {
			factor = 1.5
			trait = humble
		}
		modifier = {
			factor = 1.5
			trait = shy
		}
		modifier = {
			factor = 1.5
			any_heir_title = { always = yes }
		}
	}
	
	immediate = {
		liege = { character_event = { id = Plus.3301 } }
	}
}

# Liege is asked to let them go to the capital
character_event = {
	id = Plus.3301
	desc = EVTDESC_Plus_3301
	picture = GFX_evt_emissary
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_Plus_3301 # Refuse
		ai_chance = {
			factor = 25
			modifier = {
				factor = 3
				trait = cruel
			}
			modifier = {
				factor = 3
				trait = paranoid
			}
			modifier = {
				factor = 2
				trait = slothful
			}
			modifier = {
				factor = 0.5
				trait = diligent
			}
			modifier = {
				factor = 0.5
				trait = kind
			}
			modifier = {
				factor = 0.5
				trait = trusting
			}
			modifier = {
				factor = 3
				current_heir = { character = FROM }
			}
			modifier = {
				factor = 2
				FROM = { is_female = yes }
			}
			modifier = {
				factor = 0.5
				FROM = { is_married = no }
			}
			modifier = {
				factor = 1.5
				FROM = { is_married = yes }
			}
			modifier = {
				factor = 1.5
				FROM = {
					any_child = { NOT = { trait = bastard } }
				}
			}
		}
		FROM = {
			prestige = -50
			set_character_flag = denied_serving_empire
			opinion = {
				modifier = opinion_very_disappointed
				years = 10
				who = ROOT
			}
		}
	}
	option = {
		name = EVTOPTB_Plus_3301 # Permit it
		ai_chance = {
			factor = 75
		}
		FROM = {
			prestige = 50
			set_character_flag = serving_empire
			opinion = {
				modifier = allowed_to_serve_empire
				years = 100
				who = ROOT
			}
		}
		top_liege = {
			hidden_tooltip = {
				letter_event = { id = Plus.3302 } # inform
			}
			FROM = { move_character = PREV }
		}
	}
}	
	
# Relative remains where they are
character_event = {
	id = Plus.3302
	
	hide_window = yes
	
	min_age = 16
	capable_only = yes
	prisoner = no
	has_character_flag = serving_empire
	
	trigger = {
		is_ruler = no
		liege = { real_tier = EMPEROR }
		OR = {
			is_voter = yes
			has_minor_title = title_appointed_regent
			has_minor_title = title_commander
		}
		had_character_flag = { flag = serving_empire days = 1460 }
	}
	
	mean_time_to_happen = {
		months = 48
	}
	
	immediate = {
		clr_character_flag = serving_empire
		set_character_flag = served_empire
		random_opinion_modifier_target = {
			limit = { reverse_has_opinion_modifier = { who = ROOT modifier = allowed_to_serve_empire } }
			letter_event = { id = Plus.3303 }
		}
	}
}

# Inform liege
letter_event = {
	id = Plus.3303
	desc = EVTDESC_Plus_3303
	
	is_triggered_only = yes
	
	option = {
		name = SO_BE_IT
	}
}

# Relative has become a ruler
character_event = {
	id = Plus.3304
	
	hide_window = yes
	
	min_age = 16
	prisoner = no
	only_rulers = yes
	has_character_flag = serving_empire
	
	trigger = {
		is_ruler = yes
		had_character_flag = { flag = serving_empire days = 1460 }
	}
	
	mean_time_to_happen = {
		months = 48
	}
	
	immediate = {
		clr_character_flag = serving_empire
		set_character_flag = served_empire
	}
}

# Relative has become incapable
character_event = {
	id = Plus.3305
	
	hide_window = yes
	
	min_age = 16
	prisoner = no
	has_character_flag = serving_empire
	
	trigger = {
		trait = incapable
		is_ruler = no
		had_character_flag = { flag = serving_empire days = 1460 }
	}
	
	mean_time_to_happen = {
		months = 48
	}
	
	immediate = {
		clr_character_flag = serving_empire
		set_character_flag = served_empire
		random_opinion_modifier_target = {
			limit = { reverse_has_opinion_modifier = { who = ROOT modifier = allowed_to_serve_empire } }
			character_event = { id = Plus.3306 }
		}
	}
}

# Inform liege
character_event = {
	id = Plus.3306
	desc = EVTDESC_Plus_3306
	picture = GFX_evt_emissary
	
	is_triggered_only = yes
	
	option = {
		name = I_SEE
		return_home_effect = yes
	}
}

# Relative returns - increased education
character_event = {
	id = Plus.3307
	
	hide_window = yes
	
	min_age = 16
	capable_only = yes
	prisoner = no
	has_character_flag = serving_empire
	
	trigger = {
		NOR = {
			trait = elusive_shadow
			trait = grey_eminence
			trait = midas_touched
			trait = brilliant_strategist
			trait = mastermind_theologian
		}
		NAND = {
			liege = { real_tier = EMPEROR }
			OR = {
				is_voter = yes
				has_minor_title = title_appointed_regent
				has_minor_title = title_commander
			}
		}
		is_ruler = no
		had_character_flag = { flag = serving_empire days = 1460 }
	}
	
	mean_time_to_happen = {
		months = 48
		modifier = {
			factor = 0.5
			is_smart_trigger = yes
		}
		modifier = {
			factor = 2.0
			is_dumb_trigger = yes
		}
		modifier = {
			factor = 0.75
			trait = diligent
		}
		modifier = {
			factor = 1.25
			trait = slothful
		}
	}
	
	immediate = {
		clr_character_flag = serving_empire
		set_character_flag = served_empire
		random_opinion_modifier_target = {
			limit = { reverse_has_opinion_modifier = { who = ROOT modifier = allowed_to_serve_empire } }
			letter_event = { id = Plus.3308 }
		}
	}
}

# Inform liege
character_event = {
	id = Plus.3308
	desc = EVTDESC_Plus_3308
	picture = GFX_evt_emissary
	
	is_triggered_only = yes
	
	option = {
		name = EXCELLENT
		FROM = {
			if = {
				limit = { trait = intricate_webweaver }
				remove_trait = intricate_webweaver
				add_trait = elusive_shadow
			}
			if = {
				limit = { trait = flamboyant_schemer }
				remove_trait = flamboyant_schemer
				add_trait = intricate_webweaver
			}
			if = {
				limit = { trait = amateurish_plotter }
				remove_trait = amateurish_plotter
				add_trait = flamboyant_schemer
			}
			if = {
				limit = { trait = charismatic_negotiator }
				remove_trait = charismatic_negotiator
				add_trait = grey_eminence
			}
			if = {
				limit = { trait = underhanded_rogue }
				remove_trait = underhanded_rogue
				add_trait = charismatic_negotiator
			}
			if = {
				limit = { trait = naive_appeaser }
				remove_trait = naive_appeaser
				add_trait = underhanded_rogue
			}
			if = {
				limit = { trait = fortune_builder }
				remove_trait = fortune_builder
				add_trait = midas_touched
			}
			if = {
				limit = { trait = thrifty_clerk }
				remove_trait = thrifty_clerk
				add_trait = fortune_builder
			}
			if = {
				limit = { trait = indulgent_wastrel }
				remove_trait = indulgent_wastrel
				add_trait = thrifty_clerk
			}
			if = {
				limit = { trait = skilled_tactician }
				remove_trait = skilled_tactician
				add_trait = brilliant_strategist
			}
			if = {
				limit = { trait = tough_soldier }
				remove_trait = tough_soldier
				add_trait = skilled_tactician
			}
			if = {
				limit = { trait = misguided_warrior }
				remove_trait = misguided_warrior
				add_trait = tough_soldier
			}
			if = {
				limit = { trait = scholarly_theologian }
				remove_trait = scholarly_theologian
				add_trait = mastermind_theologian
			}
			if = {
				limit = { trait = martial_cleric }
				remove_trait = martial_cleric
				add_trait = scholarly_theologian
			}
			if = {
				limit = { trait = detached_priest }
				remove_trait = detached_priest
				add_trait = martial_cleric
			}
		}
		return_home_effect = yes
	}
}

# Relative returns = increased stat
character_event = {
	id = Plus.3309
	
	hide_window = yes
	
	min_age = 16
	capable_only = yes
	prisoner = no
	has_character_flag = serving_empire
	
	trigger = {
		NAND = {
			liege = { real_tier = EMPEROR }
			OR = {
				is_voter = yes
				has_minor_title = title_appointed_regent
				has_minor_title = title_commander
			}
		}
		is_ruler = no
		had_character_flag = { flag = serving_empire days = 1460 }
	}
	
	mean_time_to_happen = {
		months = 48
		modifier = {
			factor = 0.5
			is_smart_trigger = yes
		}
		modifier = {
			factor = 2.0
			is_dumb_trigger = yes
		}
		modifier = {
			factor = 0.75
			trait = diligent
		}
		modifier = {
			factor = 1.25
			trait = slothful
		}
	}
	
	immediate = {
		clr_character_flag = serving_empire
		set_character_flag = served_empire
		random_opinion_modifier_target = {
			limit = { reverse_has_opinion_modifier = { who = ROOT modifier = allowed_to_serve_empire } }
			letter_event = { id = Plus.3310 }
		}
	}
}

# Inform liege
character_event = {
	id = Plus.3310
	desc = EVTDESC_Plus_3308
	picture = GFX_evt_emissary
	
	is_triggered_only = yes
	
	option = {
		name = EXCELLENT
		FROM = {
			if = {
				limit = {
					OR = {
						trait = amateurish_plotter
						trait = flamboyant_schemer
						trait = intricate_webweaver
						trait = elusive_shadow
					}
				}
				change_intrigue = 2
			}
			if = {
				limit = {
					OR = {
						trait = naive_appeaser
						trait = underhanded_rogue
						trait = charismatic_negotiator
						trait = grey_eminence
					}
				}
				change_diplomacy = 2
			}
			if = {
				limit = {
					OR = {
						trait = indulgent_wastrel
						trait = thrifty_clerk
						trait = fortune_builder
						trait = midas_touched
					}
				}
				change_stewardship = 2
			}
			if = {
				limit = {
					OR = {
						trait = misguided_warrior
						trait = tough_soldier
						trait = skilled_tactician
						trait = brilliant_strategist
					}
				}
				change_martial = 2
			}
			if = {
				limit = {
					OR = {
						trait = detached_priest
						trait = martial_cleric
						trait = scholarly_theologian
						trait = mastermind_theologian
					}
				}
				change_learning = 2
			}
		}
		return_home_effect = yes
	}
}

# Relative returns with a lifestyle trait
character_event = {
	id = Plus.3311
	
	hide_window = yes
	
	min_age = 16
	capable_only = yes
	prisoner = no
	has_character_flag = serving_empire
	
	trigger = {
		NOT = { lifestyle_traits = 1 }
		NAND = {
			liege = { real_tier = EMPEROR }
			OR = {
				is_voter = yes
				has_minor_title = title_appointed_regent
				has_minor_title = title_commander
			}
		}
		is_ruler = no
		had_character_flag = { flag = serving_empire days = 1460 }
	}
	
	mean_time_to_happen = {
		months = 48
		modifier = {
			factor = 0.75
			trait = diligent
		}
		modifier = {
			factor = 1.25
			trait = slothful
		}
	}
	
	immediate = {
		clr_character_flag = serving_empire
		set_character_flag = served_empire
		random_opinion_modifier_target = {
			limit = { reverse_has_opinion_modifier = { who = ROOT modifier = allowed_to_serve_empire } }
			letter_event = { id = Plus.3312 }
		}
	}
}

# Inform liege
character_event = {
	id = Plus.3312
	desc = EVTDESC_Plus_3308
	picture = GFX_evt_emissary
	
	is_triggered_only = yes
	
	option = {
		name = EXCELLENT
		FROM = {
			if = {
				limit = {
					OR = {
						trait = amateurish_plotter
						trait = flamboyant_schemer
						trait = intricate_webweaver
						trait = elusive_shadow
					}
				}
				add_trait = schemer
			}
			if = {
				limit = {
					OR = {
						trait = naive_appeaser
						trait = underhanded_rogue
						trait = charismatic_negotiator
						trait = grey_eminence
					}
				}
				add_trait = socializer
			}
			if = {
				limit = {
					OR = {
						trait = indulgent_wastrel
						trait = thrifty_clerk
						trait = fortune_builder
						trait = midas_touched
					}
				}
				add_trait = administrator
			}
			if = {
				limit = {
					OR = {
						trait = misguided_warrior
						trait = tough_soldier
						trait = skilled_tactician
						trait = brilliant_strategist
					}
				}
				add_trait = duelist
			}
			if = {
				limit = {
					OR = {
						trait = detached_priest
						trait = martial_cleric
						trait = scholarly_theologian
						trait = mastermind_theologian
					}
				}
				add_trait = theologian
			}
		}
		return_home_effect = yes
	}
}

# Relative returns with a wife
character_event = {
	id = Plus.3313
	
	hide_window = yes
	
	min_age = 16
	capable_only = yes
	only_men = yes
	prisoner = no
	has_character_flag = serving_empire
	
	trigger = {
		is_married = no
		can_marry = yes
		NOT = { trait = homosexual }
		NAND = {
			liege = { real_tier = EMPEROR }
			OR = {
				is_voter = yes
				has_minor_title = title_appointed_regent
				has_minor_title = title_commander
			}
		}
		is_ruler = no
		had_character_flag = { flag = serving_empire days = 1460 }
	}
	
	mean_time_to_happen = {
		months = 48
	}
	
	immediate = {
		clr_character_flag = serving_empire
		set_character_flag = served_empire
		random_opinion_modifier_target = {
			limit = { reverse_has_opinion_modifier = { who = ROOT modifier = allowed_to_serve_empire } }
			letter_event = { id = Plus.3314 }
		}
	}
}

# Inform liege
character_event = {
	id = Plus.3314
	desc = EVTDESC_Plus_3314
	picture = GFX_evt_emissary
	
	is_triggered_only = yes
	
	option = {
		name = I_SEE
		hidden_tooltip = {
			top_liege = {
				create_character = {
					random_traits = yes
					culture = THIS
					religion = THIS
					female = yes
					age = 17
				}
				new_character = {
					save_event_target_as = new_wife
				}
			}
		}
		FROM = { add_spouse = event_target:new_wife }
		return_home_effect = yes
	}
}

# Relative returns with a bastard child
character_event = {
	id = Plus.3315
	
	hide_window = yes
	
	min_age = 16
	capable_only = yes
	only_men = yes
	prisoner = no
	has_character_flag = serving_empire
	
	trigger = {
		is_married = no
		fertility = 0.25
		NOT = { trait = homosexual }
		NAND = {
			liege = { real_tier = EMPEROR }
			OR = {
				is_voter = yes
				has_minor_title = title_appointed_regent
				has_minor_title = title_commander
			}
		}
		is_ruler = no
		had_character_flag = { flag = serving_empire days = 1460 }
	}
	
	mean_time_to_happen = {
		months = 48
	}
	
	immediate = {
		clr_character_flag = serving_empire
		set_character_flag = served_empire
		random_opinion_modifier_target = {
			limit = { reverse_has_opinion_modifier = { who = ROOT modifier = allowed_to_serve_empire } }
			letter_event = { id = Plus.3316 }
		}
	}
}

# Inform liege
character_event = {
	id = Plus.3316
	picture = GFX_evt_emissary
	
	desc = {
		text = EVTDESC_Plus_3316_male
		trigger = { FROM = { is_female = no } }
	}
	desc = {
		text = EVTDESC_Plus_3316_female
		trigger = { FROM = { is_female = yes } }
	}
	
	is_triggered_only = yes
	
	option = {
		name = I_SEE
		hidden_tooltip = {
			create_character = {
				age = 0
				female = no
				trait = bastard
				culture = FROM
				religion = FROM
			}
			new_character = {
				if = {
					limit = { FROM = { is_female = no } }
					set_father = FROM
				}
				if = {
					limit = { FROM = { is_female = yes } }
					set_mother = FROM
				}
			}
			recalc_succession = yes
		}
		return_home_effect = yes
	}
}

# Relative returns depressed
character_event = {
	id = Plus.3317
	
	hide_window = yes
	
	min_age = 16
	capable_only = yes
	prisoner = no
	has_character_flag = serving_empire
	
	trigger = {
		NOT = { trait = depressed }
		NAND = {
			liege = { real_tier = EMPEROR }
			OR = {
				is_voter = yes
				has_minor_title = title_appointed_regent
				has_minor_title = title_commander
			}
		}
		is_ruler = no
		had_character_flag = { flag = serving_empire days = 1460 }
	}
	
	mean_time_to_happen = {
		months = 48
		modifier = {
			factor = 1.25
			trait = diligent
		}
		modifier = {
			factor = 0.75
			trait = slothful
		}
	}
	
	immediate = {
		clr_character_flag = serving_empire
		set_character_flag = served_empire
		random_opinion_modifier_target = {
			limit = { reverse_has_opinion_modifier = { who = ROOT modifier = allowed_to_serve_empire } }
			letter_event = { id = Plus.3318 }
		}
	}
}

# Inform liege
character_event = {
	id = Plus.3318
	desc = EVTDESC_Plus_3318
	picture = GFX_evt_emissary
	
	is_triggered_only = yes
	
	option = {
		name = I_SEE
		FROM = { add_trait = depressed }
		return_home_effect = yes
	}
}

# Relative returns a drunkard
character_event = {
	id = Plus.3319
	
	hide_window = yes
	
	min_age = 16
	capable_only = yes
	prisoner = no
	has_character_flag = serving_empire
	
	trigger = {
		NOT = { trait = drunkard }
		NOT = { trait = temperate }
		NAND = {
			liege = { real_tier = EMPEROR }
			OR = {
				is_voter = yes
				has_minor_title = title_appointed_regent
				has_minor_title = title_commander
			}
		}
		is_ruler = no
		had_character_flag = { flag = serving_empire days = 1460 }
	}
	
	mean_time_to_happen = {
		months = 48
		modifier = {
			factor = 0.75
			trait = gluttonous
		}
		modifier = {
			factor = 0.75
			trait = gregarious
		}
		modifier = {
			factor = 1.5
			trait = shy
		}
	}
	
	immediate = {
		clr_character_flag = serving_empire
		set_character_flag = served_empire
		random_opinion_modifier_target = {
			limit = { reverse_has_opinion_modifier = { who = ROOT modifier = allowed_to_serve_empire } }
			letter_event = { id = Plus.3320 }
		}
	}
}

# Inform liege
character_event = {
	id = Plus.3320
	desc = EVTDESC_Plus_3320
	picture = GFX_evt_emissary
	
	is_triggered_only = yes
	
	option = {
		name = I_SEE
		FROM = { add_trait = drunkard }
		return_home_effect = yes
	}
}

# Relative returns more diligent
character_event = {
	id = Plus.3321
	
	hide_window = yes
	
	min_age = 16
	capable_only = yes
	prisoner = no
	has_character_flag = serving_empire
	
	trigger = {
		NOT = { trait = diligent }
		NOT = { trait = slothful }
		NAND = {
			liege = { real_tier = EMPEROR }
			OR = {
				is_voter = yes
				has_minor_title = title_appointed_regent
				has_minor_title = title_commander
			}
		}
		is_ruler = no
		had_character_flag = { flag = serving_empire days = 1460 }
	}
	
	mean_time_to_happen = {
		months = 48
	}
	
	immediate = {
		clr_character_flag = serving_empire
		set_character_flag = served_empire
		random_opinion_modifier_target = {
			limit = { reverse_has_opinion_modifier = { who = ROOT modifier = allowed_to_serve_empire } }
			letter_event = { id = Plus.3322 }
		}
	}
}

# Inform liege
character_event = {
	id = Plus.3322
	desc = EVTDESC_Plus_3322
	picture = GFX_evt_emissary
	
	is_triggered_only = yes
	
	option = {
		name = EXCELLENT
		FROM = { add_trait = diligent }
		return_home_effect = yes
	}
}

# Relative returns slothful
character_event = {
	id = Plus.3323
	
	hide_window = yes
	
	min_age = 16
	capable_only = yes
	prisoner = no
	has_character_flag = serving_empire
	
	trigger = {
		NOT = { trait = diligent }
		NOT = { trait = slothful }
		NAND = {
			liege = { real_tier = EMPEROR }
			OR = {
				is_voter = yes
				has_minor_title = title_appointed_regent
				has_minor_title = title_commander
			}
		}
		is_ruler = no
		had_character_flag = { flag = serving_empire days = 1460 }
	}
	
	mean_time_to_happen = {
		months = 48
	}
	
	immediate = {
		clr_character_flag = serving_empire
		set_character_flag = served_empire
		random_opinion_modifier_target = {
			limit = { reverse_has_opinion_modifier = { who = ROOT modifier = allowed_to_serve_empire } }
			letter_event = { id = Plus.3324 }
		}
	}
}

# Inform liege
character_event = {
	id = Plus.3324
	desc = EVTDESC_Plus_3324
	picture = GFX_evt_emissary
	
	is_triggered_only = yes
	
	option = {
		name = I_SEE
		FROM = { add_trait = slothful }
		return_home_effect = yes
	}
}

# Relative returns a zealot
character_event = {
	id = Plus.3325
	
	hide_window = yes
	
	min_age = 16
	capable_only = yes
	prisoner = no
	has_character_flag = serving_empire
	
	trigger = {
		NOT = { trait = zealous }
		NOT = { trait = cynical }
		NAND = {
			liege = { real_tier = EMPEROR }
			OR = {
				is_voter = yes
				has_minor_title = title_appointed_regent
				has_minor_title = title_commander
			}
		}
		is_ruler = no
		had_character_flag = { flag = serving_empire days = 1460 }
	}
	
	mean_time_to_happen = {
		months = 48
	}
	
	immediate = {
		clr_character_flag = serving_empire
		set_character_flag = served_empire
		random_opinion_modifier_target = {
			limit = { reverse_has_opinion_modifier = { who = ROOT modifier = allowed_to_serve_empire } }
			letter_event = { id = Plus.3326 }
		}
	}
}

# Inform liege
character_event = {
	id = Plus.3326
	desc = EVTDESC_Plus_3326
	picture = GFX_evt_emissary
	
	is_triggered_only = yes
	
	option = {
		name = I_SEE
		FROM = { add_trait = zealous }
		return_home_effect = yes
	}
}

# Relative returns a cynic
character_event = {
	id = Plus.3327
	
	hide_window = yes
	
	min_age = 16
	capable_only = yes
	prisoner = no
	has_character_flag = serving_empire
	
	trigger = {
		NOT = { trait = zealous }
		NOT = { trait = cynical }
		NAND = {
			liege = { real_tier = EMPEROR }
			OR = {
				is_voter = yes
				has_minor_title = title_appointed_regent
				has_minor_title = title_commander
			}
		}
		is_ruler = no
		had_character_flag = { flag = serving_empire days = 1460 }
	}
	
	mean_time_to_happen = {
		months = 48
	}
	
	immediate = {
		clr_character_flag = serving_empire
		set_character_flag = served_empire
		random_opinion_modifier_target = {
			limit = { reverse_has_opinion_modifier = { who = ROOT modifier = allowed_to_serve_empire } }
			letter_event = { id = Plus.3328 }
		}
	}
}

# Inform liege
character_event = {
	id = Plus.3328
	desc = EVTDESC_Plus_3328
	picture = GFX_evt_emissary
	
	is_triggered_only = yes
	
	option = {
		name = I_SEE
		FROM = { add_trait = cynical }
		return_home_effect = yes
	}
}

# Ruler dies while a relative is away at the capital
character_event = {
	id = Plus.3329
	
	hide_window = yes
	is_triggered_only = yes
	
	trigger = {
		any_close_relative = {
			has_character_flag = serving_empire
			has_opinion_modifier = { who = ROOT modifier = allowed_to_serve_empire }
		}
	}
	
	immediate = {
		any_character = {
			limit = {
				has_character_flag = serving_empire
				has_opinion_modifier = { who = ROOT modifier = allowed_to_serve_empire }
			}
			clr_character_flag = serving_empire
			if = {
				limit = {
					NOR = {
						prisoner = yes
						is_ruler = yes
						AND = {
							liege = { real_tier = EMPEROR }
							OR = {
								is_voter = yes
								has_minor_title = title_appointed_regent
								has_minor_title = title_commander
							}
						}
					}
				}
				move_character = ROOT
			}
		}
	}
}

# Ruler is unlanded while a relative is away at the capital
character_event = {
	id = Plus.3330
	
	hide_window = yes
	is_triggered_only = yes
	
	trigger = {
		any_close_relative = {
			has_character_flag = serving_empire
			has_opinion_modifier = { who = ROOT modifier = allowed_to_serve_empire }
		}
	}
	
	immediate = {
		any_character = {
			limit = {
				has_character_flag = serving_empire
				has_opinion_modifier = { who = ROOT modifier = allowed_to_serve_empire }
			}
			clr_character_flag = serving_empire
			remove_opinion = { who = ROOT modifier = allowed_to_serve_empire }
			if = {
				limit = {
					NOR = {
						prisoner = yes
						is_ruler = yes
						AND = {
							liege = { real_tier = EMPEROR }
							OR = {
								is_voter = yes
								has_minor_title = title_appointed_regent
								has_minor_title = title_commander
							}
						}
					}
				}
				random_dynasty_member = {
					limit = { higher_tier_than = COUNT }
					reverse_banish = PREV
					break = yes
				}
				random_dynasty_member = {
					limit = { higher_tier_than = BARON }
					reverse_banish = PREV
					break = yes
				}
				random_dynasty_member = {
					limit = { is_ruler = yes }
					reverse_banish = PREV
					break = yes
				}
			}
		}
	}
}

# Relative's liege is no longer the emperor
character_event = {
	id = Plus.3331
	
	hide_window = yes
	
	min_age = 16
	capable_only = yes
	only_men = yes
	prisoner = no
	has_character_flag = serving_empire

	trigger = {
		is_ruler = no
		is_voter = no
		liege = { NOT = { real_tier = EMPEROR } }
	}
	
	mean_time_to_happen = {
		months = 6
	}
	
	immediate = {
		#find original liege
		random_opinion_modifier_target = {
			limit = { reverse_has_opinion_modifier = { who = ROOT modifier = allowed_to_serve_empire } }
			save_event_target_as = original_liege
		}
		#move the relative to the new emperor, if they're not their original liege
		if = {
			limit = {
				top_liege = {
					real_tier = EMPEROR
					same_realm = event_target:original_liege
					NOT = { character = event_target:original_liege }
				}
			}
			top_liege = {
				ROOT = { move_character = PREV }
			}
			break = yes
		}
		#otherwise, return home immediately
		clr_character_flag = serving_empire
		event_target:original_liege = {
			ROOT = { move_character = PREV }
		}
	}
}

