namespace = Plus

#reserved: Plus.1400 to Plus.1449

#######################################
# TEMPLE BUILDER EVENTS
#######################################

### TEMPLE BUILDING BEGINS

# Unlanded character with religious education decides to found a temple
character_event = {
	id = Plus.1400

	hide_window = yes
	
	min_age = 20
	max_age = 50
	capable_only = yes
	prisoner = no
	
	trigger = {
		is_ruler = no
		health = 4
		OR = {
			trait = martial_cleric
			trait = scholarly_theologian
			trait = mastermind_theologian
		}
		OR = {
			is_female = no
			religion = cathar
			religion = bogomilist
			AND = {
				religion_group = pagan_group
				NOT = { religion = tengri_pagan }
				NOT = { religion = tengri_pagan_reformed}
			}
		}
		OR = {
			NOT = { dynasty = 0 }
			trait = ambitious
		}
		liege = {
			war = no
			is_tribal = yes
			religion = ROOT
			culture = ROOT
			any_demesne_province = {
				religion = PREV
				culture = PREV
				num_of_empty_holdings = 1
				NOT = { has_province_modifier = building_new_temple }
				PREV = {
					NOT = {
						any_realm_title = {
							is_theocracy = yes
							location = { province = PREVPREVPREV }
						}
					}
				}
			}
			NOT = {
				has_character_modifier = temple_build_timer
				trait = cynical
				any_courtier = {
					is_ruler = no
					has_character_modifier = planning_new_temple
				}
			}
		}
		NOT = {
			trait = cynical
			trait = content
			trait = stressed
			trait = depressed
			trait = imbecile
			any_heir_title = { always = yes }
			has_character_modifier = planning_new_temple
			has_character_modifier = planning_claimant_adventure
			has_character_modifier = planning_duchy_adventure
			has_character_flag = claimant_adventurer
		}
	}
	
	mean_time_to_happen = {
		years = 100
		modifier = {
			factor = 1.5
			NOT = { year = 800 }
		}
		modifier = {
			factor = 0.5
			liege = { has_character_flag = build_temple_tried_once }
		}
		modifier = {
			factor = 0.9
			has_character_modifier = estates_1
		}
		modifier = {
			factor = 0.9
			has_character_modifier = estates_2
		}
		modifier = {
			factor = 0.9
			has_character_modifier = estates_3
		}
		modifier = {
			factor = 0.9
			has_character_modifier = estates_4
		}
		modifier = {
			factor = 0.9
			has_character_modifier = estates_5
		}
		modifier = {
			factor = 0.5
			trait = zealous
		}
		modifier = {
			factor = 0.5
			trait = ambitious
		}
		modifier = {
			factor = 0.8
			trait = mastermind_theologian
		}
		modifier = {
			factor = 0.8
			trait = diligent
		}
		modifier = {
			factor = 0.8
			trait = proud
		}
		modifier = {
			factor = 1.2
			trait = martial_cleric
		}
		modifier = {
			factor = 1.2
			trait = slothful
		}
		modifier = {
			factor = 1.2
			trait = humble
		}
		modifier = {
			factor = 1.5
			NOT = { diplomacy = 7 }
		}
		modifier = {
			factor = 0.8
			diplomacy = 12
		}
	}
	
	immediate = {
		add_character_modifier = {
			name = planning_new_temple
			hidden = yes
			duration = -1
		}
		if = {
			limit = { has_character_modifier = estates_1 }
			remove_character_modifier = estates_1
			wealth = 40
		}
		if = {
			limit = { has_character_modifier = estates_2 }
			remove_character_modifier = estates_2
			wealth = 80
		}
		if = {
			limit = { has_character_modifier = estates_3 }
			remove_character_modifier = estates_3
			wealth = 120
		}
		if = {
			limit = { has_character_modifier = estates_4 }
			remove_character_modifier = estates_4
			wealth = 160
		}
		if = {
			limit = { has_character_modifier = estates_5 }
			remove_character_modifier = estates_5
			wealth = 200
		}
		liege = {
			random_demesne_province = {
				limit = {
					is_capital = PREV
					religion = PREV
					culture = PREV
					num_of_empty_holdings = 1
					NOT = { has_province_modifier = building_new_temple }
					PREV = {
						NOT = {
							any_realm_title = {
								is_theocracy = yes
								location = { province = PREVPREVPREV }
							}
						}
					}
				}
				PREV = { set_character_flag = found_province_temple }
				province_event = { id = Plus.1401 }
			}
			random_demesne_province = {
				limit = {
					PREV = { NOT = { has_character_flag = found_province_temple } }
					religion = PREV
					culture = PREV
					num_of_empty_holdings = 1
					NOT = { has_province_modifier = building_new_temple }
					PREV = {
						NOT = {
							any_realm_title = {
								is_theocracy = yes
								location = { province = PREVPREVPREV }
							}
						}
					}
				}
				province_event = { id = Plus.1401 }
			}
			clr_character_flag = found_province_temple
		}
	}
}

# Ping event for province where the temple is being built
province_event = {
	id = Plus.1401
	
	hide_window = yes
	is_triggered_only = yes
	
	immediate = {
		set_province_flag = building_new_temple_check
		add_province_modifier = {
			name = building_new_temple
			duration = -1
		}
		FROM = {
			liege = {
				character_event = { id = Plus.1402 }
				add_character_modifier = {
					name = temple_build_timer
					hidden = yes
					inherit = yes
					duration = 7300
				}
			}
		}
	}
}

# Liege approached and asked for money to build the temple
character_event = {
	id = Plus.1402
	desc = EVTDESC_Plus_1402
	picture = GFX_evt_temple
	
	is_triggered_only = yes
	show_from_from = yes
	
	option = {
		name = EVTOPTA_Plus_1402 # Help him out
		trigger = {
			wealth = 50
		}
		ai_chance = {
			factor = 50
			modifier = {
				factor = 0.1
				has_character_modifier = ai_austerity
			}
			modifier = {
				factor = 2
				trait = ambitious
			}
			modifier = {
				factor = 2
				trait = charitable
			}
			modifier = {
				factor = 3
				trait = zealous
			}
		}
		if = {
			limit = {
				wealth = 50
				NOT = { wealth = 100 }
			}
			wealth = -50
			FROMFROM = { wealth = 50 }
		}
		if = {
			limit  = {
				wealth = 100
			}
			wealth = -100
			FROMFROM = { wealth = 100 }
		}
		piety = 20
		reverse_opinion = { who = FROMFROM modifier = opinion_helped_temple years = 50 }
	}
	
	option = {
		name = EVTOPTA_Plus_1402 # Don't help him
		trigger = {
			wealth = 50
		}
		ai_chance = {
			factor = 50
			modifier = {
				factor = 3
				trait = greedy
			}
			modifier = {
				factor = 3
				trait = slothful
			}
			modifier = {
				factor = 2
				trait = content
			}
		}
		piety = -20
		reverse_opinion = { who = FROMFROM modifier = opinion_refused_temple years = 50 }
	}
	
	option = {
		name = EVTOPTC_Plus_1402 # I can't afford it
		trigger = {
			NOT = { wealth = 50 }
		}
		prestige = -20
	}
}

### TEMPLE BUILDING STOPS

# Character building the temple dies during construction
character_event = {
	id = Plus.1405
	
	hide_window = yes
	is_triggered_only = yes
	
	trigger = {
		is_ruler = no
		has_character_modifier = planning_new_temple
	}
	
	immediate = {
		remove_character_modifier = planning_new_temple
		if = {
			limit = {
				liege = {
					any_demesne_province = { has_province_modifier = building_new_temple }
					NOT = {
						any_courtier = {
							is_ruler = no
							has_character_modifier = planning_new_temple
						}
					}
				}
			}
			liege = { character_event = { id = Plus.1406 } }
		}
	}
}

# Liege notified that temple construction has stopped due to builder's death
character_event = {
	id = Plus.1406
	desc = EVTDESC_Plus_1406
	picture = GFX_evt_death
	
	is_triggered_only = yes

	option = {
		name = EVTOPTA_Plus_1414 # Find someone else to continue construction
		trigger = {
			wealth = 50
			is_tribal = yes
			any_demesne_province = {
				religion = ROOT
				culture = ROOT
				num_of_empty_holdings = 1
				has_province_modifier = building_new_temple
				ROOT = {
					NOT = {
						any_realm_title = {
							is_theocracy = yes
							location = { province = PREVPREVPREV }
						}
					}
				}
			}
			NOT = {
				any_courtier = {
					is_ruler = no
					has_character_modifier = planning_new_temple
				}
			}
			any_courtier = {
				is_adult = yes
				prisoner = no
				religion = ROOT
				culture = ROOT
				is_ruler = no
				health = 4
				OR = {
					trait = martial_cleric
					trait = scholarly_theologian
					trait = mastermind_theologian
				}
				OR = {
					is_female = no
					religion = cathar
					religion = bogomilist
					AND = {
						religion_group = pagan_group
						NOT = { religion = tengri_pagan }
						NOT = { religion = tengri_pagan_reformed}
					}
				}
				OR = {
					NOT = { dynasty = 0 }
					trait = ambitious
				}
				NOT = {
					character = FROM
					trait = incapable
					trait = cynical
					trait = content
					trait = stressed
					trait = depressed
					trait = imbecile
					any_heir_title = { always = yes }
					has_character_modifier = planning_new_temple
					has_character_modifier = planning_claimant_adventure
					has_character_modifier = planning_duchy_adventure
					has_character_flag = claimant_adventurer
				}
			}			
		}
		ai_chance = {
			factor = 70
			modifier = {
				factor = 0.1
				trait = cynical
			}
			modifier = {
				factor = 0.5
				trait = greedy
			}
			modifier = {
				factor = 0.75
				trait = slothful
			}
		}
		wealth = -50
		random_courtier = {
			limit = {
				is_adult = yes
				prisoner = no
				religion = ROOT
				culture = ROOT
				is_ruler = no
				health = 4
				OR = {
					trait = martial_cleric
					trait = scholarly_theologian
					trait = mastermind_theologian
				}
				OR = {
					is_female = no
					religion = cathar
					religion = bogomilist
					AND = {
						religion_group = pagan_group
						NOT = { religion = tengri_pagan }
						NOT = { religion = tengri_pagan_reformed}
					}
				}
				OR = {
					NOT = { dynasty = 0 }
					trait = ambitious
				}
				NOT = {
					character = FROM
					trait = incapable
					trait = cynical
					trait = content
					trait = stressed
					trait = depressed
					trait = imbecile
					any_heir_title = { always = yes }
					has_character_modifier = planning_new_temple
					has_character_modifier = planning_claimant_adventure
					has_character_modifier = planning_duchy_adventure
					has_character_flag = claimant_adventurer
				}
			}
			wealth = 50
			add_character_modifier = {
				name = planning_new_temple
				hidden = yes
				duration = -1
			}
			hidden_tooltip = {
				opinion = { who = ROOT modifier = opinion_helped_temple years = 50 }
				if = {
					limit = { has_character_modifier = estates_1 }
					remove_character_modifier = estates_1
					wealth = 40
				}
				if = {
					limit = { has_character_modifier = estates_2 }
					remove_character_modifier = estates_2
					wealth = 80
				}
				if = {
					limit = { has_character_modifier = estates_3 }
					remove_character_modifier = estates_3
					wealth = 120
				}
				if = {
					limit = { has_character_modifier = estates_4 }
					remove_character_modifier = estates_4
					wealth = 160
				}
				if = {
					limit = { has_character_modifier = estates_5 }
					remove_character_modifier = estates_5
					wealth = 200
				}
			}
		}
	}	
	option = {
		name = EVTOPTB_Plus_1414 # There is nothing to be done
		ai_chance = {
			factor = 30
			modifier = {
				factor = 0.1
				wealth = 200
			}
			modifier = {
				factor = 0.5
				trait = ambitious
			}
			modifier = {
				factor = 5
				has_character_modifier = ai_austerity
			}
		}
		set_character_flag = build_temple_tried_once
		hidden_tooltip = { remove_character_modifier = temple_build_timer }
		random_demesne_province = {
			limit = { has_province_modifier = building_new_temple }
			clr_province_flag = building_new_temple_check
			remove_province_modifier = building_new_temple
		}
	}
}

# Character building the temple is no longer valid to do so
character_event = {
	id = Plus.1407
	
	hide_window = yes
	
	min_age = 16
	
	trigger = {
		has_character_modifier = planning_new_temple
		OR = {
			is_ruler = yes
			AND = {
				prisoner = yes
				imprisoned_days = 30
			}
			trait = incapable
		}
	}
	
	mean_time_to_happen = {
		days = 3
	}
	
	immediate = {
		remove_character_modifier = planning_new_temple
		if = {
			limit = {
				liege = {
					any_demesne_province = { has_province_modifier = building_new_temple }
					NOT = {
						any_courtier = {
							is_ruler = no
							has_character_modifier = planning_new_temple
						}
					}
				}
			}
			if = {
				limit = { is_ruler = yes }
				piety = -50
				prestige = -50
				liege = { letter_event = { id = Plus.1408 } }
			}
			if = {
				limit = {
					is_ruler = no
					trait = incapable
				}
				piety = -50
				prestige = -50
				clear_wealth = yes
				liege = { character_event = { id = Plus.1409 } }
			}
			if = {
				limit = {
					is_ruler = no
					NOT = { trait = incapable }
					prisoner = yes
				}
				piety = -50
				prestige = -50
				clear_wealth = yes
				liege = { character_event = { id = Plus.1410 } }
			}
		}
	}
}

# Liege notified that temple building stopped because builder became a ruler
letter_event = {
	id = Plus.1408
	desc = EVTDESC_Plus_1408
	
	is_triggered_only = yes

	option = {
		name = EVTOPTA_Plus_1414 # Find someone else to continue construction
		trigger = {
			wealth = 50
			is_tribal = yes
			any_demesne_province = {
				religion = ROOT
				culture = ROOT
				num_of_empty_holdings = 1
				has_province_modifier = building_new_temple
				ROOT = {
					NOT = {
						any_realm_title = {
							is_theocracy = yes
							location = { province = PREVPREVPREV }
						}
					}
				}
			}
			NOT = {
				any_courtier = {
					is_ruler = no
					has_character_modifier = planning_new_temple
				}
			}
			any_courtier = {
				is_adult = yes
				prisoner = no
				religion = ROOT
				culture = ROOT
				is_ruler = no
				health = 4
				OR = {
					trait = martial_cleric
					trait = scholarly_theologian
					trait = mastermind_theologian
				}
				OR = {
					is_female = no
					religion = cathar
					religion = bogomilist
					AND = {
						religion_group = pagan_group
						NOT = { religion = tengri_pagan }
						NOT = { religion = tengri_pagan_reformed}
					}
				}
				OR = {
					NOT = { dynasty = 0 }
					trait = ambitious
				}
				NOT = {
					character = FROM
					trait = incapable
					trait = cynical
					trait = content
					trait = stressed
					trait = depressed
					trait = imbecile
					any_heir_title = { always = yes }
					has_character_modifier = planning_new_temple
					has_character_modifier = planning_claimant_adventure
					has_character_modifier = planning_duchy_adventure
					has_character_flag = claimant_adventurer
				}
			}			
		}
		ai_chance = {
			factor = 70
			modifier = {
				factor = 0.1
				trait = cynical
			}
			modifier = {
				factor = 0.5
				trait = greedy
			}
			modifier = {
				factor = 0.75
				trait = slothful
			}
		}
		wealth = -50
		random_courtier = {
			limit = {
				is_adult = yes
				prisoner = no
				religion = ROOT
				culture = ROOT
				is_ruler = no
				health = 4
				OR = {
					trait = martial_cleric
					trait = scholarly_theologian
					trait = mastermind_theologian
				}
				OR = {
					is_female = no
					religion = cathar
					religion = bogomilist
					AND = {
						religion_group = pagan_group
						NOT = { religion = tengri_pagan }
						NOT = { religion = tengri_pagan_reformed}
					}
				}
				OR = {
					NOT = { dynasty = 0 }
					trait = ambitious
				}
				NOT = {
					character = FROM
					trait = incapable
					trait = cynical
					trait = content
					trait = stressed
					trait = depressed
					trait = imbecile
					any_heir_title = { always = yes }
					has_character_modifier = planning_new_temple
					has_character_modifier = planning_claimant_adventure
					has_character_modifier = planning_duchy_adventure
					has_character_flag = claimant_adventurer
				}
			}
			wealth = 50
			add_character_modifier = {
				name = planning_new_temple
				hidden = yes
				duration = -1
			}
			hidden_tooltip = {
				opinion = { who = ROOT modifier = opinion_helped_temple years = 50 }
				if = {
					limit = { has_character_modifier = estates_1 }
					remove_character_modifier = estates_1
					wealth = 40
				}
				if = {
					limit = { has_character_modifier = estates_2 }
					remove_character_modifier = estates_2
					wealth = 80
				}
				if = {
					limit = { has_character_modifier = estates_3 }
					remove_character_modifier = estates_3
					wealth = 120
				}
				if = {
					limit = { has_character_modifier = estates_4 }
					remove_character_modifier = estates_4
					wealth = 160
				}
				if = {
					limit = { has_character_modifier = estates_5 }
					remove_character_modifier = estates_5
					wealth = 200
				}
			}
		}
	}	
	option = {
		name = EVTOPTB_Plus_1414 # There is nothing to be done
		ai_chance = {
			factor = 30
			modifier = {
				factor = 0.1
				wealth = 200
			}
			modifier = {
				factor = 0.5
				trait = ambitious
			}
			modifier = {
				factor = 5
				has_character_modifier = ai_austerity
			}
		}
		set_character_flag = build_temple_tried_once
		hidden_tooltip = { remove_character_modifier = temple_build_timer }
		random_demesne_province = {
			limit = { has_province_modifier = building_new_temple }
			clr_province_flag = building_new_temple_check
			remove_province_modifier = building_new_temple
		}
	}
}

# Liege notified that temple building stopped because builder became incapable
character_event = {
	id = Plus.1409
	desc = EVTDESC_Plus_1409
	picture = GFX_evt_temple
	
	is_triggered_only = yes

	option = {
		name = EVTOPTA_Plus_1414 # Find someone else to continue construction
		trigger = {
			wealth = 50
			is_tribal = yes
			any_demesne_province = {
				religion = ROOT
				culture = ROOT
				num_of_empty_holdings = 1
				has_province_modifier = building_new_temple
				ROOT = {
					NOT = {
						any_realm_title = {
							is_theocracy = yes
							location = { province = PREVPREVPREV }
						}
					}
				}
			}
			NOT = {
				any_courtier = {
					is_ruler = no
					has_character_modifier = planning_new_temple
				}
			}
			any_courtier = {
				is_adult = yes
				prisoner = no
				religion = ROOT
				culture = ROOT
				is_ruler = no
				health = 4
				OR = {
					trait = martial_cleric
					trait = scholarly_theologian
					trait = mastermind_theologian
				}
				OR = {
					is_female = no
					religion = cathar
					religion = bogomilist
					AND = {
						religion_group = pagan_group
						NOT = { religion = tengri_pagan }
						NOT = { religion = tengri_pagan_reformed}
					}
				}
				OR = {
					NOT = { dynasty = 0 }
					trait = ambitious
				}
				NOT = {
					character = FROM
					trait = incapable
					trait = cynical
					trait = content
					trait = stressed
					trait = depressed
					trait = imbecile
					any_heir_title = { always = yes }
					has_character_modifier = planning_new_temple
					has_character_modifier = planning_claimant_adventure
					has_character_modifier = planning_duchy_adventure
					has_character_flag = claimant_adventurer
				}
			}			
		}
		ai_chance = {
			factor = 70
			modifier = {
				factor = 0.1
				trait = cynical
			}
			modifier = {
				factor = 0.5
				trait = greedy
			}
			modifier = {
				factor = 0.75
				trait = slothful
			}
		}
		wealth = 50
		random_courtier = {
			limit = {
				is_adult = yes
				prisoner = no
				religion = ROOT
				culture = ROOT
				is_ruler = no
				health = 4
				OR = {
					trait = martial_cleric
					trait = scholarly_theologian
					trait = mastermind_theologian
				}
				OR = {
					is_female = no
					religion = cathar
					religion = bogomilist
					AND = {
						religion_group = pagan_group
						NOT = { religion = tengri_pagan }
						NOT = { religion = tengri_pagan_reformed}
					}
				}
				OR = {
					NOT = { dynasty = 0 }
					trait = ambitious
				}
				NOT = {
					character = FROM
					trait = incapable
					trait = cynical
					trait = content
					trait = stressed
					trait = depressed
					trait = imbecile
					any_heir_title = { always = yes }
					has_character_modifier = planning_new_temple
					has_character_modifier = planning_claimant_adventure
					has_character_modifier = planning_duchy_adventure
					has_character_flag = claimant_adventurer
				}
			}
			wealth = 50
			add_character_modifier = {
				name = planning_new_temple
				hidden = yes
				duration = -1
			}
			hidden_tooltip = {
				opinion = { who = ROOT modifier = opinion_helped_temple years = 50 }
				if = {
					limit = { has_character_modifier = estates_1 }
					remove_character_modifier = estates_1
					wealth = 40
				}
				if = {
					limit = { has_character_modifier = estates_2 }
					remove_character_modifier = estates_2
					wealth = 80
				}
				if = {
					limit = { has_character_modifier = estates_3 }
					remove_character_modifier = estates_3
					wealth = 120
				}
				if = {
					limit = { has_character_modifier = estates_4 }
					remove_character_modifier = estates_4
					wealth = 160
				}
				if = {
					limit = { has_character_modifier = estates_5 }
					remove_character_modifier = estates_5
					wealth = 200
				}
			}
		}
	}	
	option = {
		name = EVTOPTB_Plus_1414 # There is nothing to be done
		ai_chance = {
			factor = 30
			modifier = {
				factor = 0.1
				wealth = 200
			}
			modifier = {
				factor = 0.5
				trait = ambitious
			}
			modifier = {
				factor = 5
				has_character_modifier = ai_austerity
			}
		}
		set_character_flag = build_temple_tried_once
		hidden_tooltip = { remove_character_modifier = temple_build_timer }
		random_demesne_province = {
			limit = { has_province_modifier = building_new_temple }
			clr_province_flag = building_new_temple_check
			remove_province_modifier = building_new_temple
		}
	}
}

# Liege notified that temple building stopped because builder is imprisoned
character_event = {
	id = Plus.1410
	desc = EVTDESC_Plus_1410
	picture = GFX_evt_temple
	
	is_triggered_only = yes

	option = {
		name = EVTOPTA_Plus_1414 # Find someone else to continue construction
		trigger = {
			wealth = 50
			is_tribal = yes
			any_demesne_province = {
				religion = ROOT
				culture = ROOT
				num_of_empty_holdings = 1
				has_province_modifier = building_new_temple
				ROOT = {
					NOT = {
						any_realm_title = {
							is_theocracy = yes
							location = { province = PREVPREVPREV }
						}
					}
				}
			}
			NOT = {
				any_courtier = {
					is_ruler = no
					has_character_modifier = planning_new_temple
				}
			}
			any_courtier = {
				is_adult = yes
				prisoner = no
				religion = ROOT
				culture = ROOT
				is_ruler = no
				health = 4
				OR = {
					trait = martial_cleric
					trait = scholarly_theologian
					trait = mastermind_theologian
				}
				OR = {
					is_female = no
					religion = cathar
					religion = bogomilist
					AND = {
						religion_group = pagan_group
						NOT = { religion = tengri_pagan }
						NOT = { religion = tengri_pagan_reformed}
					}
				}
				OR = {
					NOT = { dynasty = 0 }
					trait = ambitious
				}
				NOT = {
					character = FROM
					trait = incapable
					trait = cynical
					trait = content
					trait = stressed
					trait = depressed
					trait = imbecile
					any_heir_title = { always = yes }
					has_character_modifier = planning_new_temple
					has_character_modifier = planning_claimant_adventure
					has_character_modifier = planning_duchy_adventure
					has_character_flag = claimant_adventurer
				}
			}			
		}
		ai_chance = {
			factor = 70
			modifier = {
				factor = 0.1
				trait = cynical
			}
			modifier = {
				factor = 0.5
				trait = greedy
			}
			modifier = {
				factor = 0.75
				trait = slothful
			}
		}
		wealth = -50
		random_courtier = {
			limit = {
				is_adult = yes
				prisoner = no
				religion = ROOT
				culture = ROOT
				is_ruler = no
				health = 4
				OR = {
					trait = martial_cleric
					trait = scholarly_theologian
					trait = mastermind_theologian
				}
				OR = {
					is_female = no
					religion = cathar
					religion = bogomilist
					AND = {
						religion_group = pagan_group
						NOT = { religion = tengri_pagan }
						NOT = { religion = tengri_pagan_reformed}
					}
				}
				OR = {
					NOT = { dynasty = 0 }
					trait = ambitious
				}
				NOT = {
					character = FROM
					trait = incapable
					trait = cynical
					trait = content
					trait = stressed
					trait = depressed
					trait = imbecile
					any_heir_title = { always = yes }
					has_character_modifier = planning_new_temple
					has_character_modifier = planning_claimant_adventure
					has_character_modifier = planning_duchy_adventure
					has_character_flag = claimant_adventurer
				}
			}
			wealth = 50
			add_character_modifier = {
				name = planning_new_temple
				hidden = yes
				duration = -1
			}
			hidden_tooltip = {
				opinion = { who = ROOT modifier = opinion_helped_temple years = 50 }
				if = {
					limit = { has_character_modifier = estates_1 }
					remove_character_modifier = estates_1
					wealth = 40
				}
				if = {
					limit = { has_character_modifier = estates_2 }
					remove_character_modifier = estates_2
					wealth = 80
				}
				if = {
					limit = { has_character_modifier = estates_3 }
					remove_character_modifier = estates_3
					wealth = 120
				}
				if = {
					limit = { has_character_modifier = estates_4 }
					remove_character_modifier = estates_4
					wealth = 160
				}
				if = {
					limit = { has_character_modifier = estates_5 }
					remove_character_modifier = estates_5
					wealth = 200
				}
			}
		}
	}	
	option = {
		name = EVTOPTB_Plus_1414 # There is nothing to be done
		ai_chance = {
			factor = 30
			modifier = {
				factor = 0.1
				wealth = 200
			}
			modifier = {
				factor = 0.5
				trait = ambitious
			}
			modifier = {
				factor = 5
				has_character_modifier = ai_austerity
			}
		}
		set_character_flag = build_temple_tried_once
		hidden_tooltip = { remove_character_modifier = temple_build_timer }
		random_demesne_province = {
			limit = { has_province_modifier = building_new_temple }
			clr_province_flag = building_new_temple_check
			remove_province_modifier = building_new_temple
		}
	}
}

# Temple building stops because liege/site is no longer valid
character_event = {
	id = Plus.1411
	
	hide_window = yes
	
	min_age = 16
	capable_only = yes
	prisoner = no
	
	trigger = {
		has_character_modifier = planning_new_temple
		liege = {
			OR = {
				is_tribal = no
				NOT = { religion = ROOT }
				NOT = { culture = ROOT }
				NOT = {
					any_demesne_province = {
						religion = PREV
						culture = PREV
						num_of_empty_holdings = 1
						has_province_modifier = building_new_temple
						PREV = {
							NOT = {
								any_realm_title = {
									is_theocracy = yes
									location = { province = PREVPREVPREV }
								}
							}
						}
					}
				}
			}
		}
	}
	
	mean_time_to_happen = {
		days = 3
	}
	
	immediate = {
		remove_character_modifier = planning_new_temple
		if = {
			limit = {
				liege = {
					any_demesne_province = { has_province_modifier = building_new_temple }
					NOT = {
						any_courtier = {
							is_ruler = no
							has_character_modifier = planning_new_temple
						}
					}
				}
			}
			if = {
				limit = {
					liege = {
						OR = {
							is_tribal = no
							NOT = { religion = ROOT }
							NOT = { culture = ROOT }
						}
					}
				}
				piety = -50
				prestige = -50
				clear_wealth = yes
				liege = { character_event = { id = Plus.1412 } }
			}
			if = {
				limit = {
					liege = {
						is_tribal = yes
						religion = ROOT
						culture = ROOT
						any_demesne_province = {
							has_province_modifier = building_new_temple
							OR = {
								NOT = { religion = PREV }
								NOT = { culture = PREV }
								NOT = { num_of_empty_holdings = 1 }
								PREV = {
									any_realm_title = {
										is_theocracy = yes
										location = { province = PREVPREVPREV }
									}
								}
							}
						}
					}
				}
				liege = { letter_event = { id = Plus.1413 } }
			}
		}
	}
}

# Liege notified that temple building stopped because builder is no longer compatible
character_event = {
	id = Plus.1412
	desc = EVTDESC_Plus_1412
	picture = GFX_evt_temple
	
	is_triggered_only = yes

	option = {
		name = EVTOPTA_Plus_1414 # Find someone else to continue construction
		trigger = {
			wealth = 50
			is_tribal = yes
			any_demesne_province = {
				religion = ROOT
				culture = ROOT
				num_of_empty_holdings = 1
				has_province_modifier = building_new_temple
				ROOT = {
					NOT = {
						any_realm_title = {
							is_theocracy = yes
							location = { province = PREVPREVPREV }
						}
					}
				}
			}
			NOT = {
				any_courtier = {
					is_ruler = no
					has_character_modifier = planning_new_temple
				}
			}
			any_courtier = {
				is_adult = yes
				prisoner = no
				religion = ROOT
				culture = ROOT
				is_ruler = no
				health = 4
				OR = {
					trait = martial_cleric
					trait = scholarly_theologian
					trait = mastermind_theologian
				}
				OR = {
					is_female = no
					religion = cathar
					religion = bogomilist
					AND = {
						religion_group = pagan_group
						NOT = { religion = tengri_pagan }
						NOT = { religion = tengri_pagan_reformed}
					}
				}
				OR = {
					NOT = { dynasty = 0 }
					trait = ambitious
				}
				NOT = {
					character = FROM
					trait = incapable
					trait = cynical
					trait = content
					trait = stressed
					trait = depressed
					trait = imbecile
					any_heir_title = { always = yes }
					has_character_modifier = planning_new_temple
					has_character_modifier = planning_claimant_adventure
					has_character_modifier = planning_duchy_adventure
					has_character_flag = claimant_adventurer
				}
			}			
		}
		ai_chance = {
			factor = 70
			modifier = {
				factor = 0.1
				trait = cynical
			}
			modifier = {
				factor = 0.5
				trait = greedy
			}
			modifier = {
				factor = 0.75
				trait = slothful
			}
		}
		wealth = -50
		random_courtier = {
			limit = {
				is_adult = yes
				prisoner = no
				religion = ROOT
				culture = ROOT
				is_ruler = no
				health = 4
				OR = {
					trait = martial_cleric
					trait = scholarly_theologian
					trait = mastermind_theologian
				}
				OR = {
					is_female = no
					religion = cathar
					religion = bogomilist
					AND = {
						religion_group = pagan_group
						NOT = { religion = tengri_pagan }
						NOT = { religion = tengri_pagan_reformed}
					}
				}
				OR = {
					NOT = { dynasty = 0 }
					trait = ambitious
				}
				NOT = {
					character = FROM
					trait = incapable
					trait = cynical
					trait = content
					trait = stressed
					trait = depressed
					trait = imbecile
					any_heir_title = { always = yes }
					has_character_modifier = planning_new_temple
					has_character_modifier = planning_claimant_adventure
					has_character_modifier = planning_duchy_adventure
					has_character_flag = claimant_adventurer
				}
			}
			wealth = 50
			add_character_modifier = {
				name = planning_new_temple
				hidden = yes
				duration = -1
			}
			hidden_tooltip = {
				opinion = { who = ROOT modifier = opinion_helped_temple years = 50 }
				if = {
					limit = { has_character_modifier = estates_1 }
					remove_character_modifier = estates_1
					wealth = 40
				}
				if = {
					limit = { has_character_modifier = estates_2 }
					remove_character_modifier = estates_2
					wealth = 80
				}
				if = {
					limit = { has_character_modifier = estates_3 }
					remove_character_modifier = estates_3
					wealth = 120
				}
				if = {
					limit = { has_character_modifier = estates_4 }
					remove_character_modifier = estates_4
					wealth = 160
				}
				if = {
					limit = { has_character_modifier = estates_5 }
					remove_character_modifier = estates_5
					wealth = 200
				}
			}
		}
	}
	option = {
		name = EVTOPTB_Plus_1414 # There is nothing to be done
		ai_chance = {
			factor = 30
			modifier = {
				factor = 0.1
				wealth = 200
			}
			modifier = {
				factor = 0.5
				trait = ambitious
			}
			modifier = {
				factor = 5
				has_character_modifier = ai_austerity
			}
		}
		set_character_flag = build_temple_tried_once
		hidden_tooltip = { remove_character_modifier = temple_build_timer }
		random_demesne_province = {
			limit = { has_province_modifier = building_new_temple }
			clr_province_flag = building_new_temple_check
			remove_province_modifier = building_new_temple
		}
	}
}

# Liege notified that temple building stopped because site is unsuitable
letter_event = {
	id = Plus.1413
	desc = EVTDESC_Plus_1413
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_Plus_1413 # What about another site?
		trigger = {
			wealth = 50
			is_tribal = yes
			religion = FROM
			culture = FROM
			any_demesne_province = {
				religion = ROOT
				culture = ROOT
				num_of_empty_holdings = 1
				NOT = { has_province_modifier = building_new_temple }
				ROOT = {
					NOT = {
						any_realm_title = {
							is_theocracy = yes
							location = { province = PREVPREVPREV }
						}
					}
				}
			}
		}
		ai_chance = {
			factor = 70
			modifier = {
				factor = 0.1
				trait = cynical
			}
			modifier = {
				factor = 0.5
				trait = greedy
			}
			modifier = {
				factor = 0.75
				trait = slothful
			}
		}
		wealth = -50
		random_demesne_province = {
			limit = { has_province_modifier = building_new_temple }
			clr_province_flag = building_new_temple_check
			remove_province_modifier = building_new_temple
		}
		random_demesne_province = {
			limit = {
				religion = ROOT
				culture = ROOT
				num_of_empty_holdings = 1
				NOT = { has_province_modifier = building_new_temple }
				ROOT = {
					NOT = {
						any_realm_title = {
							is_theocracy = yes
							location = { province = PREVPREVPREV }
						}
					}
				}
			}
			set_province_flag = building_new_temple_check
			add_province_modifier = {
				name = building_new_temple
				duration = -1
			}
		}
		hidden_tooltip = {
			FROM = {
				wealth = 50
				opinion = { who = ROOT modifier = opinion_helped_temple years = 50 }
				add_character_modifier = {
					name = planning_new_temple
					hidden = yes
					duration = -1
				}
			}
		}
	}
	option = {
		name = EVTOPTB_Plus_1414 # There is nothing to be done
		ai_chance = {
			factor = 30
			modifier = {
				factor = 0.1
				wealth = 200
			}
			modifier = {
				factor = 0.5
				trait = ambitious
			}
			modifier = {
				factor = 5
				has_character_modifier = ai_austerity
			}
		}
		set_character_flag = build_temple_tried_once
		hidden_tooltip = { remove_character_modifier = temple_build_timer }
		random_demesne_province = {
			limit = { has_province_modifier = building_new_temple }
			clr_province_flag = building_new_temple_check
			remove_province_modifier = building_new_temple
			FROM = {
				piety = -50
				prestige = -50
				clear_wealth = yes
			}
		}
	}
}

# Temple building stops because there is no one to build it
province_event = {
	id = Plus.1414
	desc = EVTDESC_Plus_1414
	picture = GFX_evt_temple
	
	trigger = {
		has_province_modifier = building_new_temple
		owner = {
			NOT = {
				any_courtier = {
					is_ruler = no
					has_character_modifier = planning_new_temple
				}
			}
		}
	}
	
	mean_time_to_happen = {
		days = 10
	}
	
	option = {
		name = EVTOPTA_Plus_1414 # Find someone else to continue construction
		trigger = {
			num_of_empty_holdings = 1
			owner = {
				wealth = 50
				is_tribal = yes
				religion = ROOT
				culture = ROOT
				NOT = {
					any_realm_title = {
						is_theocracy = yes
						location = { province = ROOT }
					}
				}
				any_courtier = {
					is_adult = yes
					prisoner = no
					religion = ROOT
					culture = ROOT
					is_ruler = no
					health = 4
					OR = {
						trait = martial_cleric
						trait = scholarly_theologian
						trait = mastermind_theologian
					}
					OR = {
						is_female = no
						religion = cathar
						religion = bogomilist
						AND = {
							religion_group = pagan_group
							NOT = { religion = tengri_pagan }
							NOT = { religion = tengri_pagan_reformed}
						}
					}
					OR = {
						NOT = { dynasty = 0 }
						trait = ambitious
					}
					NOT = {
						trait = incapable
						trait = cynical
						trait = content
						trait = stressed
						trait = depressed
						trait = imbecile
						any_heir_title = { always = yes }
						has_character_modifier = planning_new_temple
						has_character_modifier = planning_claimant_adventure
						has_character_modifier = planning_duchy_adventure
						has_character_flag = claimant_adventurer
					}
				}
			}
		}
		ai_chance = {
			factor = 70
			modifier = {
				factor = 0.1
				owner = { trait = cynical }
			}
			modifier = {
				factor = 0.5
				owner = { trait = greedy }
			}
			modifier = {
				factor = 0.75
				owner = { trait = slothful }
			}
		}
		owner = {
			piety = 20
			wealth = -50
			random_courtier = {
				limit = {
					is_adult = yes
					prisoner = no
					religion = ROOT
					culture = ROOT
					is_ruler = no
					health = 4
					OR = {
						trait = martial_cleric
						trait = scholarly_theologian
						trait = mastermind_theologian
					}
					OR = {
						is_female = no
						religion = cathar
						religion = bogomilist
						AND = {
							religion_group = pagan_group
							NOT = { religion = tengri_pagan }
							NOT = { religion = tengri_pagan_reformed}
						}
					}
					OR = {
						NOT = { dynasty = 0 }
						trait = ambitious
					}
					NOT = {
						trait = incapable
						trait = cynical
						trait = content
						trait = stressed
						trait = depressed
						trait = imbecile
						any_heir_title = { always = yes }
						has_character_modifier = planning_new_temple
						has_character_modifier = planning_claimant_adventure
						has_character_modifier = planning_duchy_adventure
						has_character_flag = claimant_adventurer
					}
				}
				custom_tooltip = {
					text = WILL_CONTINUE_BUILDING_TEMPLE
					hidden_tooltip = {
						wealth = 50
						add_character_modifier = {
							name = planning_new_temple
							hidden = yes
							duration = -1
						}
						opinion = { who = ROOT modifier = opinion_helped_temple years = 50 }
						if = {
							limit = { has_character_modifier = estates_1 }
							remove_character_modifier = estates_1
							wealth = 40
						}
						if = {
							limit = { has_character_modifier = estates_2 }
							remove_character_modifier = estates_2
							wealth = 80
						}
						if = {
							limit = { has_character_modifier = estates_3 }
							remove_character_modifier = estates_3
							wealth = 120
						}
						if = {
							limit = { has_character_modifier = estates_4 }
							remove_character_modifier = estates_4
							wealth = 160
						}
						if = {
							limit = { has_character_modifier = estates_5 }
							remove_character_modifier = estates_5
							wealth = 200
						}
					}
				}
			}
		}
	}
	option = {
		name = EVTOPTB_Plus_1414 # There is nothing to be done
		ai_chance = {
			factor = 30
			modifier = {
				factor = 0.1
				owner = { wealth = 200 }
			}
			modifier = {
				factor = 0.5
				owner = { trait = ambitious }
			}
			modifier = {
				factor = 5
				owner = { has_character_modifier = ai_austerity }
			}
		}
		clr_province_flag = building_new_temple_check
		remove_province_modifier = building_new_temple
		hidden_tooltip = {
			owner = { set_character_flag = build_temple_tried_once }
		}
	}
}

# Temple encounters a problem during construction
character_event = {
	id = Plus.1420
	
	hide_window = yes
	
	min_age = 16
	capable_only = yes
	prisoner = no
	
	trigger = {
		has_character_modifier = planning_new_temple
		is_ruler = no
		liege = {
			is_tribal = yes
			religion = ROOT
			culture = ROOT
			any_demesne_province = {
				religion = PREV
				culture = PREV
				num_of_empty_holdings = 1
				has_province_modifier = building_new_temple
				had_province_flag = { flag = building_new_temple_check days = 365 }
				PREV = {
					NOT = {
						any_realm_title = {
							is_theocracy = yes
							location = { province = PREVPREVPREV }
						}
					}
				}
			}
		}
		NOT = {
			trait = genius
			learning = 16
		}
		OR = {
			NOT = { has_character_flag = building_temple_delayed }
			had_character_flag = { flag = building_temple_delayed days = 365 }
		}
	}
	
	mean_time_to_happen = {
		years = 20
		modifier = {
			factor = 0.5
			liege = {
				any_realm_title = {
					location = { has_province_modifier = building_new_temple }
					is_occupied = yes
				}
			}
		}
		modifier = {
			factor = 0.5
			OR = {
				trait = lunatic
				trait = possessed
			}
		}
		modifier = {
			factor = 1.5
			trait = quick
		}
		modifier = {
			factor = 1.5
			trait = scholar
		}
		modifier = {
			factor = 0.8
			trait = gluttonous
		}
		modifier = {
			factor = 0.8
			trait = slothful
		}
		modifier = {
			factor = 0.8
			trait = wroth
		}
		modifier = {
			factor = 0.8
			trait = stressed
		}
		modifier = {
			factor = 0.8
			trait = depressed
		}
		modifier = {
			factor = 0.8
			trait = drunkard
		}
		modifier = {
			factor = 1.2
			trait = temperate
		}
		modifier = {
			factor = 1.2
			trait = diligent
		}
		modifier = {
			factor = 1.2
			trait = patient
		}
		modifier = {
			factor = 0.9
			NOT = { diplomacy = 7 }
		}
		modifier = {
			factor = 0.9
			NOT = { diplomacy = 5 }
		}
		modifier = {
			factor = 0.8
			NOT = { diplomacy = 3 }
		}
		modifier = {
			factor = 1.1
			diplomacy = 12
		}
		modifier = {
			factor = 1.1
			diplomacy = 14
		}
		modifier = {
			factor = 1.2
			diplomacy = 16
		}
		modifier = {
			factor = 0.9
			NOT = { learning = 8 }
		}
		modifier = {
			factor = 0.9
			NOT = { learning = 6 }
		}
		modifier = {
			factor = 0.8
			NOT = { learning = 4 }
		}
		modifier = {
			factor = 1.1
			learning = 10
		}
		modifier = {
			factor = 1.1
			learning = 12
		}
		modifier = {
			factor = 1.2
			learning = 14
		}
	}
	
	option = {
		name = EVTOPTA_Plus_1420 #Pay for it myself
		trigger = {
			wealth = 50
		}
		set_character_flag = building_temple_delayed
		wealth = -50
	}
	
	option = {
		name = EVTOPTB_Plus_1420 #Ask my liege for help
		trigger = {
			NOT = { wealth = 50 }
		}
		set_character_flag = building_temple_delayed
		liege = { letter_event = { id = Plus.1421 } }
	}
}

# Liege asked for money to continue construction
letter_event = {
	id = Plus.1421
	desc = EVTDESC_Plus_1421
	
	is_triggered_only = yes
	
	option = {
		name = EVTOPTA_Plus_1421 #Help him out
		trigger = { wealth = 50 }
		ai_chance = {
			factor = 70
			modifier = {
				factor = 0.1
				trait = cynical
			}
			modifier = {
				factor = 0.5
				trait = greedy
			}
			modifier = {
				factor = 0.75
				trait = slothful
			}
		}
		piety = 10
		wealth = -50
		reverse_opinion = { who = FROM modifier = opinion_helped_temple years = 50 }
	}
	option = {
		name = EVTOPTB_Plus_1421 #Refuse
		ai_chance = {
			factor = 30
			modifier = {
				factor = 0.1
				wealth = 200
			}
			modifier = {
				factor = 0.5
				trait = ambitious
			}
			modifier = {
				factor = 5
				has_character_modifier = ai_austerity
			}
		}
		set_character_flag = build_temple_tried_once
		if = {
			limit = { wealth = 50 }
			piety = -10
		}
		prestige = -20
		reverse_opinion = { who = FROM modifier = opinion_refused_temple years = 50 }
		random_demesne_province = {
			limit = { has_province_modifier = building_new_temple }
			clr_province_flag = building_new_temple_check
			remove_province_modifier = building_new_temple
		}
		hidden_tooltip = {
			remove_character_modifier = temple_build_timer
			FROM = { remove_character_modifier = planning_new_temple }
		}
	}
}

### TEMPLE CONSTRUCTION COMPLETE

character_event = {
	id = Plus.1425
	
	hide_window = yes
	
	min_age = 16
	capable_only = yes
	prisoner = no
	
	trigger = {
		has_character_modifier = planning_new_temple
		is_ruler = no
		liege = {
			war = no
			is_tribal = yes
			religion = ROOT
			culture = ROOT
			any_demesne_province = {
				religion = PREV
				culture = PREV
				num_of_empty_holdings = 1
				has_province_modifier = building_new_temple
				OR = {
					AND = {
						ROOT = {
							NOT = { wealth = 50 }
						}
						had_province_flag = { flag = building_new_temple_check days = 3650 random = 1825 }
					}
					AND = {
						ROOT = {
							wealth = 50
							NOT = { wealth = 100 }
						}
						had_province_flag = { flag = building_new_temple_check days = 2750 random = 1825 }
					}
					AND = {
						ROOT = {
							wealth = 100
						}
						had_province_flag = { flag = building_new_temple_check days = 1825 random = 1825 }
					}
				}
				PREV = {
					NOT = {
						any_realm_title = {
							is_theocracy = yes
							location = { province = PREVPREVPREV }
						}
					}
				}
			}
		}
	}
	
	mean_time_to_happen = {
		days = 30
	}
	
	immediate = {
		liege = {
			random_demesne_province = {
				limit = {
					religion = PREV
					culture = PREV
					num_of_empty_holdings = 1
					has_province_modifier = building_new_temple
				}
				remove_province_modifier = building_new_temple
				clr_province_flag = building_new_temple_check
				build_holding = {
					type = temple
					holder = ROOT
				}
				ROOT = {
					clr_character_flag = building_temple_delayed
					remove_character_modifier = planning_new_temple
					clear_wealth = yes
					set_defacto_liege = PREVPREV
					piety = 50
				}
			}
			clr_character_flag = build_temple_tried_once
			character_event = { id = Plus.1426 days = 1 }
		}
	}
}

# Liege notified that the temple has been built
character_event = {
	id = Plus.1426
	desc = EVTDESC_Plus_1426
	picture = GFX_evt_temple
	
	is_triggered_only = yes
	
	option = {
		name = EXCELLENT
		prestige = 50
	}
}

