targetted_decisions = {
	abdicate_rule = {
		filter = self
		ai_target_filter = self
		
		potential = {
			is_ruler = yes
			has_regent = no
			controls_religion = no
			OR = {
				NOT = { religion_group = pagan_group }
				is_reformed_religion = yes
			}
			NOT = {
				has_character_flag = considering_abdication
				has_character_modifier = do_not_disturb
			}
		}
		
		allow = {
			war = no
			NOT = {
				trait = ambitious
				trait = proud
				trait = lunatic
				trait = possessed
			}
		}
		
		effect = {
			set_character_flag = considering_abdication
			character_event = { id = Plus.120 tooltip = consider_abdication }
		}
		
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0
				NOT = { age = 50 }
			}
			modifier = {
				factor = 0
				NOT = { ruled_years = 10 }
			}
			modifier = {
				factor = 0
				NOT = {
					NOT = { health = 3.1 }
					trait = depressed
					trait = stressed
					trait = infirm
				}
			}
			modifier = {
				factor = 0
				NOT = {
					current_heir = {
						war = no
						is_adult = yes
						dynasty = ROOT
						NOT = {
							trait = incapable
							trait = lunatic
							trait = possessed
						}
					}
				}
			}
			modifier = {
				factor = 0.1
				always = yes
			}
			modifier = {
				factor = 0
				NOT = {
					current_heir = {
						reverse_opinion = { who = ROOT value = 25 }
					}
				}
			}
			modifier = {
				factor = 0
				NOT = {
					trait = content
					trait = humble
				}
			}
			modifier = {
				factor = 0
				OR = {
					trait = paranoid
					trait = envious
					trait = greedy
				}
			}
		}
	}

	disinherit_child = {
		filter = dynasty
		ai_target_filter = dynasty
		
		from_potential = {
			is_ruler = yes
			is_playable = yes
			has_regent = no
			NOT = { has_character_flag = disinherited_child }
		}
		potential = {
			is_child_of = FROM
			any_heir_title = {
				is_primary_holder_title = yes
				holder = FROM
			}
		}
		allow = {
			FROM = {
				war = no
				custom_tooltip = {
					text = HAS_ANOTHER_ELIGIBLE_HEIR
					hidden_tooltip = {
						any_dynasty_member = {
							any_pretender_title = {
								is_primary_holder_title = yes
								holder = FROM
							}
							is_adult = yes
							religion = FROM
							culture = FROM
							dynasty = FROM
							OR = {
								is_child_of = FROM
								mother_even_if_dead = { is_child_of = FROM }
								father_even_if_dead = { is_child_of = FROM }
							}
							NOT = {
								character = ROOT
								trait = incapable
								trait = lunatic
								trait = possessed
							}
						}
					}
				}
				OR = {
					AND = {
						tier = COUNT
						prestige = 500
					}
					AND = {
						tier = DUKE
						prestige = 1000
					}
					AND = {
						tier = KING
						prestige = 1500
					}
					AND = {
						tier = EMPEROR
						prestige = 2000
					}
				}
			}
		}
		effect = {
			FROM = {
				set_character_flag = disinherited_child
				if = {
					limit = { tier = COUNT }
					prestige = -250
				}
				if = {
					limit = { tier = DUKE }
					prestige = -500
				}
				if = {
					limit = { tier = KING }
					prestige = -750
				}
				if = {
					limit = { tier = EMPEROR }
					prestige = -1000
				}
				character_event = { id = Plus.1100 tooltip = consider_disinheritance }
			}
		}
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.1
				always = yes
			}
			modifier = {
				factor = 0
				reverse_opinion = { who = FROM value = 25 }
				FROM = {
					NOT = {
						trait = cruel
						trait = ambitious
						trait = diligent
					}
				}
			}
			modifier = {
				factor = 0
				NOT = {
					NOT = { dynasty = FROM }
					NOT = { religion = FROM }
					trait = incapable
					trait = lunatic
					trait = possessed
					NOT = { reverse_opinion = { who = FROM value = -75 } }
					AND = {
						NOT = { num_of_children = 1 }
						NOT = { fertility = 0.05 }
					}
				}
			}
			modifier = {
				factor = 0
				FROM = {
					NOT = {
						any_dynasty_member = {
							any_pretender_title = {
								is_primary_holder_title = yes
								holder = FROM
							}
							is_adult = yes
							religion = FROM
							culture = FROM
							dynasty = FROM
							OR = {
								is_child_of = FROM
								mother_even_if_dead = { is_child_of = FROM }
								father_even_if_dead = { is_child_of = FROM }
							}
							OR = {
								is_ruler = no
								same_realm = FROM
								lower_tier_than = FROM
							}
							OR = {
								num_of_children = 1
								fertility = 0.05
							}
							reverse_opinion = { who = FROM value = 0 }
							NOT = {
								character = ROOT
								trait = bastard
								trait = incapable
								trait = lunatic
								trait = possessed
							}
						}
					}
				}
			}
			modifier = {
				factor = 0
				FROM = {
					OR = {
						trait = slothful
						trait = content
						trait = just
					}
				}
			}
		}
	}

	reconcile_child = {
		filter = dynasty
		ai_target_filter = dynasty
		
		from_potential = {
			is_ruler = yes
			is_playable = yes
			has_regent = no
			had_character_flag = { flag = disinherited_child days = 365 }
		}
		potential = {
			is_child_of = FROM
			trait = disinherited
			same_realm = FROM
			dynasty = FROM
			religion = FROM
			prisoner = no
			reverse_opinion = { who = FROM value = 0 }
			OR = {
				num_of_children = 1
				fertility = 0.05
			}
			NOT = {
				trait = incapable
				trait = lunatic
				trait = possessed
			}
		}
		allow = {
			ROOT = {
				trait = disinherited
			}
			FROM = {
				war = no
				OR = {
					AND = {
						tier = COUNT
						prestige = 250
					}
					AND = {
						tier = DUKE
						prestige = 500
					}
					AND = {
						tier = KING
						prestige = 750
					}
					AND = {
						tier = EMPEROR
						prestige = 1000
					}
				}
			}
		}
		effect = {
			FROM = {
				if = {
					limit = { tier = COUNT }
					prestige = -125
				}
				if = {
					limit = { tier = DUKE }
					prestige = -250
				}
				if = {
					limit = { tier = KING }
					prestige = -375
				}
				if = {
					limit = { tier = EMPEROR }
					prestige = -500
				}
				character_event = { id = Plus.1120 tooltip = consider_reconciliation }
			}
		}
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.1
				always = yes
			}
			modifier = {
				factor = 0
				FROM = {
					current_heir = {
						dynasty = FROM
						reverse_opinion = { who = FROM value = 50 }
					}
				}
			}
		}
	}

	grant_estate = {
		filter = sub_realm
		ai_target_filter = sub_realm
		
		from_potential = {
			ai = no
			wealth = 50
		}
		potential = {
			is_adult = yes
			is_ruler = no
			is_liege_or_above = FROM
			NOT = { has_character_modifier = estates_5 }
		}
		allow = {
			ROOT = {
				prisoner = no
				NOT = { trait = incapable }
			}
			FROM = {
				war = no
			}
		}
		effect = {
			FROM = { character_event = { id = Plus.105 tooltip = CONSIDER_MINOR_ESTATE } }
		}
		ai_will_do = {
			factor = 0
		}
	}
	
	pardon = {
		filter = sub_realm
		ai_target_filter = sub_realm
		
		from_potential = {
			ai = no
		}
		potential = {
			is_liege_or_above = FROM
			OR = {
				reverse_has_opinion_modifier = {
					who = FROM
					modifier = opinion_traitor
				}
				reverse_has_opinion_modifier = {
					who = FROM
					modifier = declared_war
				}
				reverse_has_opinion_modifier = {
					who = FROM
					modifier = opinion_dishonorable
				}
				reverse_has_opinion_modifier = {
					who = FROM
					modifier = opinion_rebel_traitor
				}
				reverse_has_opinion_modifier = {
					who = FROM
					modifier = attempted_murder_of_spouse
				}
				reverse_has_opinion_modifier = {
					who = FROM
					modifier = attempted_murder_of_vassal
				}
				reverse_has_opinion_modifier = {
					who = FROM
					modifier = attempted_murder
				}
				reverse_has_opinion_modifier = {
					who = FROM
					modifier = attempted_murder_of_child
				}
				reverse_has_opinion_modifier = {
					who = FROM
					modifier = opinion_spouse_slayer
				}
				reverse_has_opinion_modifier = {
					who = FROM
					modifier = opinion_murder_attempt
				}
				reverse_has_opinion_modifier = {
					who = FROM
					modifier = opinion_killed_close_kin
				}
				reverse_has_opinion_modifier = {
					who = FROM
					modifier = opinion_fatwa_target
				}
				reverse_has_opinion_modifier = {
					who = FROM
					modifier = opinion_witch
				}
				reverse_has_opinion_modifier = {
					who = FROM
					modifier = opinion_takfir
				}
				reverse_has_opinion_modifier = {
					who = FROM
					modifier = attempted_murder_of_close_kin
				}
				reverse_has_opinion_modifier = {
					who = FROM
					modifier = killed_vassal
				}
				reverse_has_opinion_modifier = {
					who = FROM
					modifier = opinion_civil_war_loser
				}
				reverse_has_opinion_modifier = {
					who = FROM
					modifier = mad_heretic
				}
				reverse_has_opinion_modifier = {
					who = FROM
					modifier = devious_plotter
				}
				reverse_has_opinion_modifier = {
					who = FROM
					modifier = attempted_kidnapping
				}
				reverse_has_opinion_modifier = {
					who = FROM
					modifier = attempted_kidnapping_of_kin
				}
				reverse_has_opinion_modifier = {
					who = FROM
					modifier = attempted_kidnapping_of_vassal
				}
				reverse_has_opinion_modifier = {
					who = FROM
					modifier = opinion_kidnapped_kin
				}
			}
		}
		allow = {
			ROOT = {
				prisoner = no
			}
		}
		effect = {
			opinion = {
				who = FROM
				modifier = opinion_relieved
				years = 5
			}
			hidden_tooltip = {
				reverse_remove_opinion = {
					who = FROM
					modifier = opinion_traitor
				}
				reverse_remove_opinion = {
					who = FROM
					modifier = declared_war
				}
				reverse_remove_opinion = {
					who = FROM
					modifier = opinion_dishonorable
				}
				reverse_remove_opinion = {
					who = FROM
					modifier = opinion_rebel_traitor
				}
				reverse_remove_opinion = {
					who = FROM
					modifier = attempted_murder_of_spouse
				}
				reverse_remove_opinion = {
					who = FROM
					modifier = attempted_murder_of_vassal
				}
				reverse_remove_opinion = {
					who = FROM
					modifier = attempted_murder
				}
				reverse_remove_opinion = {
					who = FROM
					modifier = attempted_murder_of_child
				}
				reverse_remove_opinion = {
					who = FROM
					modifier = opinion_spouse_slayer
				}
				reverse_remove_opinion = {
					who = FROM
					modifier = opinion_murder_attempt
				}
				reverse_remove_opinion = {
					who = FROM
					modifier = opinion_killed_close_kin
				}
				reverse_remove_opinion = {
					who = FROM
					modifier = opinion_fatwa_target
				}
				reverse_remove_opinion = {
					who = FROM
					modifier = opinion_witch
				}
				reverse_remove_opinion = {
					who = FROM
					modifier = opinion_takfir
				}
				reverse_remove_opinion = {
					who = FROM
					modifier = attempted_murder_of_close_kin
				}
				reverse_remove_opinion = {
					who = FROM
					modifier = killed_vassal
				}
				reverse_remove_opinion = {
					who = FROM
					modifier = opinion_civil_war_loser
				}
				reverse_remove_opinion = {
					who = FROM
					modifier = mad_heretic
				}
				reverse_remove_opinion = {
					who = FROM
					modifier = devious_plotter
				}
				reverse_remove_opinion = {
					who = FROM
					modifier = attempted_kidnapping
				}
				reverse_remove_opinion = {
					who = FROM
					modifier = attempted_kidnapping_of_kin
				}
				reverse_remove_opinion = {
					who = FROM
					modifier = attempted_kidnapping_of_vassal
				}
				reverse_remove_opinion = {
					who = FROM
					modifier = opinion_kidnapped_kin
				}
			}
		}
		ai_will_do = {
			factor = 0
		}
	}

	swear_to_heir = {
		filter = vassals
		ai_target_filter = vassals
		
		from_potential = {
			is_ruler = yes
			is_feudal = yes
			has_regent = no
			primary_title = {
				higher_real_tier_than = DUKE
				OR = {
					has_law = crown_authority_3
					has_law = crown_authority_4
				}
			}
		}
		potential = {
			ai = yes
			vassal_of = FROM
			higher_real_tier_than = BARON
			FROM = {
				current_heir = {
					NOT = { reverse_has_opinion_modifier = { who = ROOT modifier = sworn_to_support_heir } }
				}
			}
			NOT = {
				is_primary_heir = FROM
				has_opinion_modifier = { who = FROM modifier = asked_to_support_heir }
				reverse_has_opinion_modifier = { who = FROM modifier = refused_to_support_heir }
			}
		}
		allow = {
			ROOT = {
				war = no
				has_regent = no
				opinion = { who = FROM value = 50 }
			}
			FROM = {
				war = no
				ruled_years = 10
				prestige = 500
				current_heir = {
					dynasty = PREV
				}
			}
		}
		effect = {
			if = {
				limit = { tier = COUNT }
				FROM = { prestige = -100 }
			}
			if = {
				limit = { tier = DUKE }
				FROM = { prestige = -250 }
			}
			if = {
				limit = { tier = KING }
				FROM = { prestige = -500 }
			}
			ROOT = { character_event = { id = Plus.1600 tooltip = ASKED_TO_SUPPORT_HEIR } }
		}
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.05
				always = yes
			}
			modifier = {
				factor = 5
				tier = KING
			}
			modifier = {
				factor = 2
				tier = DUKE
			}
			modifier = {
				factor = 0.5
				tier = COUNT
				FROM = { higher_tier_than = DUKE }
			}
			modifier = {
				factor = 2
				opinion = { who = FROM value = 75 }
			}
			modifier = {
				factor = 0
				FROM = { NOT = { age = 50 } }
			}
			modifier = {
				factor = 0
				FROM = { NOT = { prestige = 1000 } }
			}
			modifier = {
				factor = 0
				FROM = {
					current_heir = {
						NOT = { is_close_relative = PREV }
					}
				}
			}
			modifier = {
				factor = 0
				FROM = {
					OR = {
						has_law = succ_gavelkind
						has_law = succ_elective_gavelkind
					}
					OR = {
						has_law = agnatic_succession
						has_law = cognatic_succession
					}
					any_child = {
						is_female = no
						NOT = { trait = bastard }
						count = 2
					}
				}
			}
			modifier = {
				factor = 0
				FROM = {
					OR = {
						has_law = succ_gavelkind
						has_law = succ_elective_gavelkind
					}
					has_law = true_cognatic_succession
					any_child = {
						NOT = { trait = bastard }
						count = 2
					}
				}
			}
			modifier = {
				factor = 0
				FROM = {
					OR = {
						has_law = succ_gavelkind
						has_law = succ_elective_gavelkind
					}
					OR = {
						has_law = enatic_succession
						has_law = enatic_cognatic_succession
					}
					any_child = {
						is_female = yes
						NOT = { trait = bastard }
						count = 2
					}
				}
			}
		}
	}
	
	ai_divorce = {
		filter = spouse
		ai_target_filter = spouse
		
		from_potential = {
			ai = yes
			is_married = yes
			is_ruler = yes
			OR = {
				is_female = no
				is_married_matrilineally = yes
			}
			OR = {
				AND = {
					OR = {
						religion = catholic
						religion = fraticelli
						religion = orthodox
						religion = paulician
						religion = nestorian
						religion = monothelite
						religion = iconoclast
						religion = miaphysite
						religion = monophysite
						religion = zoroastrian
						religion = mazdaki
						religion = manichean
						religion = jewish
						religion = samaritan
						religion = karaite
						religion = hindu
						religion = buddhist
						religion = jain
					}
					rightful_religious_head_scope = {
						is_alive = yes
						OR = {
							character = FROM
							opinion = { who = FROM value = 25 }
						}
					}
					piety = 100
				}
				AND = {
					NOT = {
						religion = catholic
						religion = fraticelli
						religion = orthodox
						religion = paulician
						religion = nestorian
						religion = monothelite
						religion = iconoclast
						religion = miaphysite
						religion = monophysite
						religion = zoroastrian
						religion = mazdaki
						religion = manichean
						religion = jewish
						religion = samaritan
						religion = karaite
						religion = hindu
						religion = buddhist
						religion = jain
					}
					scaled_wealth = 1.0
				}
				AND = {
					NOT = { rightful_religious_head_scope = { is_alive = yes } }
					scaled_wealth = 1.0
				}
			}
			NOT = {
				age = 60
				has_character_flag = usurped_by_husband
				has_character_flag = usurped_my_wife
				trait = incapable
				trait = zealous
			}
		}
		potential = {
			is_married = FROM
			is_ruler = no
			NOT = {
				is_lover = FROM
				is_friend = FROM
				any_child = {
					is_alive = yes
					is_female = no
					is_child_of = FROM
					NOT = { trait = bastard }
				}
			}
		}
		allow = {
			OR = {
				has_character_modifier = failed_to_usurp_wife
				reverse_has_opinion_modifier = { who = FROM modifier = opinion_hate }
				reverse_has_opinion_modifier = { who = FROM modifier = opinion_traitor }
				reverse_has_opinion_modifier = { who = FROM modifier = opinion_rebel_traitor }
				reverse_has_opinion_modifier = { who = FROM modifier = attempted_murder }
				reverse_has_opinion_modifier = { who = FROM modifier = attempted_murder_of_child }
				reverse_has_opinion_modifier = { who = FROM modifier = opinion_murder_attempt }
				reverse_has_opinion_modifier = { who = FROM modifier = opinion_killed_close_kin }
				reverse_has_opinion_modifier = { who = FROM modifier = opinion_witch }
				reverse_has_opinion_modifier = { who = FROM modifier = attempted_murder_of_close_kin }
				reverse_has_opinion_modifier = { who = FROM modifier = opinion_civil_war_loser }
				reverse_has_opinion_modifier = { who = FROM modifier = mad_heretic }
				AND = {
					is_rival = FROM
					NOT = { reverse_opinion = { who = FROM value = -50 } }
				}
				AND = {
					#can no longer have children
					OR = {
						trait = leper
						trait = incapable
						trait = celibate
						trait = eunuch
						reverse_has_opinion_modifier = { who = FROM modifier = knows_barren }
						age = 60
						AND = {
							age = 45
							is_female = yes
						}
					}
					#I can still have children
					FROM = {
						fertility = 0.05
						NOT = { age = 60 }
						OR = {
							is_female = no
							NOT = { age = 45 }
						}
					}
				}
			}
		}
		effect = {
			FROM = {
				prestige = -100
				if = {
					limit = {
						OR = {
							religion = catholic
							religion = fraticelli
							religion = orthodox
							religion = paulician
							religion = nestorian
							religion = monothelite
							religion = iconoclast
							religion = miaphysite
							religion = monophysite
							religion = zoroastrian
							religion = mazdaki
							religion = manichean
							religion = jewish
							religion = samaritan
							religion = karaite
							religion = hindu
							religion = buddhist
							religion = jain
						}
						rightful_religious_head_scope = { is_alive = yes }
					}
					piety = -100
				}
				if = {
					limit = {
						NOT = {
							religion = catholic
							religion = fraticelli
							religion = orthodox
							religion = paulician
							religion = nestorian
							religion = monothelite
							religion = iconoclast
							religion = miaphysite
							religion = monophysite
							religion = zoroastrian
							religion = mazdaki
							religion = manichean
							religion = jewish
							religion = samaritan
							religion = karaite
							religion = hindu
							religion = buddhist
							religion = jain
						}
					}
					scaled_wealth = -1.0
				}
				if = {
					limit = {
						OR = {
							religion = catholic
							religion = fraticelli
							religion = orthodox
							religion = paulician
							religion = nestorian
							religion = monothelite
							religion = iconoclast
							religion = miaphysite
							religion = monophysite
							religion = zoroastrian
							religion = mazdaki
							religion = manichean
							religion = jewish
							religion = samaritan
							religion = karaite
							religion = hindu
							religion = buddhist
							religion = jain
						}
						NOT = { rightful_religious_head_scope = { is_alive = yes } }
					}
					scaled_wealth = -1.0
				}
				tooltip = { remove_spouse = ROOT }
			}
			character_event = { id = Plus.140 }
		}
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.01
				always = yes
			}
			modifier = {
				factor = 100
				OR = {
					has_character_modifier = failed_to_usurp_wife
					reverse_has_opinion_modifier = { who = FROM modifier = opinion_hate }
					reverse_has_opinion_modifier = { who = FROM modifier = opinion_traitor }
					reverse_has_opinion_modifier = { who = FROM modifier = opinion_rebel_traitor }
					reverse_has_opinion_modifier = { who = FROM modifier = attempted_murder }
					reverse_has_opinion_modifier = { who = FROM modifier = attempted_murder_of_child }
					reverse_has_opinion_modifier = { who = FROM modifier = opinion_murder_attempt }
					reverse_has_opinion_modifier = { who = FROM modifier = opinion_killed_close_kin }
					reverse_has_opinion_modifier = { who = FROM modifier = opinion_witch }
					reverse_has_opinion_modifier = { who = FROM modifier = attempted_murder_of_close_kin }
					reverse_has_opinion_modifier = { who = FROM modifier = opinion_civil_war_loser }
					reverse_has_opinion_modifier = { who = FROM modifier = mad_heretic }
				}
			}
			modifier = {
				factor = 0.1
				reverse_opinion = { who = FROM value = 0 }
			}
			modifier = {
				factor = 0.1
				FROM = { trait = slothful }
			}
			modifier = {
				factor = 0.1
				FROM = { trait = trusting }
			}
			modifier = {
				factor = 10
				FROM = { trait = diligent }
			}
			modifier = {
				factor = 10
				FROM = { trait = ambitious }
			}
			modifier = {
				factor = 10
				FROM = {
					OR = {
						trait = cruel
						trait = greedy
						trait = cynical
						trait = paranoid
					}
				}
			}
			modifier = {
				factor = 0
				FROM = {
					OR = {
						trait = kind
						trait = humble
						trait = craven
						trait = content
					}
					NOT = {
						trait = diligent
						trait = ambitious
					}
				}
				NOT = {
					has_character_modifier = failed_to_usurp_wife
					reverse_has_opinion_modifier = { who = FROM modifier = opinion_hate }
					reverse_has_opinion_modifier = { who = FROM modifier = opinion_traitor }
					reverse_has_opinion_modifier = { who = FROM modifier = opinion_rebel_traitor }
					reverse_has_opinion_modifier = { who = FROM modifier = attempted_murder }
					reverse_has_opinion_modifier = { who = FROM modifier = attempted_murder_of_child }
					reverse_has_opinion_modifier = { who = FROM modifier = opinion_murder_attempt }
					reverse_has_opinion_modifier = { who = FROM modifier = opinion_killed_close_kin }
					reverse_has_opinion_modifier = { who = FROM modifier = opinion_witch }
					reverse_has_opinion_modifier = { who = FROM modifier = attempted_murder_of_close_kin }
					reverse_has_opinion_modifier = { who = FROM modifier = opinion_civil_war_loser }
					reverse_has_opinion_modifier = { who = FROM modifier = mad_heretic }
				}
			}
		}
	}
}

decisions = {
	imperial_coronation = {
		is_high_prio = yes
		
		potential = {
			OR = {
				trait = uncrowned
				AND = {
					trait = crowned
					has_landed_title = e_byzantium
				}
			}
			is_feudal = yes
			is_landed = yes
			is_playable = yes
			real_tier = EMPEROR
			has_horde_culture = no
			primary_title = {
				is_tribal_type_title = no
			}
			NOT = {
				AND = {
					has_landed_title = e_byzantium
					NOT = { has_landed_title = k_orthodox }
					religion = orthodox
				}
				has_landed_title = e_hre
				has_landed_title = e_karling
				has_character_modifier = do_not_disturb
				has_character_flag = planning_coronation
			}
		}
		allow = {
			war = no
			has_regent = no
			scaled_wealth = 1.0
			piety = 100
			NOT = { trait = excommunicated }
			custom_tooltip = {
				text = HAS_BISHOP_WILLING_TO_CORONATE
				hidden_tooltip = {
					any_realm_character = {
						capital_holding = { holding_type = temple }
						is_ruler = yes
						is_adult = yes
						religion = ROOT
						prisoner = no
						NOT = { trait = incapable }
					}
				}
			}
		}
		effect = {
			set_character_flag = planning_coronation
			scaled_wealth = -1.0
			character_event = { id = Plus.1200 } # send invitations
			hidden_tooltip = {
				add_character_modifier = {
					name = do_not_disturb
					days = 200
					hidden = yes
				}
				narrative_event = { id = Plus.1215 days = 30 } # coronation start
			}
		}
		ai_will_do = {
			factor = 1
		}
	}
	
	royal_coronation = {
		is_high_prio = yes
		
		potential = {
			trait = uncrowned
			is_feudal = yes
			is_landed = yes
			is_playable = yes
			real_tier = KING
			has_horde_culture = no
			primary_title = {
				is_tribal_type_title = no
				is_vice_royalty = no
			}
			NOT = {
				has_character_modifier = do_not_disturb
				has_character_flag = planning_coronation
			}
		}
		allow = {
			war = no
			has_regent = no
			scaled_wealth = 1.0
			piety = 100
			NOT = { trait = excommunicated }
			custom_tooltip = {
				text = HAS_BISHOP_WILLING_TO_CORONATE
				hidden_tooltip = {
					any_realm_character = {
						capital_holding = { holding_type = temple }
						is_ruler = yes
						religion = ROOT
						is_adult = yes
						prisoner = no
						NOT = { trait = incapable }
					}
				}
			}
		}
		effect = {
			set_character_flag = planning_coronation
			scaled_wealth = -1.0
			character_event = { id = Plus.1200 } # send invitations
			hidden_tooltip = {
				add_character_modifier = {
					name = do_not_disturb
					days = 200
					hidden = yes
				}
				narrative_event = { id = Plus.1215 days = 30 } # coronation start
			}
		}
		ai_will_do = {
			factor = 1
		}
	}

	give_to_charity = {
		potential = {
			is_ruler = yes
			has_regent = no
			demesne_size = 1
			NOT = { religion = sunni }
			NOT = { religion = shiite }
			OR = {
				NOT = { religion = catholic }
				NOT = {
					rightful_religious_head_scope = {
						is_alive = yes
						NOT = { character = ROOT }
					}
				}
			}
		}
		allow = {
			treasury = 50
			custom_tooltip = {
				text = RECENTLY_GAVE_TO_CHARITY
				hidden_tooltip = {
					NOT = { has_character_modifier = charity_timer }
				}
			}
		}
		effect = {
			treasury = -50
			piety = 25
			if = {
				limit = { any_vassal = { leads_faction = faction_tradition } }
				custom_tooltip = { text = TRADITIONFACTIONMOODPLUS }
				hidden_tooltip = {
					random_vassal = { limit = { leads_faction = faction_tradition } set_variable = { which = "faction_mood_increase" value = 1 } }
					character_event = { id = PlusFaction.200 days = 1 } #recalculate faction moods
				}
			}
			hidden_tooltip = {
				if = {
					limit = { ai = no }
					add_character_modifier = {
						name = charity_timer
						duration = 1095
						hidden = yes
					}
				}
				if = {
					limit = { ai = yes }
					add_character_modifier = {
						name = charity_timer
						duration = 3650
						hidden = yes
					}
				}
			}
		}
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0.1
				always = yes
			}
			modifier = {
				factor = 0
				piety = 0
				OR = {
					trait = cynical
					trait = cruel
					trait = greedy
					lower_tier_than = duke
				}
			}
			modifier = {
				factor = 0
				piety = 100
			}
			modifier = {
				factor = 0
				piety = 0
				NOT = { treasury = 200 }
			}
			modifier = {
				factor = 0
				piety = 0
				has_character_modifier = ai_austerity
			}
		}
	}

	bring_children_to_court = {
		is_high_prio = yes
		potential = {
			ai = no
			any_child = {
				is_adult = no
				is_ruler = no
				prisoner = no
				NOT = {
					trait = bastard
					any_liege = { character = ROOT }
				}
			}
		}
		allow = {
			any_child = {
				is_adult = no
				is_ruler = no
				prisoner = no
				NOT = { trait = bastard }
				opinion = { who = ROOT value = 0 }
				liege = {
					lower_tier_than = ROOT
					opinion = { who = ROOT value = 0 }
				}
			}
		}
		effect = {
			any_child = {
				limit = {
					is_adult = no
					is_ruler = no
					prisoner = no
					NOT = { trait = bastard }
					opinion = { who = ROOT value = 0 }
					liege = {
						lower_tier_than = ROOT
						opinion = { who = ROOT value = 0 }
					}
				}
				custom_tooltip = {
					text = CUSTOMTOOLTIP38
					hidden_tooltip = { banish = ROOT }
				}
			}
		}
		ai_will_do = {
			factor = 0
		}
	}

	reclaim_titles_divorce = {
		is_high_prio = yes
		potential = {
			has_character_flag = usurped_by_husband
			OR = {
				any_independent_ruler = {
					has_character_flag = usurped_my_wife
					reverse_has_opinion_modifier = { who = ROOT modifier = opinion_divorced }
					NOT = { any_spouse = { character = ROOT } }
					ROOT = {
						any_claim = {
							ROOT = { has_strong_claim = PREV }
							holder_scope = { character = PREVPREVPREV }
						}
					}
				}
				any_independent_ruler = {
					any_vassal = {
						has_character_flag = usurped_my_wife
						reverse_has_opinion_modifier = { who = ROOT modifier = opinion_divorced }
						NOT = { any_spouse = { character = ROOT } }
						ROOT = {
							any_claim = {
								ROOT = { has_strong_claim = PREV }
								holder_scope = { character = PREVPREVPREV }
							}
						}
					}
				}
			}		
		}
		allow = {
			prisoner = no
			NOT = {
				trait = excommunicated
				trait = incapable
			}
		}
		effect = {
			clr_character_flag = usurped_by_husband
			random_independent_ruler = {
				limit = {
					has_character_flag = usurped_my_wife
					reverse_has_opinion_modifier = { who = ROOT modifier = opinion_divorced }
					NOT = { any_spouse = { character = ROOT } }
					ROOT = {
						any_claim = {
							ROOT = { has_strong_claim = PREV }
							holder_scope = { character = PREVPREVPREV }
						}
					}
				}
				clr_character_flag = usurped_my_wife
				character_event = { id = FemRule.310 tooltip = REGAIN_TITLES_DIVORCE }
			}
			any_independent_ruler = {
				limit = {
					any_vassal = {
						has_character_flag = usurped_my_wife
						reverse_has_opinion_modifier = { who = ROOT modifier = opinion_divorced }
						NOT = { any_spouse = { character = ROOT } }
						ROOT = {
							any_claim = {
								ROOT = { has_strong_claim = PREV }
								holder_scope = { character = PREVPREVPREV }
							}
						}
					}
				}
				random_vassal = {
					limit = {
						has_character_flag = usurped_my_wife
						reverse_has_opinion_modifier = { who = ROOT modifier = opinion_divorced }
						NOT = { any_spouse = { character = ROOT } }
						ROOT = {
							any_claim = {
								ROOT = { has_strong_claim = PREV }
								holder_scope = { character = PREVPREVPREV }
							}
						}
					}
					clr_character_flag = usurped_my_wife
					character_event = { id = FemRule.310 tooltip = REGAIN_TITLES_DIVORCE }
				}
			}
		}
	}

	usurp_husband = {
		is_high_prio = yes
		
		potential = {
			is_female = yes
			has_character_flag = usurped_by_husband
			spouse = { has_character_flag = usurped_my_wife }
		}
		
		allow = {
			any_claim = {
				holder_scope = {
					NOT = {
						is_child_of = ROOT
						has_character_flag = usurped_my_wife
					}
					any_liege = {
						has_character_flag = usurped_my_wife
						spouse = { character = ROOT }
						ROOT = { has_strong_claim = PREVPREVPREV }
					}
				}
			}
		}	
		
		effect = {
			any_claim = {
				limit = {
					holder_scope = {
						NOT = {
							is_child_of = ROOT
							spouse = { character = ROOT }
						}
						any_liege = {
							has_character_flag = usurped_my_wife
							spouse = { character = ROOT }
							ROOT = { has_strong_claim = PREVPREVPREV }
						}
					}
				}
				hidden_tooltip = {
					holder_scope = { set_character_flag = wife_regained_title }
				}
				usurp_title_plus_barony_if_unlanded = ROOT
				any_claimant = {
					limit = { has_character_flag = wife_regained_title }
					clr_character_flag = wife_regained_title
					remove_claim = PREV
				}
			}
			hidden_tooltip = {
				spouse = {
					letter_event = { id = FemRule.312 }
				}
			}
		}
	}
	
	request_important_prisoners = {
		is_high_prio = yes
		
		potential = {
			is_ruler = yes
			higher_tier_than = BARON
			any_realm_lord = {
				ai = yes
				NOT = { war_with = ROOT }
				is_liege_or_above = ROOT
				any_courtier = {
					prisoner = yes
					higher_tier_than = BARON
					war_with = ROOT
				}
			}
		}
		
		allow = {
			prisoner = no
			prestige = 0
		}
		
		effect = {
			any_realm_lord = {
				limit = {
					ai = yes
					NOT = { war_with = ROOT }
					is_liege_or_above = ROOT
					any_courtier = {
						prisoner = yes
						higher_tier_than = BARON
						war_with = ROOT
					}
				}
				any_courtier = {
					limit = {
						prisoner = yes
						higher_tier_than = BARON
						war_with = ROOT
					}
					hidden_tooltip = {
						prisoner = no
					}
					prisoner = ROOT
				}
			}
		}
		
		ai_will_do = {
			factor = 1
		}
	}

	mend_great_schism_catholic = {
		is_high_prio = yes
		potential = {
			has_dlc = "Legacy of Rome"
			independent = yes
			has_regent = no
			is_heretic = no
			OR = {
				has_landed_title = k_papal_state
				num_of_emperor_titles = 1
			}
			OR = {
				religion = catholic
				religion = cathar
				religion = fraticelli
				religion = waldensian
				religion = lollard
			}
			NOT = { has_global_flag = schism_mended }
		}
		allow = {
			piety = 2000
			religion_authority = 0.9
			completely_controls = c_byzantion
			b_hagiasophia = {
				holder_scope = {
					is_heretic = no
					hidden_tooltip = {
						OR = {
							religion = catholic
							religion = cathar
							religion = fraticelli
							religion = waldensian
							religion = lollard
						}
					}
				}
			}
			completely_controls = c_antiocheia
			b_antiocheia = {
				holder_scope = {
					is_heretic = no
					hidden_tooltip = {
						OR = {
							religion = catholic
							religion = cathar
							religion = fraticelli
							religion = waldensian
							religion = lollard
						}
					}
				}
			}
			completely_controls = c_jerusalem
			b_jerusalem = {
				holder_scope = {
					is_heretic = no
					hidden_tooltip = {
						OR = {
							religion = catholic
							religion = cathar
							religion = fraticelli
							religion = waldensian
							religion = lollard
						}
					}
				}
			}
			completely_controls = c_alexandria
			b_alexandria = {
				holder_scope = {
					is_heretic = no
					hidden_tooltip = {
						OR = {
							religion = catholic
							religion = cathar
							religion = fraticelli
							religion = waldensian
							religion = lollard
						}
					}
				}
			}
			custom_tooltip = {
				text = ctt_schism_catholic_rome
				OR = {
					AND = {
						completely_controls = c_roma
						b_roma = { 
							holder_scope = {
								is_heretic = no
								OR = {
									religion = catholic
									religion = cathar
									religion = fraticelli
									religion = waldensian
									religion = lollard
								}
							}
						}
					}
					c_roma = {
						holder_scope = {
							has_landed_title = k_papal_state
						}
					}
				}
			}
		}
		effect = {
			narrative_event = { id = LoR.220 tooltip = EVTTOOLTIP1000182069}
			set_global_flag = schism_mended
		}
		ai_will_do = {
			factor = 1
		}
	}
	
	mend_great_schism_miaphysite = {
		is_high_prio = yes
		potential = {
			has_dlc = "Legacy of Rome"
			independent = yes
			has_regent = no
			is_heretic = no		
			num_of_emperor_titles = 1
			OR = {
				religion = miaphysite
				religion = monophysite
			}
			NOT = { has_global_flag = schism_mended }
		}
		allow = {
			piety = 2000
			religion_authority = 0.5
			completely_controls = c_byzantion
			b_hagiasophia = {
				holder_scope = {
					is_heretic = no
					OR = {
						religion = miaphysite
						religion = monophysite
					}
				}
			}
			completely_controls = c_antiocheia
			b_antiocheia = {
				holder_scope = {
					is_heretic = no
					OR = {
						religion = miaphysite
						religion = monophysite
					}
				}
			}
			completely_controls = c_jerusalem
			b_jerusalem = {
				holder_scope = {
					is_heretic = no
					OR = {
						religion = miaphysite
						religion = monophysite
					}
				}
			}
			completely_controls = c_alexandria
			b_alexandria = {
				holder_scope = {
					is_heretic = no
					OR = {
						religion = miaphysite
						religion = monophysite
					}
				}
			}
			completely_controls = c_roma
			b_roma = {
				holder_scope = {
					is_heretic = no
					OR = {
						religion = miaphysite
						religion = monophysite
					}
				}
			}
		}
		effect = {
			if = {
				limit = { religion = miaphysite }
				create_character = {
					religion = ROOT
					culture = ROOT
					random_traits = no
					trait = mastermind_theologian
					trait = patient
					trait = mystic
					dynasty = NONE
					age = 34
					attributes = {
						martial = 2
						diplomacy = 8
						intrigue = 2
						learning = 9
						stewardship = 2
					}
				}
				new_character = {
					d_miaphysite = {
						grant_title = PREV						
					}
					b_alexandria = {
						grant_title = PREV
					}					
					set_defacto_liege = ROOT
				}
			}	
			if = {
				limit = { religion = monophysite }
				create_character = {
					religion = ROOT
					culture = ROOT
					random_traits = no
					trait = mastermind_theologian
					trait = patient
					trait = mystic
					dynasty = NONE
					age = 34
					attributes = {
						martial = 2
						diplomacy = 8
						intrigue = 2
						learning = 9
						stewardship = 2
					}
				}
				new_character = {
					d_monophysite = {
						grant_title = PREV						
					}
					b_alexandria = {
						grant_title = PREV
					}
					set_defacto_liege = ROOT
				}
			}					
			narrative_event = { id = LoR.225 tooltip = EVTTOOLTIPLoR.210 }
			set_global_flag = schism_mended
		}
		ai_will_do = {
			factor = 1
		}
	}
	
	fourth_crusade = {
		potential = {
			can_call_crusade = yes
			has_called_crusade = no
			is_heretic = no
			ai = yes
			OR = {
				religion = catholic
				religion = cathar
				religion = fraticelli
				religion = waldensian
				religion = lollard
			}
			NOT = {
				trait = loyalist
				trait = rebel
				has_character_modifier = crusade_timer
				has_character_modifier = holy_truce_timer
				has_global_flag = fourth_crusade_happened
			}
			has_global_flag = catholic_crusade_failed
			496 = {
				kingdom = {
					any_independent_ruler = {
						496 = {
							owner = {
								OR = {
									character = PREVPREV
									same_realm = PREVPREV
								}
							}
						}
						NOT = { has_character_modifier = holy_truce_timer }
						prisoner = no
						NOT = { religion = ROOT }
						num_of_realm_counties = {
							value = 6
							title = PREV
						}
					}
				}
			}
		}
		allow = {
			trait = bad_priest_christian
			religion_authority = 0.4
		}
		effect = {
			set_global_flag = fourth_crusade_ongoing
			set_global_flag = fourth_crusade_happened
			496 = {
				kingdom = {
					ROOT = {
						war = {
							casus_belli = crusade
							target = PREVPREV
							thirdparty_title = PREV
						}
					}
				}
			}
		}
		ai_will_do = {
			factor = 1
		}
	}
	
	take_loan = {
		potential = {
			ai = no
			is_ruler = yes
			OR = {
				higher_tier_than = baron
				is_patrician = yes
			}
			NOT = { has_character_flag = offended_moneylenders }
			NOT = { 
				has_character_modifier = loan_50_hidden
				has_character_modifier = loan_100_hidden
				has_character_modifier = loan_200_hidden
				has_character_modifier = loan_400_hidden
				has_character_modifier = loan_600_hidden
				has_character_modifier = loan_800_hidden
				has_character_modifier = loan_1000_hidden
			}
		}
		effect = {
			#50g loan
			if = {
				limit = {
					NOT = { monthly_income = 2.5 }
				}
				wealth = 50
				add_character_modifier = {
					name = loan_50
					duration = 1825
					inherit = yes
				}
				hidden_tooltip = {
					add_character_modifier = {
						name = loan_50_hidden
						duration = -1
						inherit = yes
						hidden = yes
					}	
				}
			}
			#100g loan
			if = {
				limit = {
					monthly_income = 2.5
					NOT = { monthly_income = 5 }
				}
				wealth = 100
				add_character_modifier = {
					name = loan_100
					duration = 1825
					inherit = yes
				}
				hidden_tooltip = {
					add_character_modifier = {
						name = loan_100_hidden
						duration = -1
						inherit = yes
						hidden = yes
					}	
				}
			}
			#200g loan
			if = {
				limit = {
					monthly_income = 5
					NOT = { monthly_income = 10 }
				}
				wealth = 200
				add_character_modifier = {
					name = loan_200
					duration = 1825
					inherit = yes
				}
				hidden_tooltip = {
					add_character_modifier = {
						name = loan_200_hidden
						duration = -1
						inherit = yes
						hidden = yes
					}	
				}
			}
			#400g loan
			if = {
				limit = {
					monthly_income = 10
					NOT = { monthly_income = 15 }
				}
				wealth = 400
				add_character_modifier = {
					name = loan_400
					duration = 1825
					inherit = yes
				}
				hidden_tooltip = {
					add_character_modifier = {
						name = loan_400_hidden
						duration = -1
						inherit = yes
						hidden = yes
					}	
				}
			}
			#600g loan
			if = {
				limit = {
					monthly_income = 15
					NOT = { monthly_income = 20 }
				}
				wealth = 600
				add_character_modifier = {
					name = loan_600
					duration = 1825
					inherit = yes
				}
				hidden_tooltip = {
					add_character_modifier = {
						name = loan_600_hidden
						duration = -1
						inherit = yes
						hidden = yes
					}	
				}
			}
			#800g loan
			if = {
				limit = {
					monthly_income = 20
					NOT = { monthly_income = 25 }
				}
				wealth = 800
				add_character_modifier = {
					name = loan_800
					duration = 1825
					inherit = yes
				}
				hidden_tooltip = {
					add_character_modifier = {
						name = loan_800_hidden
						duration = -1
						inherit = yes
						hidden = yes
					}	
				}
			}
			#1000g loan
			if = {
				limit = {
					monthly_income = 25
				}
				wealth = 1000
				add_character_modifier = {
					name = loan_1000
					duration = 1825
					inherit = yes
				}
				hidden_tooltip = {
					add_character_modifier = {
						name = loan_1000_hidden
						duration = -1
						inherit = yes
						hidden = yes
					}	
				}
			}
			custom_tooltip = {
				text = EVTTOOLTIP38002
			}
			set_character_flag = loan_taken
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 0
		}
	}
	
	repay_loan_50 = {
		potential = {
			ai = no
			is_ruler = yes
			NOT = { has_character_flag = loan_in_progress }
			has_character_modifier = loan_50_hidden
		}
		allow = {
			wealth = 62.5
		}
		effect = {
			wealth = -62.5
			remove_character_modifier = loan_50
			hidden_tooltip = {
				remove_character_modifier = loan_50_hidden
			}
			if = {
				limit = { NOT = { has_character_modifier = borrowed_from_jews } }
				clr_character_flag = loan_taken
			}
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 0
		}
	}
	
	repay_loan_100 = {
		potential = {
			ai = no
			is_ruler = yes
			NOT = { has_character_flag = loan_in_progress }
			has_character_modifier = loan_100_hidden
		}
		allow = {
			wealth = 125
		}
		effect = {
			wealth = -125
			remove_character_modifier = loan_100
			hidden_tooltip = {
				remove_character_modifier = loan_100_hidden
			}
			if = {
				limit = { NOT = { has_character_modifier = borrowed_from_jews } }
				clr_character_flag = loan_taken
			}			
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 0
		}
	}
	
	repay_loan_200 = {
		potential = {
			ai = no
			is_ruler = yes
			NOT = { has_character_flag = loan_in_progress }
			has_character_modifier = loan_200_hidden
		}
		allow = {
			wealth = 250
		}
		effect = {
			wealth = -250
			remove_character_modifier = loan_200
			hidden_tooltip = {
				remove_character_modifier = loan_200_hidden
			}
			if = {
				limit = { NOT = { has_character_modifier = borrowed_from_jews } }
				clr_character_flag = loan_taken
			}			
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 0
		}
	}
	
	repay_loan_400 = {
		potential = {
			ai = no
			is_ruler = yes
			NOT = { has_character_flag = loan_in_progress }
			has_character_modifier = loan_400_hidden
		}
		allow = {
			wealth = 500
		}
		effect = {
			wealth = -500
			remove_character_modifier = loan_400
			hidden_tooltip = {
				remove_character_modifier = loan_400_hidden
			}
			if = {
				limit = { NOT = { has_character_modifier = borrowed_from_jews } }
				clr_character_flag = loan_taken
			}			
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 0
		}
	}
	
	repay_loan_600 = {
		potential = {
			ai = no
			is_ruler = yes
			NOT = { has_character_flag = loan_in_progress }
			has_character_modifier = loan_600_hidden
		}
		allow = {
			wealth = 750
		}
		effect = {
			wealth = -750
			remove_character_modifier = loan_600
			hidden_tooltip = {
				remove_character_modifier = loan_600_hidden
			}
			if = {
				limit = { NOT = { has_character_modifier = borrowed_from_jews } }
				clr_character_flag = loan_taken
			}			
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 0
		}
	}
	
	repay_loan_800 = {
		potential = {
			ai = no
			is_ruler = yes
			NOT = { has_character_flag = loan_in_progress }
			has_character_modifier = loan_800_hidden
		}
		allow = {
			wealth = 1000
		}
		effect = {
			wealth = -1000
			remove_character_modifier = loan_800
			hidden_tooltip = {
				remove_character_modifier = loan_800_hidden
			}
			if = {
				limit = { NOT = { has_character_modifier = borrowed_from_jews } }
				clr_character_flag = loan_taken
			}			
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 0
		}
	}
	
	repay_loan_1000 = {
		potential = {
			ai = no
			is_ruler = yes
			NOT = { has_character_flag = loan_in_progress }
			has_character_modifier = loan_1000_hidden
		}
		allow = {
			wealth = 1250
		}
		effect = {
			wealth = -1250
			remove_character_modifier = loan_1000
			hidden_tooltip = {
				remove_character_modifier = loan_1000_hidden
			}
			if = {
				limit = { NOT = { has_character_modifier = borrowed_from_jews } }
				clr_character_flag = loan_taken
			}			
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 0
		}
	}
	
	ai_take_loan = {
		potential = {
			ai = yes
			is_ruler = yes
			NOT = { has_landed_title = e_mexikha }
			OR = {
				higher_tier_than = baron
				is_patrician = yes
			}
			NOT = { check_variable = { which = "loan_amount" value = 49.5 } }
		}
		allow = {
			OR = {
				AND = {
					prisoner = yes
					war = no
				}
				any_war = {
					OR = {
						attacker = {
							character = ROOT
							NOT = { war_score = -15 }
						}
						defender = {
							character = ROOT
							war_score = 15
						}
					}
				}
				AND = {
					tier = DUKE
					num_of_duke_titles = 3
					war = no
				}
				any_realm_title = { is_occupied = yes }
				NOT = { wealth = 0 }
			}
		}
		effect = {
			#50g loan
			if = {
				limit = {
					NOT = { monthly_income = 2.5 }
				}
				wealth = 50
				set_variable = { which = "loan_amount" value = 50 }
			}
			#100g loan
			if = {
				limit = {
					monthly_income = 2.5
					NOT = { monthly_income = 5 }
				}
				wealth = 100
				set_variable = { which = "loan_amount" value = 100 }
			}
			#200g loan
			if = {
				limit = {
					monthly_income = 5
					NOT = { monthly_income = 10 }
				}
				wealth = 200
				set_variable = { which = "loan_amount" value = 200 }
			}
			#400g loan
			if = {
				limit = {
					monthly_income = 10
					NOT = { monthly_income = 15 }
				}
				wealth = 400
				set_variable = { which = "loan_amount" value = 400 }
			}
			#600g loan
			if = {
				limit = {
					monthly_income = 15
					NOT = { monthly_income = 20 }
				}
				wealth = 600
				set_variable = { which = "loan_amount" value = 600 }
			}
			#800g loan
			if = {
				limit = {
					monthly_income = 20
					NOT = { monthly_income = 25 }
				}
				wealth = 800
				set_variable = { which = "loan_amount" value = 800 }
			}
			#1000g loan
			if = {
				limit = {
					monthly_income = 25
				}
				wealth = 1000
				set_variable = { which = "loan_amount" value = 1000 }
			}
			add_character_modifier = { name = "loan_timer" duration = -1 }
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 1
		}
	}
	
	ai_repay_loan = {
		potential = {
			ai = yes
			is_ruler = yes
			prisoner = no
			war = no
			check_variable = { which = "loan_amount" value = 49.5 }
		}
		allow = {
			wealth = 50
		}
		effect = {
			wealth = -50
			hidden_tooltip = { change_variable = { which = "loan_amount" value = -50 } }
			if = {
				limit = { NOT = { check_variable = { which = "loan_amount" value = 49.5 } } }
				remove_character_modifier = loan_timer
			}
		}
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0
				has_character_modifier = ai_austerity
			}
		}
	}

	employ_chancellor = {
		potential = {
			ai = no
			is_ruler = yes
			OR = {
				higher_tier_than = BARON
				is_patrician = yes
			}
			NOT = { has_character_modifier = employment_timer }
		}
		allow = {
			custom_tooltip = { text = employ_once_per_month }
			treasury = 10
		}
		effect = {
			treasury = -10
			create_random_diplomat = {
				random_traits = yes
				dynasty = random
				female = no
			}
			new_character = {
				hidden_tooltip = {
					if ={
						limit = { ROOT = { religion_group = jewish_group } }
						random = {
							chance = 70
							add_trait = yehudi
						}
					}
					set_character_flag = yehudi_check
				}
				hidden_tooltip = {
					if = {
						limit = {
							religion_group = indian_group
						}
						add_trait = kshatriya
						character_event = { id = RoI.30121 }
					}
				}				
			}				
			add_character_modifier = {
				name = employment_timer
				duration = 30
				hidden = yes
			}
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 0
		}
	}

	employ_marshal = {
		potential = {
			ai = no
			demesne_size = 1
			is_ruler = yes
			OR = {
				higher_tier_than = BARON
				is_patrician = yes
			}
			NOT = { has_character_modifier = employment_timer }
		}
		allow = {
			custom_tooltip = { text = employ_once_per_month }
			treasury = 10
		}
		effect = {
			treasury = -10
			create_random_soldier = {
				random_traits = yes
				dynasty = random
				female = no
			}
			new_character = {
				hidden_tooltip = {
					if ={
						limit = { ROOT = { religion_group = jewish_group } }
						random = {
							chance = 70
							add_trait = yehudi
						}
					}
					set_character_flag = yehudi_check
				}
				hidden_tooltip = {
					if = {
						limit = {
							religion_group = indian_group
						}
						add_trait = kshatriya
						character_event = { id = RoI.30121 }
					}
				}				
			}				
			add_character_modifier = {
				name = employment_timer
				duration = 30
				hidden = yes
			}
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 0
		}
	}

	employ_spymaster = {
		potential = {
			demesne_size = 1
			is_ruler = yes
			OR = {
				higher_tier_than = BARON
				is_patrician = yes
			}
			NOT = { has_character_modifier = employment_timer }
		}
		allow = {
			custom_tooltip = { text = employ_once_per_month }
			treasury = 10
		}
		effect = {
			treasury = -10
			log = "employ_spymaster: [Root.GetBestName] is employing a spymaster"
			create_random_intriguer = {
				random_traits = yes
				dynasty = random
				female = no
			}
			new_character = {
				hidden_tooltip = {
					if ={
						limit = { ROOT = { religion_group = jewish_group } }
						random = {
							chance = 70
							add_trait = yehudi
						}
					}
					set_character_flag = yehudi_check
				}
				hidden_tooltip = {
					if = {
						limit = {
							religion_group = indian_group
						}
						add_trait = kshatriya
						character_event = { id = RoI.30121 }
					}
				}
			}
			add_character_modifier = {
				name = employment_timer
				duration = 30
				hidden = yes
			}
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0
				any_courtier = {
					NOT = { is_married = ROOT }
					OR = {
						trait = amateurish_plotter
						trait = flamboyant_schemer
						trait = intricate_webweaver
						trait = elusive_shadow
					}
				}
			}
		}
	}

	employ_priest = {
		potential = {
			demesne_size = 1
			is_ruler = yes
			OR = {
				higher_tier_than = BARON
				is_patrician = yes
			}
			NOT = { has_character_modifier = employment_timer }
		}
		allow = {
			custom_tooltip = { text = employ_once_per_month }
			piety = 10
		}
		effect = {
			piety = -10
			create_random_priest = {
				random_traits = yes
				dynasty = random
				female = no
			}
			new_character = {
				hidden_tooltip = {
					if ={
						limit = { ROOT = { religion_group = jewish_group } }
						random = {
							chance = 70
							add_trait = yehudi
						}
					}
					set_character_flag = yehudi_check
				}
				hidden_tooltip = {
					if = {
						limit = {
							religion_group = indian_group
						}
						add_trait = brahmin
						character_event = { id = RoI.30121 }
					}
				}
			}
			add_character_modifier = {
				name = employment_timer
				duration = 30
				hidden = yes
			}
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0
				OR = {
					is_tribal = no
					any_courtier = {
						religion = ROOT
						culture = ROOT
						is_ruler = no
						has_job_title = no
						is_female = no
						is_adult = yes
						health = 4
						NOT = { trait = incapable }
						OR = {
							trait = detached_priest
							trait = martial_cleric
							trait = scholarly_theologian
							trait = mastermind_theologian
						}
					}
				}
			}
		}
	}
	
	employ_steward = {
		potential = {
			demesne_size = 1
			is_ruler = yes
			OR = {
				higher_tier_than = BARON
				is_patrician = yes
			}
			NOT = { has_character_modifier = employment_timer }
		}
		allow = {
			custom_tooltip = { text = employ_once_per_month }
			treasury = 10
		}
		effect = {
			treasury = -10
			create_random_steward = {
				random_traits = yes
				dynasty = random
				female = no
			}
			new_character = {
				hidden_tooltip = {
					if ={
						limit = { ROOT = { religion_group = jewish_group } }
						random = {
							chance = 70
							add_trait = yehudi
						}
					}
					set_character_flag = yehudi_check
				}
				hidden_tooltip = {
					if = {
						limit = {
							religion_group = indian_group
						}
						add_trait = kshatriya
						character_event = { id = RoI.30121 }
					}
				}
			}
			add_character_modifier = {
				name = employment_timer
				duration = 30
				hidden = yes
			}
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0
				any_courtier = {
					NOT = { is_married = ROOT }
					OR = {
						trait = indulgent_wastrel
						trait = thrifty_clerk
						trait = fortune_builder
						trait = midas_touched
					}
				}
			}
		}
	}
	
	present_debutante = {
		potential = {
			is_ruler = yes
			higher_tier_than = BARON
			demesne_size = 1
			is_adult = yes
			NOT = { has_character_modifier = employment_timer }
		}
		allow = {
			custom_tooltip = { text = employ_once_per_month }
			treasury = 10
		}
		effect = {
			treasury = -10
			create_character = {
				random_traits = yes
				dynasty = random
				female = yes
				age = 17
			}
			new_character = {
				hidden_tooltip = {
					if ={
						limit = { ROOT = { religion_group = jewish_group } }
						random = {
							chance = 70
							add_trait = yehudi
						}
					}
					set_character_flag = yehudi_check
				}
				hidden_tooltip = {
					if = {
						limit = {
							religion_group = indian_group
						}
						add_trait = kshatriya
						character_event = { id = RoI.30121 }
					}
				}
				set_character_flag = debutante
			}
			add_character_modifier = {
				name = employment_timer
				duration = 30
				hidden = yes
			}
			if = {
				limit = { ai = yes }
				set_character_flag = employed_debutante
			}
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0
				OR = {
					has_character_flag = employed_debutante
					is_female = yes
					religion_group = muslim
					NOT = { has_ambition = obj_find_lover }
					NOT = { treasury = 100 }
				}
			}
			modifier = {
				factor = 0
				has_character_modifier = ai_austerity
			}
		}
	}
	
	ransom_nonvassal = {
		potential = {
			ai = no
			any_courtier = {
				NOT = { same_realm = ROOT }
				prisoner = yes
			}
		}
		
		allow = {
			NOT = { has_character_modifier = ransom_timer }
		}
		
		effect = {
			add_character_modifier = {
				name = ransom_timer
				duration = 25
				hidden = yes
			}
			any_courtier = {
				limit = {
					NOT = { same_realm = ROOT }
					prisoner = yes
				}
				character_event = { id = Plus.985 days = 5 random = 12 tooltip = ransom_all_tooltip }
			}
		}
	}
	
	ransom_all = {
		potential = {
			ai = no
			any_courtier = {
				prisoner = yes
			}
		}
		
		allow = {
			NOT = { has_character_modifier = ransom_timer }
		}
		
		effect = {
			add_character_modifier = {
				name = ransom_timer
				duration = 25
				hidden = yes
			}
			any_courtier = {
				limit = {
					prisoner = yes
				}
				character_event = { id = Plus.985 days = 5 random = 12 tooltip = ransom_all_tooltip }
			}
		}
	}

	nhv_begin = {
		potential = {
			NOT = { has_character_modifier = nhv_explained }
		}
		allow = {
			ai = no
		}
		effect = {
			custom_tooltip = { text = NHV_BEGIN }
			hidden_tooltip = {
				narrative_event = { id = Plus.970 }
				add_character_modifier = {
					name = nhv_explained
					duration = -1
					hidden = yes
					inherit = yes
				}
			}
		}
		ai_will_do = {
			factor = 0
		}
	}
	
	nhv_restart = {
		potential = {
			has_character_modifier = nhv_explained
			has_character_modifier = nhv_shut_off
		}
		allow = {
			ai = no
		}
		effect = {
			custom_tooltip = { text = NHV_RESTART_TOOLTIP }
			hidden_tooltip = {
				remove_character_modifier = nhv_shut_off
			}
		}
		ai_will_do = {
			factor = 0
		}
	}

	nhv_flag_msh = { # Flag Province (Marshal)
		potential = {
			has_character_modifier = nhv_explained
			NOT = { has_character_modifier = nhv_shut_off }
			job_marshal = {
				has_job_action = yes
				location = {
					owner = { character = ROOT }
					NOT = { has_province_flag = keep_it }
				}
			}
		}
		allow = {
			custom_tooltip = {
				text = OWNS_MARSHAL_PROV
				hidden_tooltip = {
					job_marshal = {
						location = {
							owner = { character = ROOT }
						}
					}
				}
			}
			custom_tooltip = {
				text = MARSHAL_PROV_UNFLAGGED
				hidden_tooltip = {
					job_marshal = {
						location = {
							NOT = { has_province_flag = keep_it }
						}
					}
				}
			}
		}
		effect = {
			character_event = { id = Plus.972 }
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 0
		}
	}

	nhv_unflag_msh = { # Unflag Province (Marshal)
		potential = {
			has_character_modifier = nhv_explained
			NOT = { has_character_modifier = nhv_shut_off }
			job_marshal = {
				has_job_action = yes
				location = {
					owner = { character = ROOT }
					has_province_flag = keep_it
				}
			}
		}
		allow = {
			custom_tooltip = {
				text = OWNS_MARSHAL_PROV
				hidden_tooltip = {
					job_marshal = {
						location = {
							owner = { character = ROOT }
						}
					}
				}
			}
			custom_tooltip = {
				text = MARSHAL_PROV_FLAGGED
				hidden_tooltip = {
					job_marshal = {
						location = {
							has_province_flag = keep_it
						}
					}
				}
			}
		}
		effect = {
			character_event = { id = Plus.973 }
		}
		revoke_allowed = {
			always = no
		}
		ai_will_do = {
			factor = 0
		}
	}
	
	nhv_dist_all = { # Vassalize All
		potential = {
			has_character_modifier = nhv_explained	
			NOT = { has_character_modifier = nhv_shut_off }
		}
		allow = {
			custom_tooltip = {
				text = ONE_PROVINCE_FLAGGED
				hidden_tooltip = {
					any_demesne_province = {
						has_province_flag = keep_it
					}
				}
			}
			custom_tooltip = {
				text = CAN_DISTRIBUTE_TITLES
				hidden_tooltip = {
					OR = {
						any_demesne_title = {
							tier = baron
							is_capital = yes
							location = { NOT = { has_province_flag = keep_it } }
						}
						any_demesne_title = {
							tier = baron
							is_capital = no
							location = { NOT = { has_province_flag = keep_baronies } }
						}
					}
				}
			}
		}
		effect = {
			custom_tooltip = { text = nhv_county_dist1 }
			any_demesne_title = {
				limit = {
					tier = COUNT
					location = { has_province_flag = keep_it }
					location = { NOT = { has_province_flag = keep_baronies } }
				}
				custom_tooltip = { text = nhv_county_dist2 }
			}
			any_demesne_title = {
				limit = {
					tier = COUNT
					location = { has_province_flag = keep_baronies }
				}
				custom_tooltip = { text = nhv_barony_dist2 }
			}
			hidden_tooltip = {		
				character_event = { id = Plus.974 }	
			}
		}
		ai_will_do = {
			factor = 0
		}
	}
	
	nhv_dist_barons = { # Vassalize All Barons
		potential = {
			has_character_modifier = nhv_explained
			NOT = { has_character_modifier = nhv_shut_off }
		}
		allow = {
			custom_tooltip = {
				text = CAN_DISTRIBUTE_BARONY_TITLES
				hidden_tooltip = {
					any_demesne_title = {
						tier = baron
						is_capital = no
						location = { NOT = { has_province_flag = keep_baronies } }
					}
				}
			}
		}
		effect = {
			if = {
				limit = { any_demesne_province = { has_province_flag = keep_baronies } }
				custom_tooltip = { text = nhv_barony_dist1 }
				any_demesne_title = {
					limit = {
						tier = COUNT
						location = { has_province_flag = keep_baronies }
					}
					custom_tooltip = { text = nhv_barony_dist2 }
				}
			}
			if = {
				limit = {
					NOT = { any_demesne_province = { has_province_flag = keep_baronies } }
				}
				custom_tooltip = { text = nhv_barony_dist3 }
			}
			hidden_tooltip = {		
				character_event = { id = Plus.975 }	
			}
		}
		ai_will_do = {
			factor = 0
		}
	}

	nhv_end = {
		potential = {
			has_character_modifier = nhv_explained
			NOT = { has_character_modifier = nhv_shut_off }
		}
		allow = {
			ai = no
		}
		effect = {
			custom_tooltip = { text = NHV_END_TOOLTIP }
			hidden_tooltip = {
				any_realm_province = {
					limit = { owner = { character = ROOT } }
					clr_province_flag = keep_it
					clr_province_flag = keep_baronies
				}
				add_character_modifier = {
					name = nhv_shut_off
					duration = -1
					hidden = yes
					inherit = yes
				}
			}
		}
		ai_will_do = {
			factor = 0
		}
	}
	
	seek_ancient_knowledge = {
		potential = {
			is_playable = yes
			controls_religion = no
			NOT = {
				has_dlc = "Way of Life"
				religion = zoroastrian
				religion = jewish
				religion_group = pagan_group
				culture_group = mesoamerican
				culture_group = indo_aryan_group
				culture_group = dravidian_group
				capital_holding = { holding_type = temple }
				has_character_flag = seeks_pagan_knowledge
			}
		}
		
		allow = {
			war = no
			has_regent = no
			NOT = {
				trait = zealous
				trait = slow
				trait = imbecile
				has_character_modifier = voice_of_jesus
				has_character_modifier = voice_of_satan
			}
			OR = {
				trait = mystic
				trait = scholar
				AND = {
					trait = cynical
					learning = 10
				}
			}
		}
		
		effect = {
			set_character_flag = seeks_pagan_knowledge
			piety = -25
			custom_tooltip = { text = PURSUE_PAGAN_KNOWLEDGE }
		}
		
		ai_will_do = {
			factor = 0
		}
	}
}

